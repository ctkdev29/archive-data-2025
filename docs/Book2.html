
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="robots" content="noindex" />
    <title>The Book of Satoshi</title>
  </head>
  <body>
    <h1>The Book of Satoshi</h1>
    <pre style="white-space: pre-wrap; font-family: sans-serif;">
the boo
k o
f
 
sa
t
osh
i
The Collected W
ritings of Bitcoin Creator
Satoshi Nakamoto
phil cha
mp
agne
fo
rewo
rd b
y je
ff b
er
wick

th
e boo
k o
f
 
Sa
to
shi

th
e boo
k o
f
 
Sa
to
shi
The Collected W
ritings of Bitcoin Cr
eator
Satoshi Nakamoto
P
h
i
l Cha
mp
agn
e
<<
<
< >
>
>>
E53 PUBLISHING LL
C

Copyright © 2014 b
y Phil Champagne, All rights reserved.
e part of this book
’
s conten
t that comes fr
om In
ternet forum is in the public 
domain. I gi
ve fu
ll rights to an
yone to co
py and distrib
ute electronic cop
ies of this 
book, either in part or in full.
Published in the U
nit
e
d Sta
tes of America by e53 Publis
hing LLC
ISBN 978-0-9960613-0-8 H
ardco
ver
ISBN 978-0-9960613-1-5 Soco
ver
e53 Publishin
g LLC
e53publis
hing.com
Cover illustra
tion by Lisa W
eichel
Editing b
y Mar
y Gra
y
bea
l
Cover and t
ext desig
n and co
mposition by J
ohn Reinhard
t B
ook Desig
n
is book is also available in eBook forma
t.  
T
o get a free cop
y
, please go to: BookOfSatos
hi.com

v
C
o
ntent
s
 
 
 
 
A
  C P 
 
xi
 
 
 A

 
 
xiii
 
 
 
 
W
 T
 B
 I I F
 
 
xv
 
 
 F 
 
xvii
 
. I
 
 

 
 
. 
 
H
  W
 B 
 
 

 
 
. 
 
T
 F
 P  C
 M L
 
 

 
 
. 
 
S

 C 
 

 
 
. 
 
T
  A



 
 

 
 
. 
 
A
 C
 C N

  
V
 P--P N


 
 

 
 
. 
 
S
   I
 I

 R

   
 

 
 
. 
 
A
 T

 
 

 
 
. 
 
O  O
 B
 
 


THE BOOK O
F SA
T
OSHI
vi
 
. 
 
A
 S

 
 T
 
 

 
. 
 
S
 D T
 F 
 

 
. 
 
O C
  B T
 
 

 
. 
 
T
 B

 G’ P 
 

 
. 
 
O B
 T
,  A

 T

,  
  L

 V


 
 

 
. 
 
M
  D S
, P
--W
,  
 T

 F 
 

 
. 
 
O E C
 C


, D  S

 
A


,  C
  
 

 
. 
 
M
   T

 P, N


  
B

,  C D
 
 

 . 
 
F 
 
R 
 
 
 B 
 

 
. 
 
O  P F W
 B C  
B U
 F
 
 

 
. 
 
“P--W
” T
  S
 
 

 
. 
 
B A  PP F

 
 

 
. 
 
O D
  K
  S 
 

 
. 
 
O  S  M
 S

 
 

 
. 
 
R  B .. 
 

 
. 
 
O T

 D
 
 


Co
ntents
vii
 
. 
 
B
 F
 W
 M 
 

 
. 
 
O B M

 
 

 
. 
 
H
 A 
 B 
 

 
. 
 
A F Q A  S


 
 

 
. 
 
O “N

 D


” 
 

 
. 
 
B V
 .  H
 
 

 
. 
 
R


  W

  D  P

  
F  O
 
 

 
. 
 
O  P--W
 D

 
 

 
. 
 
O  B L  P
  
 N
 
 

 
. 
 
O  P  B A
 C 
 

 . 
 
QR 
 
C 
 

 . 
 
B 
 
I/L 
 

 
. 
 
GPL L V
 MIT L
 
 

 
. 
 
O M
 T
 R


 
 

 
. 
 
O  P   C

 W
 
 

 
. 
 
O  V


  T

 T
 
 

 
. 
 
F B F


 
 

 
. 
 
B . R 
 

 
. 
 
O  S

  “
I K S
” 
 


THE BOOK O
F SA
T
OSHI
viii
 
. 
 
O C  M
 
 

 
. 
 
O S

  L

 C 
 

 
. O F
 T
 P 
 

 
. 
 
W

 A
 E  B
 
 

 
. 
 
O  P  S C 
 

 
. 
 
M F


 D 
 

 
. 
 
O F A

 P
 
 

 
. 
 
D
  B F

 
 

 
. 
 
T

  IP A R
 
  
B A
 
 

 
. 
 
O E  M

-S

 T

 
 

 
. 
 
O B M 
  W
  R 
 

 
. 
 
O  A


 T
  B
 C   
J
 H R 
 

 
. 
 
O  H C  M 
 

 
. 
 
O  D   A
 S
 
 

 
. 
 
O  D  M
  B 
 

 
. 
 
O  R   T
 F 
 

 
. 
 
O S  C
APTCH
A
  P


 R
 
 

 
. 
 
O S
 M   B C 
 


Co
ntents
ix
 
. 
 
O H  T
 S
 F A


 
 

 
. 
 
O P M T
 
 

 
. 
 
O W
L
 U
 B 
 

 
. 
 
O  D

 D
 N
 S
 
 

 . 
 
O 
 
 
PC W

 A
  B  W
L 
K  H
’ N
 
 

 
. 
 
S
’ L F
 P: R  B .. 
 

 
. 
 
E  D T
 
 

 
. 
 
L
 P

 C


  
 

 
. 
 
B  M (H F
) 
 

 . 
 
C
 
 

 
B: A P-P E C S
 
 

 
 
 
 
T
  D 
 

 
 
 I 
 


xi
About th
e  
C
over P
i
cture
CREDIT FO
R THE IMAGE
 on the fron
t cover goes to Lisa W
eichel 
(user id 
lisa_a
w on ic
kr
.com
). e pho
to was taken at C
ue
va de las 
Ma
nos (Cave of H
ands) in the p
rovince o
f Santa Cruz in Argen
tina. 
Cueva de las M
anos is a series of caves fa
mous fo
r the various pain
t
-
ings of h
uman ha
nds covering i
ts wal
ls. e pain
tings, the earliest of 
which date fr
om aro
und 13,000 years and the la
test from a
b
ou
t 9,000 
years a
go, w
ere le there b
y multip
le generation
s. 
I selected it as this book
’
s cover im
age bec
ause i
t s
eems to me to 
embody man
y of the concep
ts underlying Bi
tcoin—man
y individuals 
participating a
nd cooperating to a
ttain, ov
er time, a common g
oa
l and 
yet main
taining their o
w
n individuali
ty and uniqueness. Bi
tcoin dif
-
fers fro
m the cave pain
tings of C
ue
va de las Man
os in s
cale, how
e
ver
. 
Although these pain
tings were pr
oduced by m
ultiple genera
tions o
f 
individuals o
ver several thousands of y
ears, the num
b
er of these artists 
can
’
t com
pare in size to the millions who no
w and will in the future 
use Bitco
in. Mo
reover
, Bit
coin
’
s users ar
e geographically dispersed, 
collabora
ting over a decen
tra
lized system. Finally
, whereas Cueva de 
las Ma
nos was the work o
f one or m
ore distinct tribes of h
umans, Bi
t
-
coin, o
p
en to an
yone to u
s
e and ada
pt, transcends na
tionality and has 
the poten
ti
al to become a true world currency
.

xiii
Ackn
owledgment
s
I W
OULD LIKE TO EXTEND 
my pr
ofo
und app
reciation t
o t
he fol
-
lowing in
dividuals for their co
ntributio
n to this work:
Dustin T
rammell (du
stintrammell.co
m) for sha
r
ing email exc
hanges 
he had with Sa
toshi N
a
kamo
to,
Gavin An
dersen, L
ead C
ore Develo
p
er of the Bi
tcoin pr
oject, for 
his con
tribution t
o Bitco
in and also for sha
r
ing his ema
i
l excha
nges 
with Sa
toshi Nakam
oto
,
Je Ber
wick of DollarV
igilante
.com for writing the f
orewo
rd and 
for being a
n advocate o
f f
reedom a
nd liber
ty
.
Fo
r their support, expertise, inpu
t, and con
tr
ibu
tions, I would like 
to thank m
y son, Samue
l, my da
ughter V
ivianne and m
y wife, M
arie 
Gagnon. An
d nal
ly
, I would like to tha
n
k all the p
eople who hel
p
ed 
me pu
t this b
ook together in particular Mary Graybeal, our editor who 
did a tremendo
us job and J
ohn Reinhardt who cam
e up with this great 
design for the book.
And, lastly
, a sincer
e t
hanks to Sa
toshi N
akamoto
. W
ithou
t him, 
how lo
ng would we h
ave had to wa
it befor
e such a revol
utionary con
-
cept as B
itcoin was disco
vered and sha
red?

xv
Wh
o T
h
is Boo
k  
Is Inten
ded Fo
r
THIS BO
OK CONT
AINS 
most o
f t
he writings of Sa
toshi N
akamoto
, 
crea
tor of B
itcoin, p
ublished in emails a
nd forum posts during the 
span of a li
ttle over tw
o years during which B
itcoin was la
unched and 
became established
. Anyo
ne inter
ested in learning about B
itcoin a
nd, 
mor
e specic
ally
, about the though
t processes of its cr
eato
r w
ill app
re
-
ciat
e t
his book. I
ts cont
ent will be an easy read for a
nyo
ne having a 
backgroun
d in comp
uter sowar
e. Ho
wever
, e
cono
mists and in
vestor
s 
withou
t a background in inf
ormation t
e
chnology may also be inter
-
ested in Sa
toshi’
s writings, some o
f w
hich concern eco
nomic concep
ts. 
Depending on backgro
und and in
terest, certain readers ma
y be inter
-
ested in only certain ch
apter
s.
T
o enable readers to deriv
e maximum benet fro
m Satoshi
’
s writ
-
ings, we
’v
e included a cha
pter en
titled “H
ow and W
hy Bi
tcoin W
orks
” 
that p
rovides a
n introduction to the k
e
y concep
ts of Bitco
in and the 
fundamen
ta
l princip
les on which it is based. is sho
u
ld help the 
reader gain s
ucient understan
ding to com
prehen
d t
he ma
j
ority o
f 
the cha
pters which fo
l
low
. Chap
ters ar
e present
e
d in chro
nological 
or
der
, f
rom the ear
liest post in w
hich Sa
toshi presen
ts the germinal 
idea of Bi
tcoin to the most r
ecent, which marks his wi
thdrawal from 
pub
lic life. 

THE BOOK O
F SA
TOSHI
xvi
P
art of this bo
ok
’
s conten
t comes fro
m various In
ternet forums: 
p2pfound
ation.or
g
, 
bitcointalk.org
, and the cr
yptogra
phy ma
il archiv
e. 
Y
ou ca
n visit the websit
e 
eBookOfSato
shi.co
m
 for easy ref
er
-
ences to the URL web links r
eferenced in the book. ey are list
ed p
er 
chapter
.

xvii
Fo
re
wo
rd
BITCOIN H
AS CH
ANGED E
VER
Y
THING
.
 
I
ts importance as a
n 
evolu
tion in money an
d b
anking canno
t b
e ov
erstated.
N
otice I don
’
t 
use the wor
d “r
evolutio
n
” here because I consider B
itcoin to be a com
-
plete “
e
vol
ution
” from the an
achronistic mo
ney and banking systems 
that h
umanity has been using—a
nd be
en for
ced by go
vernment dic
-
tate t
o use—for at least the las
t hundred y
e
ars.
One of the b
iggest issues that n
e
wcomer
s to Bitco
in have is tha
t it is 
“
shro
ude
d in mys
ter
y”
.
is is not t
otally tr
ue, as this impo
r
tant book sho
ws.
 
While the 
true identity of Sa
toshi N
akamoto ma
y never be known fo
r cer
tain—
despi
te those like Dorian Naka
moto
, whom the mains
t
ream media sa
y 
is Sa
toshi—what we do kno
w
, in ver
y pr
olic and histo
ric
al detail, are 
the underpinnings an
d design of Bitco
in f
ro
m its earliest da
ys.
V
er
y detailed con
versation
s were held between to
p cr
yptogra
phic 
and p
rogramming experts since the ver
y rst day B
itcoin was in
tro
-
duced… a da
y that ma
y go down in histo
r
y and possibly be celebra
ted 
by g
enerations t
o come.N
ovem
b
er 1, 2008.
e rst w
ords posted b
y Satoshi N
akamoto w
ere eloquen
t in t
heir 
simp
licity as he anno
unced his creation, which w
ould go on to c
hange 
the wor
ld, “I’
ve be
en wor
k
ing on a n
e
w electronic cash syst
em t
hat
’
s 
fully pe
er
-to-p
eer
, with no trusted third party
.
”
H
e t
hen pu
t a link to a white paper he had writ
ten on the subject. 
e res
t, as t
hey say
, is histo
r
y
.

THE BOOK O
F SA
TOSHI
xv
iii
ese discussions, taking place pu
blicly on the
 bitcoin
talk
.org
 forum, 
wen
t on until December 12
th
, 2010. Aer tha
t, Satoshi wen
t dark.
Amon
gst the Bitco
in communi
ty
, these p
osts ar
e well known, bu
t 
your a
verage person w
ould need hours to scour thr
ough it all and make 
sense of it.
In this impo
r
tant book, Phil Cham
pagne has gone thr
ough 
each post and iden
tie
d the most im
p
ortant o
nes… and given the 
con
text for the time o
f t
he post as to wh
y it is importan
t.
is creates 
a logical timeline of Bi
tcoin
’
s e
vol
ution straight fr
om the keyb
oard o
f 
Sat
oshi Nakam
oto and co
u
ld be descr
ibed as Bitco
in
’
s au
tobiograp
hy
.
As I writ
e, in Mar
ch 2014, Bitco
in
’
s futur
e is unknowable.
I
t could 
go on t
o change the w
orld drama
tica
lly
, f
reeing us fr
om the opp
res
-
sion o
f central banks and the garga
ntua
n governmen
ts that feed o
 
their free money
.Or
, it could g
o down in smoke a
nd ames due to a
ny 
num
ber of possible events.
N
o matt
er w
hat ha
ppens fro
m here, ho
wever
, the impact of Bi
tcoin 
is
 kno
wable.
I
ts most cor
e concept ha
s and will change ho
w we think 
abou
t contracts, trust, and transactions n
o matter wha
t hap
p
ens to 
Bit
coin itself. Already tho
usands of a
pplica
tions hav
e b
een built o

 
the platf
orm, and these hav
e exp
anded it o
utside the world o
f nancial 
transactions.
Phil Cham
pagne has put in
to an easy-to-r
e
ad forma
t the fomen
ting 
of o
ne of the most im
p
ortant t
echnological innova
t
ions o
f our time… 
a com
pletely decen
tra
lized platfo
rm to per
form pa
yment transaction 
withou
t the need for a trusted third party
.
I
ts importance is o
nly sur
-
passed by the In
ternet itself as a
n e
volu
tion in comm
unications. Cha
p
-
ter 2 pr
ovides readers unfa
mi
liar with Bi
tcoin a grea
t overv
iew of its 
technological and p
hilos
ophical fo
undation and o
f how i
t operates.
Decades f
ro
m now man
y will lo
ok back a
t t
his innova
tion the way 
we curren
tly lo
ok back a
t the Int
er
net or the G
utenberg p
ress as being 
epochal momen
ts in t
he histo
r
y of civilization.And this collection of 
Sat
oshi’
s posts and corr
esp
ondences f
orms a logical timeline and will 

Foreword
xix
be one of 
t
he easiest wa
ys for futur
e historian
s to understand j
ust how 
it began an
d e
volv
ed.
Je Ber
wick,
Edito
r in chief, 
e D
oll
ar V
igi
lante
ht
tp://DollarV
ig
ilant
e.com

1
1
Intr
o
ducti
o
n
W
E H
A
VE SEEN 
man
y amazing techno
logic
al revol
utions 
througho
ut huma
n history
. e Gu
ttenberg pr
ess helped 
bring books to the masses. e te
leg
rap
h has enabled 
crude but ra
pid comm
unication acr
oss great dis
t
ances. M
ore r
ecently
, 
personal com
puter
s have vastly in
creased human p
roductivity
, leading 
to the crea
tion of the I
nternet, digital comm
unications, a
nd the adven
t 
of ci
t
izen journalism as pho
tos of ma
jor events ar
e almost instan
tly 
uploaded to T
wit
ter and other social networks via smartp
hone, which 
ar
e smal
l com
puters in their o
wn rig
ht. U
ntil fairl
y recently
, how
ever
, 
the monetary system has r
emained somewhat un
touched b
y a major 
br
e
akthro
ug
h. 
Bit
coin is run by sowar
e whos
e bluep
rint (source code) is freel
y 
ava
il
able f
or an
yone to see and even ada
pt fo
r his or her own use. I
t 
currently runs o
n multi
ple com
puters co
nnected over the I
nternet 
via a commo
n networking p
rotocol dened b
y t
his same sowar
e. 

THE BOOK O
F SA
TOSHI
2
Existing within this sowar
e and existing because of i
t is a digital cur
-
rency known as 
bitcoin
, spelled with a low
er cas
e b and ab
breviated 
BTC. 
Bit
coin, both a virtual c
urrency and a paymen
t system, rep
resents 
a revol
utiona
r
y concep
t w
hose signicance quickly becomes a
pparen
t 
with a rst tran
sac
tion. A buy
er making a purcha
s
e in BTCs has o
nly 
to pr
ovide the merc
hant wi
t
h personal informa
tion relevan
t to the 
pur
chase, for exa
mple, the shi
pping o
r email address, to pa
y
. C
ompar
e 
this with a credit ca
rd pur
chase, which necessitat
es t
he bu
yer giving 
enough personal info
rmation to ena
ble another party bent o
n f
raud
, 
a hacker o
r dishonest em
plo
yee, to make fraud
u
lent p
urchases with it. 
Bit
coin
’
s signicance is no
t limited to the sim
plicity of the paymen
t 
system, ho
wever
. e sup
ply of B
itcoin currency is dened by the so
-
war
e and its underlyin
g prot
o
col. Only 21 million b
itcoin
s wi
ll ever 
come in
to existence
, with about 12 million so far ha
ving been cre
-
at
ed. e last bit
coin is expec
ted to be crea
ted around the y
e
ar 2140. 
is very spe
cic, limited mo
ney suppl
y has led to man
y contr
over
-
sies, some of which h
ave mo
re to do with lack of un
derstanding of 
the pr
otocol or the econo
mics than with the soware i
tself. Although 
21 million BTC migh
t se
em insucien
t with a global p
opula
tion of 
7 billion people
, the bitco
in cur
rency is highly divisible. 
e small
-
est denomin
ation allow
e
d by the curren
t soware is 0.00000001 B
TC 
(10
-8
 BTC), which h
as b
een dened as 1 
s
ato
s
hi
 and was na
med aer 
the soware
’
s pu
tative cr
e
ato
r
, Satoshi N
akamoto
. ere a
re therefo
re 
100 million satos
his in a single bitco
in, and thus the maxim
um sup
ply 
of 21 million B
TC wil
l be equal to 2.1 quadrillion satoshi
s or
, if you 
pr
efer
, 2,100 tri
llion sat
oshis.
Bit
coin was crea
ted by an an
onymo
us person (or gro
up of per
-
sons) kno
wn as Satoshi N
akamot
o. A
t the time Nakam
oto made his 
rst p
ublic post announcin
g his paper on Bi
tcoin, he was jus
t another 
ano
nymou
s us
er like millions o
f others posting on I
nternet fo
r
ums. 
His n
e
w soware was then s
t
ill in the early phase of deve
lopmen
t, and 

Introducti
on
3
Bit
coin was only a
n exp
eriment in i
ts e
arly s
t
ages. Sa
toshi
’
s interaction 
was limit
e
d to email exc
hanges o
nly and fo
r a brief duratio
n of a lit
t
le 
ov
er 2 years. Since then, we ha
ven
’
t heard fro
m him. Around the time 
of his last post, B
itcoin
’
s value was soaring, and the media wer
e start
-
ing to take no
tice. Ju
st w
hen Bi
tcoin ap
pe
ared poised to take o
 and 
was beginning to a
ttract s
erious in
terest, Sa
toshi N
a
kamo
to retrea
ted 
from the p
ublic eye.
A few years la
ter
, Sat
oshi has be
come som
et
hing of a
n iconic gure, 
and his r
etreat has o
nly ser
ved to am
plify t
he m
yster
y surroundin
g 
him. His iden
tity is irrelevan
t to the well-being of B
itcoin, as the code 
is open source a
nd is, in fact, being constan
tly upgraded and im
pro
ved 
upon even as w
e spe
ak. Ho
wever
, gaining a
n understanding o
f t
he 
mindset of the m
ysterious person (o
r g
ro
up of persons) behind this 
marvelous new techno
log
y would cert
ainly p
rove in
terestin
g
.
Sat
oshi’
s two-year “
public life
” overla
pping B
itcoin
’
s developm
ent 
and la
unch began with the publica
tion of his pa
per “Bit
coin: A P
eer-
to-P
eer
 Elec
tronic Cash S
ystem
”
, which he anno
unced on No
vem
-
ber 1
st
, 2008, on the Cryptograph
y Mailing List. A
t that time, this 
paper could be downloaded at do
main name 
bi
tcoin
.org,
 which had 
been registered a f
e
w mon
ths earlier on A
ugust 18
th
, 2008, through 
anonymou
sspeech
.com
. On N
ovember 9
th
, 2008, the Bit
coin pro
jec
t 
was regist
ered on 
SourceF
orge
.net
 and, a
t t
he beginning of 2009, the 
genesis b
lo
ck was crea
ted. T
o unders
t
and the genesi
s block, imagine a 
bookk
eep
ing
 ledg
er t
hat add
s ne
w pages (blocks) daily a
nd con
t
ains a 
recor
d of all bit
coin transactions ever made. 
e ver
y rst page of this 
book is calle
d the genesis block, which will be explained in mor
e detail 
in the follo
wing chap
ter
. Satoshi in
corp
ora
ted this inter
esting quote 
int
o t
he genesis b
lo
ck in ref
erence to the bank bailou
ts o
ccurr
ing a
t 
the time:
T
 T
 /J/  
C  
   

  

THE BOOK O
F SA
TOSHI
4
Bank bailouts w
ere and still ar
e ext
remel
y unwelco
me occ
urrences, 
particu
lar to libertarians, who caricat
urize
d our political and eco
-
nomic en
vironm
ent with this quo
te: “Priva
tize the gains and socialize 
the losses
”
. 
Six days la
ter
, on Ja
nuary 9
th
, 2009, N
akamoto pu
blished the source 
code
 of Bi
tcoin versio
n 0.01 on 
SourceF
orge
.net
. As of this writing 
(Ma
rch 2014), Bi
tcoin v
. 0.8.6 is the latest v
ersion. 
Sat
oshi’
s last post was publi
shed on the 
bitcointalk.org
 forum on 
December 12
th
, 2010. His las
t known comm
unication is a p
r
iva
te email 
sent a few mo
nths la
ter to Gavin Andr
esen, c
urrent Lead Core Devel
-
oper of the Bi
tcoin pr
oject.
Below is a cha
r
t of the pu
blic trade data from 
bitco
inmarket.com
, the 
rst Bi
tcoin exc
hange, which is 
no longer in b
usiness. As can 
b
e seen, 
the value of o
ne bit
coin went fr
om 10 cents to a do
ll
ar in a very short 
time. A
t the time of Sat
oshi’
s last post on the fo
r
um, it was trading 
ar
ound 25 cents a
nd was app
roaching 30 cen
ts per bitco
in. 
FIGURE 1 - EARL
Y CH
ART OF
 BITCOIN PRICED IN US
D

Introducti
on
5
is book is a collection of the postings and writings p
ublished 
under Sa
toshi’
s name o
n various fo
r
ums and inc
luded in email 
excha
nges. I ha
ve chosen to excl
ude p
osts of a technical na
ture, s
uch 
as those rela
ted to coding, soware co
mpila
t
ion, an
d t
he detailed tech
-
nical operation o
f the Bitco
in s
owar
e. Y
ou will notice a few in
ter
-
esting sub
je
cts are discussed; one in particular inv
olves the Byza
ntine 
Generals
 Prob
lem, hereto
fore co
nsidered unsolva
ble, which describ
es 
the challenge o
f communica
ting in an unrelia
ble envir
onment. Some 
of Sa
toshi
’
s commen
ts rela
te to the news coverag
e t
hat deve
loped as 
Bit
coin started to at
trac
t media at
tention. One s
uch event was when 
Pay
Pa
l
 stop
p
ed processing pa
yments fo
r W
ik
iLeaks, a j
ournalistic 
non-p
ro
t organiza
tion dedicated to p
ublishing selected secret and 
classied info
rmation pr
ovided by a
non
ymous sources. A su
bs
equent 
article pub
lished in 
PC W
orld
 m
agazine con
j
ectured ho
w W
i
kiLe
aks 
could benet fro
m Bitco
in. 
Sat
oshi’
s post se
ems to indica
te that he was n
ot comfo
r
table with 
Bit
coin getting this kind o
f atten
tion and was n
ot ready fo
r such a rela
-
tionshi
p, a
t least not y
et: 
I
  

      

    

. W
L    
’ 
,   

   

 .
H
ow muc
h t
his event in
uenced his decision to “
retire
” from Bi
t
-
coin
’
s developmen
t is unknown, bu
t the timing is inter
esting, to say 
the least. Signican
tly
, this post was written ju
st nineteen hours befo
re 
his last post on the f
orum, t
he anno
uncement o
f t
he release o
f Bitcoin 
versio
n 0.3.19. 
Ma
ny journalists a
nd researcher
s have tried to identify who could 
be the person behind Satos
hi Nakamo
to. So far
, at least thr
e
e at
temp
ts
 
at iden
tif
ying him ha
ve be
en made. T
ypical choices h
ave been known 
scientists in the eld o
f cr
yptograph
y
, none of whose real na
mes are 

THE BOOK O
F SA
TOSHI
6
Sat
oshi Nakam
oto
. Al
l hav
e b
een pro
ven false, and all denied being 
Sat
oshi Nakam
oto as well. H
owever
, ver
y recen
tly
, a newspaper claimed 
to ha
ve identied a Californian, an en
gineer w
ith actual name Dorian 
Sat
oshi Nakam
oto
, as the Bitco
in Satoshi N
akamot
o. Dorian N
akamot
o 
has denied this, and I tend t
o b
elieve him. Fo
r one thing, Dorian N
aka
-
moto 
do
es not demo
nstrate the p
rociency in English tha
t the Bitco
in 
Sat
oshi Nakam
oto has sho
wn t
hro
ug
h his writing. Wha
t is most re
l
-
evant t
o this b
ook concerning this epi
s
ode is that it a
ppar
ently caused 
Bit
coin
’
s Sa
toshi Naka
moto to br
eak his si
lence and post this messag
e 
on the 
p2pfoundation
 forum on Frida
y Mar
ch 7
th
, 2014:
I   D
 N

.
As y
ou will s
ee in the bo
ok, Sa
toshi’
s replies addr
essed many 
of 
the most comm
only asked ques
t
ions a
nd criticisms rega
rding Bi
tcoin 
and a
re still p
ertinent. I suspect that, wer
e he still invo
lved in Bitco
in
’
s 
develop
ment an
d were he to be in
ter
v
iewed, the writings con
tained in 
this book would reect the type of answ
ers Satoshi w
ould give.
Wha
tever event
ua
lly ha
ppens to Bit
coin itself, tha
t t
he sowar
e has 
opened the mind of the w
orld to a new con
cept is indispu
table. A
s 
an open sour
ce code, it allowed a m
yriad of other distribu
ted digital 
currencies to en
ter the scene. While most o
f t
hem do not r
epresen
t 
an
y signicant inno
vation
s—only var
ying the num
ber of coins, the 
transaction conrma
tion speed (in Bitco
in termed 
block crea
tion
), or 
the com
puter encryption algo
r
ithm—a few new ones which inco
r
-
pora
te signicant new fea
tures or n
e
w concep
ts are being developed. 
One such is “T
ruthcoin
”
, des
cribed as a tr
ustless, decentralized, cen
-
sorshi
p-proof, in
centive-co
mpatible
, s
calable bi
tcoin pr
edic
tion mar
-
ketp
lace. Ethereum (see 
et
hereu
m.org
) is ano
t
her digital currency that, 
accor
ding to its cr
e
at
or
, will a
llow users to encode adva
nced t
rans
-
action types, smart contracts, an
d de
centralized ap
plication
s into the 
block cha
in (Bitcoin
’
s large p
ublic ledger which gro
ws in size daily). 

Introducti
on
7
Inno
vativ
e t
hinkers ar
e se
eking to use some o
f the concepts in
tro
-
duced b
y Bitcoin in a truly open vo
ting system, where vo
ters can con
-
rm that their vo
tes have been pr
operly coun
ted and can, a
t an
y t
ime, 
view a comp
lete vote co
unt, thu
s ensuring transpar
enc
y
. Bitco
in has 
therefo
re clearl
y sparked a new technological revol
ution tha
t capi
t
al
-
izes on the I
nternet, ano
ther innova
tion that cha
nged the world
. 
I am qui
te open to suggestio
ns and corr
e
ctions with res
p
ect to this 
book and its co
nten
ts. Also, if yo
u have p
rivate ema
i
l excha
nges with 
Sat
oshi that yo
u feel can be made public, I will be glad to consider 
them for in
clusion. Please feel free to co
ntact me at BookOfSat
oshi@
gmail.com.

9
2
H
ow an
d Why 
B
it
co
i
n wo
rks
B
ITCOIN H
AS BEEN DESCRIB
ED 
as libert
arian in na
ture, 
bu
t not all liber
tarians and 
t
hose in favo
r of a go
ld-b
acked cur
-
rency ap
precia
te it ho
wever
, and some, in poin
t of fact, actively 
despise i
t. In our experience, some funda
mental concepts 
related to 
Bit
coin are n
ot well understood by these. T
o fully understand Bi
tcoin, 
knowing h
ow and, j
ust as importan
tly
, philos
ophically wh
y it works i
s 
essential. H
ow can a dis
t
ribut
ed system composed of several dieren
t 
grou
ps and mana
ged by several individuals a
t t
he same time main
tain 
its in
tegrity and a
void the condi
tion termed “
tragedy of the comm
ons
” 
by Ga
rrett H
ardin? I
n t
his econo
mic conditio
n, individuals, acting 
independently a
nd rationally acco
rding to self-in
terest, beha
ve con
-
trar
y to the whole gro
up
’
s long-term best in
terests b
y depleting com
-
mon r
esources. A typical exam
ple is where a gro
up of fa
r
mers sha
re a 

THE BOOK O
F SA
TOSHI
10
commo
n pasture f
or grazing their cattle. Overuse and depletio
n of the 
commo
n resource
, t
he pastur
e, can occur since it is in no one fa
rmer’
s 
individual self-in
terest to co
nser
ve it by limi
ting his cattle
’
s consum
p
-
tion of the past
ure. 
Let’
s begin with a disc
ussion o
f how Bi
tcoin wo
rks. T
o ap
precia
te 
and under
stand most of this book, some basic unders
t
anding o
f Bit
-
coin
’
s key concepts i
s necessar
y
. is cha
pter will pro
vide that and will 
conc
lude with a perspec
tive on wh
y Bit
coin, as a paymen
t system, has 
been pro
ven so far to be a viable solu
t
ion. T
o com
plete our discussion, 
we will elabora
te Bitco
in
’
s economic im
plicatio
ns.
A
t its co
re, Bi
tcoin incorpora
tes the following co
ncepts:
•
 
A public ledger (called Bit
coin
’
s 
block
 chain
). C
onsider this as 
essentially a gian
t b
ook that is p
ublicly a
vailable and co
ntains 
the book
keepin
g records o
f all t
ransactions ever made in the 
Bit
coin system, with new pages co
nstantl
y b
eing added.
•
 
A cr
yptograp
hic a
lgori
t
hm called asymmetr
ic encr
yption
 used 
for a
uthoriza
tion of the tran
s
actions.
•
 
A distribut
e
d networ
k of com
puter 
nodes
 (also comm
only 
known as 
miner
s
) that v
er
ify and validate Bi
tcoin transactions 
and u
p
date the p
ublic ledger
.
Let’
s explor
e these concepts in grea
ter detail.
Bit
coi
n’s b
lock chai
n: pub
lic boo
kkeepi
ng
All members of the Bi
tcoin netwo
rk shar
e its public ledger
, the
 block 
chain
. Imagine a gian
t accountin
g b
ook with each page listing a series 
of tran
s
actions. A new page co
ntaining the la
test Bitco
in transactions 
sent b
y payers acr
oss the world is added a
ppr
oximat
ely ever
y 10 min
-
utes. is gia
nt book is constan
tly ava
il
able o
n t
he In
ternet to an
yon
e 

How an
d Why Bitco
in wo
rks
11
who runs the Bitco
in soware. N
ote that sowa
re progra
ms calle
d Bit
-
coin 
wallets
 can run on smartp
hones or personal co
mpu
ters and allow 
a user to make paym
ents ov
er t
he Bi
tcoin networ
k.
In the co
ntext o
f Bitcoin, the pag
es forming the ledger ar
e cal
led 
blocks
 because they repr
esent “blocks
” of data. e block cha
in, com
-
pose
d of ma
ny individ
ua
l blocks, gro
ws constan
tly in length and con
-
tains all transactions performed in B
itcoin since i
ts launch in J
an
uar
y 
2009.
A Bit
coin transaction reques
t contain
s the following: 
1. 
 
e Bitco
in address of the pa
yer
, which con
t
ains the sour
ce of 
funds fo
r t
he paymen
t,
2. 
 

e recipien
t’
s (pay
e
e
’
s) Bi
tcoin address
, and
3. 
 

e amoun
t of bi
tcoins being transf
erred. 
Since the block cha
in conta
ins the history of all outgo
ing and 
incomin
g p
aymen
ts associated with the pay
er’
s Bi
tcoin addres
s, min
-
ers
, who als
o manag
e t
he Bi
tcoin networ
k, can validate tha
t t
he pay
er 
has sucien
t funds to cover the pa
yment. A
t any time
, any
one can 
view the amoun
t of bi
tcoins linked to (o
r
, in an abstract way
, held in) 
an
y specic Bitcoin addr
ess. Se
e fo
r yourself. Go to 
blockchain.info
 and 
ent
er t
he follo
wing address. 
1GaMmGRxK
CNu
y
ymancjmA
c
u3mvU
nV
jT
V
mh 
U
nder “Search
”
, the number of b
itcoin
s asso
ciated wi
t
h this address 
will b
e ret
ur
ned. 
Although the o
wner’
s iden
tity cannot be known fro
m his Bitco
in 
address
 wi
thout his ha
ving pro
vided this informatio
n, any tra
nsfers 
in and o
ut of his accoun
t, as well as his curren
t balance, are p
ublicly 
ava
il
able f
or viewing. 

THE BOOK O
F SA
TOSHI
12
Asymmetric en
crypti
on:  
who get
s to s
pen
d thos
e bit
co
ins
Encr
yption k
e
ys are as
s
ociated with a transaction suc
h as the one 
describe
d abov
e. Bitco
in emplo
ys a system of asymmetric encryp
-
tion (also known as p
ublic-key cr
yptograp
hy), so called b
ecause the 
encr
yption algo
rithm requires a pa
ir of keys, each consis
t
ing of a lo
ng 
series of digits. One is p
ublic and con
trols the decr
yption o
p
eratio
n, 
while the other
, the priva
te key
, governs the en
cr
yption o
p
eratio
n, or 
vice versa. 
I
t is easy for the alg
orithm to crea
te a priva
te key and to derive i
ts cor
-
respon
ding public k
e
y
. Ho
wever
, determining a priva
te key from the 
corres
p
onding p
ublic key is com
puta
tionally unfeasible, th
us allowing 
the public k
ey to, as i
ts name im
plies, be made public. W
ith the public 
key
, the payee can r
etr
ieve the transaction info
r
matio
n, al
lowing the 
FIGURE 2: AS
YMMETRIC ENCR
YPTION ILL
USTRA
TED

How an
d Why Bitco
in wo
rks
13
transfer o
f bit
coins to pr
oce
ed. e follo
wing Figure 2 con
ceptually 
illustra
tes Bitco
in
’
s double k
e
y system, which pr
ovides part of the basis 
for B
itcoin
’
s operatio
n.
e Bi
tcoin sowar
e
’
s a
lgori
t
hm allows only the o
wner of the pri
-
vat
e key to “
spend” b
itcoins a
sso
ciated with tha
t Bitco
in address. e 
recip
ient, o
r p
ay
e
e, shar
es his Bitco
in address with the pa
yer
. Since 
only the r
ecipien
t k
nows the p
rivate k
e
y linked to his address, o
nly he 
will b
e able to acces
s, spend, or transf
er t
hose bit
coins a
t a l
at
er t
ime.
W
ithin Bi
tcoin, a sender digitally signs a Bit
coin transaction with 
his priva
te key
. Bitco
in transactions actually con
tain the public key
 
(assume this is the B
itcoin addr
ess for no
w). U
sing this public key
, the 
system veries tha
t the digital sig
nat
ure is valid and ther
eby conrms 
that the sender is indeed the priva
te key’
s owner
. is system allows 
the owner to “
spend” the b
itcoin
s asso
ciated wi
t
h his Bi
tcoin address 
in the public ledg
er
, and the public ledger (i
.e., the block chain) will be 
updat
ed w
ith a new page (i.e., b
lo
ck) con
taining this transaction. e 
addition o
f this new t
ransaction to the block c
hain eectively te
l
ls the 
Bit
coin networ
k to credit those bi
tcoins to the r
ecipien
t’
s address and 
debi
t them f
rom the sender
’
s Bitco
in address. Priva
te keys ar
e made 
of a lo
ng ser
ies of digits s
tored and m
anaged by passw
ord-p
rotected 
Bit
coin 
wallets
 (i.e., so
ware on the user’
s com
puter
, mobile device, or 
other web a
pplica
tion).
A n
et
wo
rk of mi
ner
s actin
g as minters, 
boo
kkeepers, an
d regula
to
rs o
f the system
So far
, we ha
ve tal
ked abou
t w
hat tra
nsac
tions look like a
nd how 
they are valida
ted. If Bi
tcoin wer
e a centrally operated syst
em, t
he 
sto
r
y would end h
ere: A single enti
ty would be responsib
le for this 
task. H
owever
, Bitco
in is a decentralized system, and, as s
uch, this 
task is shar
ed among a co
lle
ction of vo
luntarily participa
ting nodes 

THE BOOK O
F SA
TOSHI
14
(miners
) distrib
uted across the wo
rld. U
nderstan
ding how a system 
that inc
ludes bookkeeping and pa
yment transf
er autho
rization could 
be operated b
y dieren
t entities in suc
h a way as to su
pport his or her 
own self-in
terest is essen
tia
l. is cha
rac
teristic of the syst
em is one of 
the key understandin
gs to which I alluded earlier as one tha
t is oen 
missed by critics o
f Bitcoin. 
Miners, the nodes r
esp
onsi
ble for opera
ting the Bitco
in network, 
verify that transactions a
re valid and upda
te the block chain with new 
blocks con
sisting of the lat
est transactions on a r
egular basis. e Bit
-
coin sowa
re run by miners o
n t
heir individ
u
al com
puters in
corp
o
-
rat
es t
he Bi
tcoin pr
otocol with its set of rules and agr
eements. 
Overall, the Bitco
in network req
uires that the block ch
ain (public 
book ledger) be contin
ual
ly updat
ed w
ith the additio
n of new blocks 
(pages in the ledger book). A
ppr
oxima
tely ever
y 10 minu
tes, a new 
block is added with the list o
f t
he lat
est transactions. Although all min
-
ers
 are wo
rking on the next block, o
nly one will be s
elected to hav
e his 
specic version o
f the block added to the block chain. I
ndeed, each 
miner is opera
ting in his self-inter
est when he crea
tes his own ver
sion 
of this next block a
nd so p
ersonally collects the transaction fees asso
-
ciat
e
d with that b
lo
ck of tran
s
actions. Altho
ug
h the cor
e p
aramet
ers 
of Bi
tcoin transaction
s are unalter
ed (payer
, payee, amo
unt), most o
f 
them include tra
nsact
ion fees, disb
ursed by the payer a
nd to be cred
-
ited to the acco
unt of the miner whose block is selected fo
r inclusion 
in the block chain. i
s miner wi
ll therefo
re updat
e e
ach of these 
transactions a
nd wi
ll credit the fees as
s
ociated with those transactions 
to his very own Bit
coin address. 
In addi
tion to transaction fees, miners whose blocks ar
e added to 
the block chain also earn additio
nal credits with newly mint
ed bit
-
coins. 
e
y crea
te an extra transaction that adds these to their o
wn 
bi
tcoin accoun
ts. is is calle
d a block rewar
d. Curren
tly
, Bitco
in
’
s pro
-
tocol allows miners t
o al
locate themselv
es 25 new bitco
ins per block 
crea
ted. is is in addition t
o t
he sum of tra
nsac
tion fees. I
nitial
ly
, at 

How an
d Why Bitco
in wo
rks
15
Bit
coin
’
s laun
ch, 50 bitco
ins (BTC) w
ere allo
cated as the b
lo
ck rewar
d 
per block, which is halved a
ppro
ximat
ely ever
y four years.
W
ith the new bit
coins credi
ted to his address, the miner whose ver
-
sion o
f t
he block is selected for inc
lusion in the block ch
ain clearly 
benets fro
m nding a solutio
n b
efor
e his fellow miner
s do. H
ow this 
selection process wo
rks will b
e explained sho
r
tly
. For no
w
, however
, 
view it as solving a ma
thematical pr
oblem by ex
e
cuting a very exp
en
-
sive co
mpu
ting task. e solutio
n is dicu
lt to nd b
ut, once f
ound, 
its co
r
rectness is easy to verify
. e rst miner to nd the solu
tion to 
his block is allow
e
d to pub
lish this version t
o t
he entir
e network o
f 
miners.
ese miners receiv
e the block and its sol
ution and then w
ork to 
au
thenticat
e and validate i
t, t
hat i
s, cer
tif
y that the solu
tion found b
y 
the rst miner to the b
lo
ck is corr
e
ct. e Bit
coin pro
tocol sets t
he 
diculty of the pr
oblem in such a wa
y that an a
verage o
f around 10 
minu
tes are r
equired fo
r t
he solu
tion to be found.
If the miner sol
ving the block were to cr
edit himself with mor
e than 
the 25 new bit
coins curren
t
ly allowed, the o
ther miners would r
ej
ect 
that miner
’
s block and w
ould con
t
inue w
orking on ndin
g the s
olu
-
tion fo
r their own versio
ns of it. Each block is sligh
tly dieren
t and 
therefo
re each has a dier
ent solu
tion.
In wha
t might seem count
er
int
uitive, when a miner sol
ves the com
-
pu
t
ing task, all other miners accep
t defeat, agree to in
clude this min
-
er’
s block as the next block in the block cha
in pro
vide
d it is ab
le to be 
validated, a
nd beg
in work o
n the next block. is wor
k invo
lves each 
miner’
s adding all the most recen
t transactions that ha
ve come in sin
ce 
the crea
t
ion o
f t
he pr
e
vious block to a n
e
w block, which will in its turn 
be solved and added to the never
-ending block ch
ain. 
e manner in which B
itcoin o
p
erat
es explains why the miner 
who was rst to a
rr
ive a
t a solution will credi
t himself with only the 
amo
unt of block r
ewards allowed b
y the Bitco
in prot
o
col. Doin
g s
o 
ensur
es acceptance of his b
lo
ck by the o
ther miners and recei
pt of its 

THE BOOK O
F SA
TOSHI
16
associated rewa
rds (i.e., transaction f
e
es). Equivalen
t
ly
, the other min
-
ers achieve no ga
ins by r
ej
ecting the block even though it is valid. e 
Bit
coin paymen
t system will hold its val
ue only when it is function
-
ing pr
operly
. If miners w
ere to reject all blocks but their v
er
y own, 
no con
s
ensus wo
uld e
ver be reached, the value o
f the overall system 
would be destro
yed, and no
ne of the miners w
ould b
e able to bene
t. 
In suc
h a cas
e, what
e
ver amo
unts of b
itcoin
s the miners hold wo
uld 
then become worthless. eref
ore, all miners bene
t if al
l respect the 
Bit
coin pr
otocol established wi
t
hin the shar
ed Bitcoin so

ware
. us, 
Bit
coin embodies the inver
s
e of the tragedy o
f the commons described 
earlier
.
N
ow let
’
s delve in
to the details of wha
t we earlier describe
d as the 
expensive co
mpu
ting task required t
o s
olve the ma
thematical pr
oblem 
of a block. F
or a miner to h
ave his block selected, he m
ust hav
e solved 
a pr
oblem associated with the block. is selection pr
o
cess is called 
“
pro
of
-of
-w
ork
” a
s it implies 
t
he miner had to w
ork fo
r it. T
o fully 
understan
d t
he mechanism in
volved, we n
e
ed to rst unders
t
and a 
cr
yptogra
phic concept kno
wn as a 
ha
sh
 f
un
c
tion
. en, we can expla
in 
how i
t is used in t
he con
text of a miner
’
s proo
f of work.
Crypt
ogr
aph
ic has
h functio
n— 
a di
git
al “fin
gerpri
nt
”
Cryptogra
phic h
ash
 is a com
plex algorithm tha
t p
erforms a v
er
y basic 
task–transf
orming text of a
rbitrary length (an entire book, a docu
-
men
t, a s
ent
ence, or even a single wo
rd) int
o a xed-length string 
of n
umbers that a
ppears rando
m. e followin
g Figure 3 pr
ovides 
some exam
ples. e ou
tput o
f a hash function, or sim
ply hash, is us
u
-
ally called t
he message dig
est and can be consider
ed t
he document
’
s 
“
ngerprint
”
.

How an
d Why Bitco
in wo
rks
17
In the gur
e above, no
te that the in
put “ere ar
e 2 dogs in t
he back
-
yar
d” leads to a co
mpletel
y dieren
t digest than “
ere a
re 3 dogs in the 
backyar
d”
. Simp
ly changing o
ne character leads to a
n outp
ut with all dig
-
its co
mpletel
y dieren
t. e digest ou
tputs in this gur
e are expr
essed
 
as hexadecimal num
bers. U
nli
ke the decimal system we co
mmonly use, 
the hexadecimal system has a base of 16. I
t emplo
ys sixteen symbols to 
rep
resent the sixteen n
umbers in the system. Sym
b
ols 0 thro
ug
h 9 rep
-
resen
t t
he num
bers 0 through 9, and lett
ers A through F rep
resent the 
num
bers 10 through 15. us, h
exade
cimal F repr
esents the num
ber
 
15. e hexadecimal num
ber 5A36 is t
heref
ore equal to (5 x 16
3
) + (10 
x 16
2
) + (3 x 16
1
) + (6 x 16
0
), which equals, in the decimal num
b
ering 
system, to 23,094. Experiment wi
th switching fro
m Hex to Dec on y
our 
own co
mpu
ter’
s ca
lculator t
o s
ee how i
t works. 
A Bit
coin user has no con
trol o
ver what the o
utpu
t (the digest in 
Figure 3) will look like. Also
, given a specic digest ou
tput, ndin
g 
an in
put tha
t would genera
te it is nearl
y impossible. 
us, genera
t
-
ing a digest i
s e
asy
, but deriving the o
rig
inal text from the dig
est is 
FIGURE 3: THE H
ASH ALGORITHM IN A
CTION

THE BOOK O
F SA
TOSHI
18
impossib
le. Emplo
ying the analog
y of the h
uman ngerprin
t, given a 
single ngerprin
t, we would nd i
t impossible to iden
tif
y the person 
who le it unless tha
t p
erson had been ngerprin
ted b
efor
ehand. 
Earlier we men
tioned that all miners can easily v
er
ify t
hat a sol
ution 
is corr
e
ct once it ha
s b
een found b
ut that ndin
g it is the dicult part. 
a
t’
s why cr
yptogra
phic hash is ideal for B
itcoin
’
s purpos
e. Miners, 
in their at
temp
ts to s
olv
e a block, must r
eproduce a specic pat
tern 
displa
yed by the con
tents o
f the digest. Since r
eproducing a s
p
ecic 
ou
tput wi
t
hin the digest is im
possible, they must in
crement a digi
t in 
the text and r
eca
lculate the hash aga
in and again un
til t
hey stumb
le 
upon the specic pat
tern in the digest that is r
equired by the B
itcoin 
pr
otocol. is pr
ocess is analogous t
o var
ying the number of dogs (“2 
dogs
”
, “3 dogs
”
, “4 dogs
”) in t
he exam
ple in Figure 3 to cr
eate dier
ent 
digests. F
or instan
ce, say that the curren
t Bitco
in pro
tocol spe
cied 
that the co
nten
ts of the digest disp
lay a pat
tern b
eginning with “00”
. By 
vary
ing the n
umber of dogs in the exam
ple, the correspo
nding hexa
-
decimal num
b
er in the digest will eventually sa
tisf
y this requiremen
t, 
indicatin
g a s
olu
tion to the block. 
Miners looking f
or the solutio
n must usually calculate the has
h mil
-
lions o
f times to nd the right pat
tern, but o
n
ly a single hash calcula
-
tion b
y other miners is necessary to validate it o
nce it is fo
und.
Bit
coin
’
s hash algo
rithm, which creates the co
nten
ts of the digest
 
from the in
put text, m
a
kes the system described above possib
le. us, 
an ideal cr
yptogra
phic hash function has four m
ain pro
p
erties
1
:
•
 
C
omputing
 the
 ha
sh
 value co
r
re
spond
ing t
o an
y g
iven m
essage is 
simple.
•
 
Genera
ting a m
essage t
hat has a gi
ven hash
 is impossible
.
•
 
Mod
ify
ing a me
ssage with
out c
hangi
ng the has
h
 i
s impossible
.
•
 
Find
ing two d
ier
ent me
ssages h
aving t
he same has
h
 i
s impossible
.
1
 htt
p://en.wik
ipedia.org/wiki/Cryptographic_hash_function

How an
d Why Bitco
in wo
rks
19
e follo
wing exam
ple, taken from W
i
kipedia, illustrates the h
ash
 
function in use. 
Al
ice poses a t
ough ma
th pr
oblem t
o Bob and c
lai
ms she has sol
ved 
it. Bo
b would l
ike to try it h
imself
, bu
t would also li
ke to ensu
re 
tha
t Al
ice is not b
lun
g. eref
ore, A
lice write
s down her solu
-
tio
n, comp
utes i
ts hash a
nd tel
l
s Bob th
e hash val
ue (whils
t keepi
ng 
the so
luti
on secret). 
en, when Bob co
mes up with t
he solu
tion 
hi
mself a f
e
w da
ys lat
er
, Al
ice can p
rove t
hat s
he had th
e solut
ion 
ea
rlier by r
eveal
ing i
t and ha
ving Bob h
ash it a
nd chec
k tha
t it 
ma
tche
s the hash v
alue giv
en to hi
m befor
e. (is is an exa
mple 
of a si
mpl
e comm
itmen
t s
chem
e; in actua
l pract
ice, Al
ice and Bo
b 
will be com
put
er progr
ams, an
d the secr
et would be so
methi
ng les
s 
easil
y spoo
fed tha
n a clai
med puzzle so
luti
on).
H
ash funct
ions f
orm part of the process ena
bling users to digitally 
sign a document or text in B
itcoin. I
n the cont
ext of Bit
coin
’
s pr
o
of-o
f-
work
, which will b
e discussed b
elow
, the two most useful characteris
-
tics of the hash functions a
re the follo
wing:
•
 
e impossib
ility of genera
ting a message fro
m a given hash
•
 
Generating an en
tirely n
e
w hash by c
hanging onl
y one character 
in the message 
Se
veral types of hash algo
rithm have been crea
ted, and Bi
tcoin uses 
two of them: S
H
A
-256 for the pr
oof-of-wo
rk and RIPEMD-160 fo
r the 
Bit
coin address. e h
ash funct
ion is a
t the heart of the proof-o
f-work, 
which we
’
ll dis
cuss next.

THE BOOK O
F SA
TOSHI
20
Mi
ner’
s Proof o
f work
A
t an
y given time, each miner is activel
y engaged in crea
ting the next 
block to be added to the block cha
in by resolvin
g a dic
ult pr
oblem, 
which is called a 
proo
f-of-work
. 
e rst miner to solve the p
roof-of-
wor
k is rewarded with freshly min
ted bi
tcoins (25 bi
tcoins as o
f this 
writing) and wi
th t
he cumula
t
ive tran
s
action fees associated with the 
transactions inc
luded in the block being creat
e
d. T
ransaction f
e
es, 
typically a nomin
a
l amoun
t, are added b
y payers when they send their 
transactions. B
y around the y
e
ar 2140, all bit
coins will be mined, and 
miners will be rewarded solely wi
th t
ransaction fees. 
e pr
oof-of-wo
rk can thus be thought o
f as a race between bitco
in 
miners to disco
ver the SH
A
-256 hash of the block they are trying to 
crea
te that will hav
e a cer
tain characteristic. A
s we saw earlier
, the hash 
ou
tput is sim
ply a very large n
umber expressed in hexadecimal. e 
miner’
s goal, the pr
oblem that m
ust be s
olv
e
d, is to gen
erate a hash 
ou
tput tha
t is below a certain value. e rs
t miner to com
pute a value 
havin
g this characteristic wins, and his v
ersion of the block will, a
er 
validation b
y the other miners, be added to the block cha
in dis
cussed 
earlier in this cha
pter
. 
Fo
r simplici
ty
, imagine that the has
h outp
ut was actually a num
b
er 
between 0 and 1,000,000 and tha
t the rst miner to get a h
ash outp
ut 
of less tha
n 10,000 wins. e 10,000 acts as a threshold, a
nd each block 
within Bi
tcoin con
tains a n
umber w
hose sole purpos
e is to ob
tain the 
thresho
ld. 
e n
umber within the Bitco
in blo
ck tha
t is tested agains
t t
he 
thresho
ld va
lue is kno
wn as the “no
nce
”
. Each miner incremen
ts its 
nonce b
y a certain amoun
t until the hash ou
tput f
or its block is belo
w 
the threshold
. As we said earlier
, each miner’
s block has dier
ent info
r
-
ma
t
ion an
d t
heref
ore a dier
ent hash o
utpu
t for the same “
nonce
”
. is 
pr
o
cess is illustra
ted in Figure 4.

How an
d Why Bitco
in wo
rks
21
e Bi
tcoin pr
otocol, opera
ted by the sowar
e r
unning on each 
miner’
s com
puter
, adjus
ts t
he diculty level of the p
roblem so as to 
take aro
und 10 minu
tes before the rs
t miner s
olv
es it. e purpose 
is to ha
ve the block chain u
pd
at
e
d on a r
egu
lar basis with a new block 
con
taining the lates
t transact
ions sen
t during the prior 10 min
utes. 
is value is somewha
t arbitra
r
y and, as will be seen in later cha
pters, 
Sat
oshi devoted some of hi
s dis
cussions t
o t
his top
ic. 
e pr
ev
ious discussion co
mpar
ed t
he nonce t
o a threshold. Because 
the hash
’
s numbers, termed the pr
oof-of-wo
rk, are in a hexadecimal, 
or base 16, num
ber
ing system, this tran
slates to the rs
t X number of 
byt
es b
eing the digit 0, where X is ad
justed periodica
lly to keep the 
diculty level of the p
roof-of-wo
rk fairly co
nstant. 
Fo
r examp
le, assume tha
t block #282,435 of the block chain
 has the 
follo
wing SH
A
-256
 o
utput:
FIGURE 4: PR
O
OF-OF
-WO
RK ILLUSTRA
TED

THE BOOK O
F SA
TOSHI
22
0000000000000000c6647dad26b01b28f534223450d75d3b6b2882855039b673
Recall t
hat in the base 16 n
umber system, there ar
e symbols repr
e
-
senting the sixteen n
umbers 0 through 15; the symbols r
epresen
t
ing 
0 through 9 in this system a
re 0 through 9 as in the decimal, o
r b
ase 
10, system, an
d numbers 10 thro
ug
h 15 of the hex syst
em are rep
re
-
sented b
y A through F
. e hexadecimal num
b
er above is co
mp
r
ised 
of 64 digits. S
ince the terms to the le in a hexadecimal num
b
er rep
-
resen
t hig
her power
s of 16 hence larg
er numbers, to make the h
ash 
ou
tput smaller
, the le
ading digits wi
t
hin the  hash ou
tput m
ust be 0. 
is is wh
y stating that the ha
sh outp
ut requiring t
o b
e below a cer
-
tain thresho
ld translat
e to have a certain n
umber of leading digits be 
0. V
ie
wed in either wa
y
, pr
o
of-of-w
ork is nding a no
nce that will 
genera
te a hash ou
tput belo
w the threshold estab
lished by the Bi
tcoin 
pr
otocol at the time. 
In the exa
mple in Figure 4—P
roof-of-w
ork illustra
ted, only with the 
rst sixteen digits o
f the outp
ut equaling 0 could the has
h outp
ut fall 
below the thres
hold set by Bi
tcoin
’
s pr
otocol. er
efor
e, the miner who 
obtain
e
d this num
b
er rst and so “w
on
” that block had t
o keep chang
-
ing the “
nonce
” number un
ti
l a hexadecimal num
b
er havin
g at least 
the desired n
umber of leading 0s was genera
ted. As in a lo
tter
y
, t
he 
miners b
uying the most “
tickets
” (i.e., genera
ting the most num
bers of 
SH
A
-256 out
put) ha
ve a better chan
ce of nding a n
umber having the 
correct n
umber of 0s. is requir
ement o
f t
he Bi
tcoin system has led 
to a race to cr
e
at
e hardwa
re capab
le of genera
t
ing mo
re hash per sec
-
ond
. e lucky miner who rst di
s
cover
ed the hash for b
lo
ck #282,435 
of the block ch
ain incremen
ted the nonce to 505,482,605 sta
ted in 
decimal, meaning this miner had t
o generate o
ver 500 million “hash
” 
befor
e nding one with the co
r
rect num
ber of leading zeroes.
As sta
ted previou
sly
, t
he Bit
coin pro
tocol’
s goal is to ha
ve a block of 
transactions cr
eated ap
pro
ximatel
y e
very 10 minutes. F
or a given level 
of diculty
, if mor
e miners join—or mo
re pr
ecis
ely
, as mor
e hash are 

How an
d Why Bitco
in wo
rks
23
calcul
at
e
d per se
cond—the ch
ances of discov
er
ing the req
uired digest 
(hash ou
tpu
t) in less than 10 minu
tes increases. Aer a certain num
-
ber of blocks, the Bi
tcoin pr
otocol evaluat
es how fast blocks ar
e being 
genera
ted; if so
oner than 10 min
utes o
n averag
e, the le
vel o
f dic
ulty 
is increased (i.e., the n
umber of leading 0s incr
e
ases, decreasing the 
pr
obability of a
ny single miner
’
s obtainin
g a digest having tha
t charac
-
teristic); if lon
ger
, the dicu
lty is decreased (i.e., the n
umber of lead
-
ing 0s decreases, incr
e
asing the pr
obability o
f obtaining i
t). 
Once a miner disco
vers a nonce p
rovidin
g t
he corr
e
ct hash
 out
-
pu
t, t
he block is br
oadcasted, and o
t
her miners verify it, accept i
t, and 
begin work o
n t
he next block. 
us, Bitco
in operates like a
n ongo
ing 
lott
er
y game r
estarting ever
y 10 minutes. W
ho will b
e the lucky miner 
to nd a no
nce with the correct characteristics? 
Figure 5 illus
t
rat
e t
he concep
t b
ehind the pr
oof-of-wo
rk. No
te 
that ther
e is more inf
ormation in the b
lo
cks than sho
wn; it has been 
reduced f
or simplici
ty
.
FIGURE 5: WINNER O
F PROOF-OF
-WORK

THE BOOK O
F SA
TOSHI
24
Mi
ners’ c
ons
ensus & o
rphan b
locks
As sta
ted earlier
, Bitcoin r
elies heavily on co
nsensus in or
der to func
-
tion. is co
ncept, which will b
e discusse
d furt
her in Chap
ter 9, 
comes in
to pla
y w
hen two miners solv
e their blocks at abou
t the same 
time. When this occurs, the two miners bo
t
h br
o
adcast their blocks 
incl
uding solution
s across the Bi
tcoin system. All other miners r
eceive 
and r
etain both but their wo
rk on their next block will be b
ased upon 
which of the two curren
t blocks they receive rst. Sa
y 50% of the min
-
ers receiv
e the block from Miner A r
st and the others r
e
ceive M
iner 
B
’
s block rst. is si
tuation i
s i
llustra
ted for block #29302 in Figur
e 
6 below
. 
is sit
uation is an
a
logous t
o a race going in
to overtime. W
hich 
of the two b
lo
cks becomes part of the true block chain will depend 
upon ho
w quickly the next block is sol
ved and by who
m, a miner w
ho 
receiv
e
d A
’
s block or o
ne who received B
’
s blo
ck. A
t this p
oin
t, two 
versio
ns of the block cha
in exist, with half the miners ha
ving miner 
A
’
s versio
n of block #29302 and the o
t
her havin
g miner B’
s versio
n. 
Which o
f these t
wo versio
ns will sur
vive depends on which versio
n 
FIGURE 6: A BL
O
CK SPLIT

How an
d Why Bitco
in wo
rks
25
the miner solving the next b
lo
ck, #29303 in Figure 6, h
as on his com
-
pu
ter
. When block #29303 is solv
e
d, this versio
n of the block chain 
becomes the long
est of the two and h
ence the ocial one. All miners 
then dro
p t
he other ver
sion of the block cha
in, w
hich becomes wha
t is 
known as a
n 
or
phan block
. is process is ill
ustrated in Figure 7.
Why do
es Bit
co
in wo
rk?
So far we
’
ve cover
ed how Bi
tcoin wo
rks, but no
t w
hy
. T
o understand 
this, knowledge o
f a few additional concep
ts, open source sowar
e for 
instance
, is necessar
y
. ese concepts a
re as follo
ws and ar
e explained 
b
el
ow
:
•
 
Bitco
in is 
open sou
rce sow
are
. 
•
 
Bitco
in soware estab
lishes 
the
 ope
rating direc
tive
s
 the miners 
and wallet clien
ts must f
ollow
.
•
 
Bitco
in soware also denes and o
perates 
a co
mmuni
cati
on
 
protocol
.
•
 
D
i
str
ibute
d 
le
 shar
ing
 of the block chain allows f
or open 
bookk
eep
ing
. 
FIGURE 7: THE L
ONGEST CH
AIN WINS

THE BOOK O
F SA
TOSHI
26
Open s
our
ce s
owar
e is comp
uter sowar
e whos
e source code
 
is ava
ilable for a
nyo
ne to see. Mo
reover
, it opera
tes under a special 
license that allo
ws anyo
ne to modify and to use it. W
ith the s
our
ce 
code, a pr
og
rammer can r
ecreate the p
rogram (the bina
r
y le that 
runs on co
mpu
ters) and modify it at will. 
us have s
prung up man
y 
imita
tors of 
Bitcoin, o
ther vir
tual currencies diering fro
m it only cos
-
metically and, fo
r the most part, incorporatin
g no signic
an
t innova
-
tions, wi
t
h the exceptio
n of a ver
y few like N
amecoin. e ma
jority of 
these alternativ
e vir
tual currencies ar
e b
ased on chan
ging the rate a
t 
which blocks ar
e created, the t
otal number of co
ins in circulation, 
and 
the cr
yptogra
phic hash algorithm used. 
A sowar
e’s code being open source allows a
n exp
ert to analyze 
it an
d to validate its in
tegrity
, that is, conrm tha
t it does what it
 
purports to do
. A pro
minent exam
ple of o
p
en source sowar
e is 
Linux
, which has dis
placed Microso W
indows in mark
et share in
 
the ser
ver industry
. B
ecause it is o
p
en source, p
roblems a
re fo
und 
and xed m
uch mor
e rapidly tha
n if it were p
rop
r
ietar
y since mul
-
tiple p
rogrammers ar
e con
t
inually examinin
g and imp
rovin
g t
he 
code. Linux has so far demo
nstrat
e
d that the gr
e
at
er goo
d and self-
int
erest can wo
rk in concert, at least wi
th respec
t to mana
g
ing open 
source sowa
re. is openness en
sures a high level of in
tegrity not 
achievable in p
roprietary soware, wher
e only the rep
utation o
f t
he 
com
pany r
esponsible f
or the soware gua
rantees tha
t it does what it
 
is sup
pos
ed to do
.
Bit
coin also operates o
ver the In
ternet using a dened pr
otocol of 
operatio
ns that miners a
nd wallet clients m
ust follow
. W
allet clients—
sowar
e programs tha
t are a
pps on sma
r
tpho
nes or pr
ograms on per
-
sonal com
puter
s—are wha
t is use
d when someone is sending a pa
yment 
transaction, which miners then valida
te prior to their being inco
r
po
-
rat
ed in t
he block cha
in. A single miner devi
ating fr
om the pro
tocol 
would ha
ve his opera
tion rejected by the r
est of the miners an
d would 
not be allowed to co
ntribu
te to the operatio
n of the network. 

How an
d Why Bitco
in wo
rks
27
One typical ar
gument raised again
st Bitco
in concerns the limit o
n t
he 
maxim
um number of b
itcoin
s t
hat will ever be crea
ted, which Satoshi 
N
akamoto set at 21 millio
n. Once reached, what co
uld preven
t s
omeo
ne
 
from incr
easing this limit? N
othing really
, but he w
ould need the co
op
-
eratio
n of the majo
r
ity of min
ers for this cha
nge to be accepted. E
ven 
were the m
ajority o
f miners to agree to li this res
tr
iction, if all did not 
agree, then a sp
lit in the block chain w
ould result. 
os
e in favo
r of li
-
ing the res
tr
iction would use on
e version o
f t
he block cha
in w
hile those
 
not in fa
vor wo
uld use a dierent v
ersion. In e
ec
t, we wo
uld have two 
virtual cur
rencies ra
ther than one, the “
original Bitco
in
” and a “
Quanti
-
tativ
e E
asing Bit
coin
”
. Over the long term, on
e would hold its val
ue lon
-
ger and bet
ter and would ther
efore become the p
referred ver
sion while
 
the other wo
uld drop in value. W
hat wo
uld b
e your guess a
s to which
 
one w
ould hold its value lo
nger and r
etain the inter
est of users of B
it
-
coin? P
ersonally
, I have a very goo
d idea which one.
e Bi
tcoin develop
ment co
mmunity is v
er
y conservative wi
t
h 
rega
rd to chan
ges, and, a
t least so far
, the pref
er
red mean
s of insti
-
tu
t
ing ma
jor chang
e has be
en the crea
t
ion o
f ne
w virtual cur
rencies, 
some of which h
ave no limi
ts as to number o
f coins. 
A nal characteristic underpinnin
g Bitco
in is t
ha
t, not only is the 
sowar
e open s
ource
, but so is its bookkeeping. Some h
ave termed the 
block cha
in “trip
le-entr
y bo
okkeeping
” as it r
e
volu
tionizes accoun
t
-
ing. An
yone can in
spe
ct the block chain an
d verif
y that the accoun
ting 
does follow the curren
t established r
equiremen
ts and specications o
f 
the Bit
coin pro
tocol. e distribu
ted le sharing of the block ch
ain 
means tha
t an
yone running the Bit
coin soware i
s connected to the 
Bit
coin networ
k and has access to the block ch
ain.
T
o gain a greater un
derstanding of the b
ri
lliance of the co
nceptual 
basis of B
itcoin, I highly r
e
commend r
eading Satos
hi Nakamo
to
’
s 
white pa
p
er
. e informa
tion I ha
ve pro
vided here should make the 
paper mor
e accessible. A r
eproduction o
f this p
aper is inc
luded at the 
end of this book.

THE BOOK O
F SA
TOSHI
28
ht
tp://bi
tcoin.org/b
itcoin.pdf
W
e hope this chap
ter has helped you un
derstand the cor
e con
-
cepts. Y
o
u should no
w b
e capable o
f reading the Bi
tcoin paper and the 
rema
inder of this book with considerab
ly more ease. 
Impli
ca
tio
ns of B
itc
oi
n
Bit
coin
’
s im
p
act as a monetary system is tremendo
us. One advan
tage 
is the abili
ty it gives people to “
wire
” cur
rency across the pla
net as 
simp
ly as sending an ema
i
l. is is particularly adva
ntageous t
o immi
-
gran
t workers who wis
h to s
end mon
e
y to their rela
tives in their coun
-
tries of origin. In co
ntrast, co
mpanies that wir
e money across bo
rders 
char
ge high fees to do so. er
e are f
e
es associated with co
nverting 
from na
tional currencies to B
TC and back aga
in, but these con
version 
fees ar
e smal
l in com
parison to wiring costs. 
Another bene
t touched on ear
lier regards o
nline shopp
ing and 
online do
nations. I
’
m condent tha
t the c
urren
t system of payin
g with 
credit ca
rds will be complet
ely chan
ged in the f
ut
ure. Credit 
c
ard 
p
ay
-
men
ts require giving ext
ensive info
rmation abou
t the payer
, including 
billing addr
ess and the 3-digit code on the back of 
credit card
s. In 
essence, this is the Bi
tcoin equivalen
t of giving yo
ur private en
cr
yption 
keys to the mer
chant. 
e hig
h num
b
er of frauds r
esulting from this 
secur
ity weakness has ma
nifested itself in the fo
r
m of high fees an
d 
char
geback with which merc
hants ha
ve to cope. Cr
edit card co
mpa
-
nies spend a hug
e amoun
t of cash ever
y year in dealing with fraud
u
-
lent c
harges. ese costs a
re transferr
e
d to merc
hants, who
, in turn, 
transfer them t
o consumers via higher p
r
ices for g
o
ods and ser
vices. 
Another ma
jor im
p
act of Bi
tcoin is on the mo
netar
y f
ro
nt, speci
-
cally in the system
’
s ability to be money a
nd not just a curren
c
y
. A cur
-
rency has the follo
wing pro
per
ties:

How an
d Why Bitco
in wo
rks
29
•
 
Is a medi
um of excha
nge (used as an int
er
mediar
y in trade)
•
 
Is a uni
t of accoun
t (can be counted, i
s quantiab
le)
•
 
Is d
urable (lon
g duration)
•
 
Is di
v
isible (so to ha
ve smaller units)
•
 
Is portable (so as to be easily trans
p
ortable)
•
 
Is fungib
le (mut
ua
lly int
erchang
eable, 1 unit o
f a spe
cic value 
can rep
lace another iden
t
ical unit)
M
oney has all the pro
p
erties listed above an
d, in addition, on
e other
:
•
 
e abili
ty to preser
ve its val
ue over the lon
g term.
U
n
like money
, a currency is subject to inatio
n. In the early 1900s, 
inatio
n was dened simply as the action o
f inating something, as 
in the case of a currency
, by p
rinting mor
e of it. T
oday’
s dic
tionary 
denes it as a g
eneral increase in prices. H
owever
, rising prices are a 
symp
tom of a devalua
ting currency
, which occ
urs when mor
e of it is 
pr
es
ent tha
n t
here was befo
re. I
t is inter
esting but no
t surprising that 
this transitio
n in denition corr
esponds to a time ov
er which paper 
currencies became furt
her and further detached from go
ld and sil
-
ver
, a de
velo
pment which leads to higher p
rices. O
ur ancesto
rs saw
, 
for in
stance, food prices rema
in vir
tually unchan
ged throughou
t their 
lifetimes. H
owever
, today’
s p
opula
tion has been conditio
ned to vie
w 
rising prices as a
n immutab
le fac
t of life
, li
ke gravi
ty
. I
t is as if, in a 
place where i
t rains all the time, nobody has made the connection 
between clouds an
d rain. But who could bla
me them since they have 
never seen a blue sky? I
n the same manner
, most people today do n
ot 
perceive risin
g foo
d prices as cau
s
ed by currency ination, wi
th s
ome
-
times a lag of several years f
or the rising prices to ma
nifest themselves. 
is was the case with the currency ination of the 1960s o
nly mani
-
festing i
tself in t
he follo
wing decade, the 1970s. 

THE BOOK O
F SA
TOSHI
30
T
o maintain i
ts purcha
sing power o
ver the long term (i.e., t
o not be 
subject to ina
tion), the money sup
ply mu
st b
e limited. Gold a
nd sil
-
ver ha
ve been t
he money o
f choice fo
r thousands of y
ears. eir sup
ply 
on this pla
net is limited and r
equires an
yone who in
tends to acq
uire 
mor
e of it to trade ener
g
y and time for them thro
ugh mining. Y
ou 
could say tha
t the eort expended in mining a pr
ecious metal is analo
-
gou
s to proof-o
f-work in the Bi
tcoin system. Con
trast this real work 
with sim
ply prin
t
ing mor
e dollar bills. P
aper currencies wer
e initial
ly 
adop
ted to act only as a con
venient s
ubstitut
e (derivative) f
or precio
us 
metals, thus facilita
ting transactions. P
aper currencies, being easily 
rep
roducible, ha
ve alwa
ys b
een subject to inatio
n, as goldsmiths – 
and la
ter bankers – used fract
ional reserve banking to lend mor
e (i.e., 
prin
t more pa
p
er currency) than they ac
tually had gold in s
torage. i
s 
has led to the frequen
t “bank r
un
” crises littering the hist
or
y bo
oks. 
Before the adv
ent of co
mpu
ters and netw
orking, transactions wer
e 
limited to p
recious metals and pa
per c
urrencies. Since then, e
le
ctronic 
comm
unications h
ave in
troduced a new way of perfo
r
ming transac
-
tions o
f which gold and silv
er could never be direct
ly a part. U
ntil 
now
, onl
y centrally con
t
rolled and e
lec
tronically transmi
ttable cur
-
rencies exis
ted, allowing the con
trollers free r
ein in de
ciding the size 
of the underl
ying cur
rency’
s su
pply
. Presiden
t Nix
on demons
trated 
this clearly when he 
remov
e
d the dollar’
s con
vertibility in
to gold on 
for
eign exchan
ge markets. e V
iet
nam W
ar and L
yndon J
ohnson
’
s 
“
great society” were funded b
y diluting the US dollar via the electronic 
prin
ting press. I
t took time to manif
est itself via the rising prices of 
commodities, b
ut once i
t did, the price of gold in do
ll
ars has e
ec
-
tively been higher than the xed $35 per ounce o
f gold that p
revailed 
befor
e t
he dollar was unlinked fro
m t
he gold s
t
andar
d. I
t then be
came 
a free-oating, co
nstantly ina
ting currency
, like an
y other natio
nal 
currency in existence today
.  
As w
e dis
cuss in Chap
ter 7, paper currencies (at) allo
w govern
-
men
ts to fund decit spending b
y stealing f
ro
m t
he value o
f t
he 

How an
d Why Bitco
in wo
rks
31
currency in circulation. e poor an
d, to some exten
t, the midd
le class 
ar
e t
he most a
ec
ted by currency inatio
n w
hile the rich use debt and 
various na
ncial der
iva
tives to acquir
e companies a
nd income-pr
o
-
ducing co
mmercial real estat
e. ey know the debt will be devalued 
along wi
t
h the currency
, pr
oviding an a
r
ticial
ly obta
ined additional 
gain. e rs
t way to addres
s t
he “war o
n poverty” is to get rid of 
currency ination an
d return to a fo
rm of money whose value holds 
ov
er t
he lon
g term. But do not expect gov
ernment to pr
opose or even 
ent
er
tain a pr
opos
al inv
olving this course o
f ac
tion.
Curr
ently
, man
y magazine and newspa
p
er articles on Bi
tcoin pr
es
-
ent i
ts “
deationa
r
y” nat
ure as its ma
in negative
. By deation, they 
mean tha
t prices measured in BTC will decline. I
n reality
, this is Bit
-
coin
’
s primar
y benet. ey report tha
t p
eople will be “hoarding
” bit
-
coins ra
ther than spending them in the econ
omy
. First o
f al
l, imagine 
that t
omorro
w bit
coins wer
e to be
come the currency of c
hoice for 
your co
untr
y
. B
eing huma
n, you would still ha
ve to eat a
nd to pro
-
vide for a s
helter; hence you wo
uld have to mak
e t
hese two expenses. 
Wha
t the commen
ts in t
hese articles demons
trate is a misconcep
tion 
abou
t w
hat mo
ney is. By saving ra
ther than spending—“hoar
ding” is 
merel
y a pej
ora
tive term for sa
ving—people ar
e delaying con
sump
t
ion 
to a la
ter time. W
e ha
ve seen t
his type of behavio
r exhibited r
e
cently 
by som
e s
o-called “
bi
tcoin millionair
es
”
, who, a
t some poin
t, b
ecome 
comfo
rt
able eno
ugh to spend s
ome o
f their bitco
ins on luxury items. 
In a
n economic system 
b
ased on money—currency that h
olds its value 
ov
er t
he lon
g term—s
av
ers are no
t competing fo
r resources wi
th man
-
ufacturer
s, builders, factories, and those extracting commodities (i.e., 
mark
et
able i
tems) by def
err
ing spending. By r
esources, we mea
n any 
form o
f energ
y
, commodities, time, and labo
r
, p
articul
arly s
p
ecialize
d 
labor
. Imagine the case of a person who decides to sa
ve by sta
y
ing 
home ra
ther than hooking up hi
s t
railer and tra
veling cros
s-country 
for vaca
tion. By no
t traveling, he allo
ws t
he gasoline he wo
uld have 
expended in travelin
g to be us
ed by
, for in
stance, a man
ufacturer to 

THE BOOK O
F SA
TOSHI
32
transport ma
terial for building a n
e
w plan
t. Printing dollar
s do not 
crea
te more ba
r
rels o
f oil, mor
e gigawa
tts of electricity
, or mor
e hours 
in a day
. I’
ve illustrat
e
d this concept wi
th rather simp
le examples, b
ut 
I hope yo
u can se
e that a currency like Bi
tcoin, with the ab
i
lity to ho
ld 
its value deriv
ed f
rom i
ts limited sup
ply
, has majo
r ramication
s. 
In this ch
apter
, we
’
ve cover
ed the technology b
ehind Bit
coin, the 
sowar
e concept underl
ying it, and we
’
ve touched o
n an alterna
t
ive 
view of econo
mics to which Satoshi N
a
kamot
o himself likely adhered. 
N
ow that y
ou hav
e a goo
d understandin
g of what B
itcoin is all abou
t 
and ho
w it wo
rks, turn the page and meet Bi
tcoin
’
s creato
r
, Satoshi 
N
akamoto! 
 

33
3
T
h
e Fi
rst Post o
n 
Cr
ypt
o M
ai
li
ng List
T
HIS IS SA
TOSHI N
AKAMOT
O’
S 
announcem
ent of Bi
tcoin. 
I
t was posted on the Cryptograph
y Ma
i
ling list, a f
orum for 
those inter
ested in an
yt
hing re
lated to cr
yptogra
phy
.
Bit
coi
n P2P e-ca
sh p
aper 
Satoshi Nakamoto Sat, 01 Nov 2008 16:16:33 -0700 
I’ve been working on a new electronic cash system that’s fully 
peer-to-peer, with no trusted third party.
The paper is available at:
http://www.bitcoin.org/bitcoin.pdf

THE BOOK O
F SA
TOSHI
34
The main properties:
Double-spending is prevented with a peer-to-peer network.
No mint or other trusted parties.
Participants can be anonymous.
New coins are made from Hashcash style proof-of-work.
The proof-of-work for new coin generation also powers the 
network to prevent double-spending.
Bitcoin: A Peer-to-Peer Electronic Cash System
Abstract. A purely peer-to-peer version of electronic cash 
would allow online payments to be sent directly from one party 
to another without the burdens of going through a ﬁnancial 
institution. Digital signatures provide part of the solution, but the 
main beneﬁts are lost if a trusted party is still required to prevent 
double-spending. We propose a solution to the double-spending 
problem using a peer-to-peer network. The network timestamps 
transactions by hashing them into an ongoing chain of hash-based 
proof-of-work, forming a record that cannot be changed without 
redoing the proof-of-work. The longest chain not only serves as 
proof of the sequence of events witnessed, but proof that it came 
from the largest pool of CPU power. As long as honest nodes 
control the most CPU power on the network, they can generate 
the longest chain and outpace any attackers. The network itself 
requires minimal structure. Messages are broadcasted on a 
best effort basis, and nodes can leave and rejoin the network at 
will, accepting the longest proof-of-work chain as proof of what 
happened while they were gone.
Full paper at: http://www.bitcoin.org/bitcoin.pdf
Satoshi Nakamoto
The Cr
yptography Mailing List

35
4
Scalab
i
lit
y Co
ncerns
H
ERE, SA
TOSHI REPLIES
 to a commen
t concerning scal
-
abili
ty
. T
o make a pa
yment, a clien
t’
s wallet needs to have the 
full block chain, and wi
th a g
ro
wing block chain, i
t would 
pu
t a memor
y burden o
n those sma
ll client wallet. is iss
ue was 
addressed by Sa
toshi in a la
ter release. T
o
day
, a smartph
one ap
p can 
easily handle tran
s
actions by co
nnect
ing to a ser
ver it trusts tha
t has 
the full block chain.
Re: Bit
coi
n P2P e-ca
sh p
aper 
Satoshi Nakamoto Sun, 02 Nov 2008 17:56:27 -0800 
James A Donald wrote:
Satoshi Nakamoto wrote:

THE BOOK O
F SA
TOSHI
36
I’ve been working on a new electronic cash system that’s 
fully peer-to-peer, with no trusted third party.
 
The paper is available at:
http://www.bitcoin.org/bitcoin.pdf
W
e ver
y
, ver
y much need such a system, but the way I 
understand your proposal, it does not seem to scale to the 
required size.
For transferable proof of work tokens to have value, they must 
have monetar
y value. T
o have monetar
y value, they must be 
transferred within a ver
y large network - for example a ﬁle 
trading network akin to bittorrent.
T
o detect and reject a double spending event in a timely 
manner
, one must have most past transactions of the coins in 
the transaction, which, naively implemented, requires each 
peer to have most past transactions, or most past transactions 
that occurred recently
. If hundreds of millions of people are 
doing transactions, that is a lot of bandwidth - each must 
know all, or a substantial part thereof.
Long before the network gets anywhere near as large as that, 
it would be safe for users to use Simpliﬁed Payment Veriﬁcation 
(section 8) to check for double spending, which only requires 
having the chain of block headers, or about 12KB per day. Only 
people trying to create new coins would need to run network 
nodes. At ﬁrst, most users would run network nodes, but as the 
network grows beyond a certain point, it would be left more and 
more to specialists with server farms of specialized hardware. A 
server farm would only need to have one node on the network and 
the rest of the LAN connects with that one node.
The bandwidth might not be as prohibitive as you think. A typical 
transaction would be about 400 bytes (ECC is nicely compact). 
Each transaction has to be broadcast twice, so lets say 1KB per 
transaction. Visa processed 37 billion transactions in FY2008, 

Scalabi
lit
y Con
cerns
37
or an average of 100 million transactions per day. That many 
transactions would take 100GB of bandwidth, or the size of 12 
DVD or 2 HD quality movies, or about $18 worth of bandwidth at 
current prices.
If the network were to get that big, it would take several years, and 
by then, sending 2 HD movies over the Internet would probably 
not seem like a big deal. 
Satoshi Nakamoto
The Cr
yptography Mailing List

39
5
T
h
e 51% A
tt
ack
I
N THIS POST
,
 Sa
toshi addresses an a
rgument co
ncerning the so-
called 51% attack. I
n this s
cenario
, a miner or gro
up of miners 
could gain a ma
jority o
f hash genera
t
ion pow
er (i.e., the pr
o
of-of-
wor
k) in order to ini
ti
at
e and then reverse transactions a
nd so double 
spend, to p
revent som
e t
ransactions fro
m being conrmed or to p
re
-
ven
t s
ome o
r al
l other miners fro
m mining valid blocks.
Re: Bit
coi
n P2P e-ca
sh p
aper 
Satoshi Nakamoto Mon, 03 Nov 2008 11:45:58 -0800 
John Levine wrote:
Satoshi Nakamoto wrote:
As long as honest nodes control the most CPU power on the 

THE BOOK O
F SA
TOSHI
40
network, they can generate the longest chain and outpace 
any attackers.
But they don’t. Bad guys routinely control zombie farms 
of 100,000 machines or more. People I know who run a 
blacklist of spam sending zombies tell me they often see a 
million new zombies a day
.
This is the same reason that hashcash can’t work on today’
s 
Internet—the good guys have vastly less computational 
ﬁrepower than the bad guys.
Thanks for bringing up that point.
I didn’t really make that statement as strong as I could have. The 
requirement is that the good guys collectively have more CPU 
power than any single attacker. 
There would be many smaller zombie farms that are not big 
enough to overpower the network, and they could still make 
money by generating bitcoins. The smaller farms are then the 
“honest nodes”. (I need a better term than “honest”) The more 
smaller farms resort to generating bitcoins, the highe the bar gets 
to overpower the network, making larger farms also too small 
to overpower it so that they may as well generate bitcoins too. 
According to the “long tail” theory, the small, medium and merely 
large farms put together should add up to a lot more than the 
biggest zombie farm.
Even if a bad guy does overpower the network, it’s not like he’s 
instantly rich. All he can accomplish is to take back money he 
himself spent, like bouncing a check. To exploit it, he would 
have to buy something from a merchant, wait till it ships, then 
overpower the network and try to take his money back. I don’t 
think he could make as much money trying to pull a carding 
scheme like that as he could by generating bitcoins. With a zombie 
farm that big, he could generate more bitcoins than everyone else 
combined.

Th
e 51% A
ttack
41
The Bitcoin network might actually reduce spam by diverting 
zombie farms to generating bitcoins instead.
Satoshi Nakamoto
The Cr
yptography Mailing List

43
6
About Centrall
y
 
C
o
ntr
o
lled Netwo
rks
 
Versus P
eer-t
o-Peer
 
Netwo
rk
s
S
A
TOSHI MAKES A REFEREN
CE
 to the ability o
f governmen
ts 
to sh
ut down a
ny cen
t
ralized system such as the m
usic le-shar
-
ing websi
te, N
apster
, or the digital gold currency E-gold
. Pure 
peer-to-peer
 netwo
rk systems ha
ve been demonstra
ted to b
e mor
e 
resilien
t.

THE BOOK O
F SA
TOSHI
44
Re: Bit
coi
n P2P e-ca
sh p
aper 
Satoshi Nakamoto Fri, 07 Nov 2008 09:30:36 -0800 
[Lengthy exposition of vulnerability of a systm to use-of-force 
monopolies ellided.]
Y
ou will not ﬁnd a solution to political problems in 
cr
yptography
.
Y
es, but we can win a major battle in the arms race and gain a 
new territory of freedom for several years.
Governments are good at cutting off the heads of a centrally 
controlled networks like Napster, but pure P2P networks like 
Gnutella and Tor seem to be holding their own. 
Satoshi
The Cr
yptography Mailing List

45
7
Sa
t
os
h
i o
n th
e In
itial
 
In
fl
a
ti
o
n Ra
te o
f 35%
I
NITI
ALL
Y
, 
w
ith 50 bi
tcoins cr
eated ever
y 10 minu
tes for the rst
 
few years, 2.6 million b
itcoin
s were being crea
ted yearly
. Aer
 
Bit
coin started with a balance of 0 b
itcoins in J
anuary
, 2009, 
the rat
e of ination o
f the bitco
in cur
rency was initially staggering. 
H
owever
, the growth of dema
nd for the currency given its v
er
y lim
-
ited ini
ti
al supp
ly accoun
ted for its high ra
te of inatio
n. In con
trast, 
establish
ed national currencies such a
s V
enezuela
’
s Bolivar
, Argen
-
tina
’
s peso, o
r Z
imbab
we
’
s dollar began with sucien
t and rela
tively
 
stable su
pplies. H
owever
, the rate o
f printing o
f thes
e currencies was 
then increased as a method for the co
untr
y’
s go
vernment to fund i
ts 
decit spending.
 
ere a
re three ways in which a g
overnmen
t can fund decit spend
-
ing
: c
urrency ination (p
rinting new currency), b
orro
wing from the 

THE BOOK O
F SA
TOSHI
46
pub
lic, and taxation. Go
vernments tend t
o favor curren
c
y by at (i
.e., 
crea
ting new c
urrency), which allows it to b
lame the inevitable price 
increases on s
p
ecu
lato
rs rather than o
n its true cu
lp
r
it, currency ina
-
tion. is was the excuse used by V
enezuela
’
s go
vernment in 2013 and 
again in 2014. W
ere go
vernments f
orced to use gold
, silver
, or bi
tcoins 
to fund their decit spendin
g, t
hey would ha
ve to fund it with tax 
increases, a reco
urse not popular wi
t
h the public, o
r with borrowin
g 
in the credit ma
rkets. is lat
ter action leads to higher inter
est rat
es as 
demand f
or money to borr
ow increases, and
, should gov
ernments not 
address their deci
t spending with cuts in spending, they are f
orced to 
raise ra
tes of taxation. 
Re: Bit
coi
n P2P e-ca
sh p
aper 
Satoshi Nakamoto Sat, 08 Nov 2008 13:38:26 -0800 
Ray Dillinger:
the “currency” is inﬂationar
y at about 35% as that’
s how 
much faster computers get annually 
. 
. 
. 
the inﬂation rate of 
35% is almost guaranteed by the technology
Increasing hardware speed is handled: “To compensate for 
increasing hardware speed and varying interest in running nodes 
over time, the proof-of-work difﬁculty is determined by a moving 
average targeting an average number of blocks per hour. If they’re 
generated too fast, the difﬁculty increases.”
As computers get faster and the total computing power applied to 
creating bitcoins increases, the difﬁculty increases proportionally 
to keep the total new production constant. Thus, it is known in 
advance how many new bitcoins will be created every year in the 
future.
The fact that new coins are produced means the money supply 

Sa
tosh
i on the In
itial Infla
tio
n Ra
te of 35%
47
increases by a planned amount, but this does not necessarily result 
in inﬂation. If the supply of money increases at the same rate that 
the number of people using it increases, prices remain stable. If it 
does not increase as fast as demand, there will be deﬂation and 
early holders of money will see its value increase.
Coins have to get initially distributed somehow, and a constant 
rate seems like the best formula.
Satoshi Nakamoto
The Cr
yptography Mailing List

49
8
About T
r
ansacti
o
ns
S
EVERAL Q
UESTIONS
 a
nd answers w
ere cov
ered in this post. 
H
a
l Finney
, the rst recip
ient of a b
itcoin 
t
ransaction, posed the 
questio
ns.
In the rs
t par
t, Sat
oshi explains ho
w miners retain tran
s
actions 
until they form them in
to a block.
In the second
, he explains ho
w double spending cann
ot occ
ur on a 
specic block chain a
nd how only o
ne block chain will pr
evail g
iven 
that two min
ers solve their blocks sim
u
ltaneo
usly
. I
t a
lso cover
s how 
transactions need to be held f
or an hour b
y receivers un
til the
y ar
e 
formally co
nrmed in t
he block chain. Sa
toshi ref
ers to six blocks (10 
minu
tes per block times six blocks gives an ho
ur) as an ap
pro
priate 
amo
unt of time f
or a transaction to be conrmed and f
orever made a 
part of the block cha
in.
T
o t
he third ques
t
ion, he describes what an a
ttacker w
ould have t
o 
do to “
rewrite hist
or
y”
, i.e., reco
nstruc
t and cha
nge the block chain
. T
o 

THE BOOK O
F SA
TOSHI
50
add or r
emove tran
s
actions in prio
r p
ast blocks wo
uld require r
ew
rit
-
ing them faster tha
n al
l miners on the n
et
wor
k sti
ll working o
n the 
existing block ch
ain. Remember from the discussion o
f orphan blocks
 
that the lo
ngest block cha
in is what the netwo
rk uses. Satoshi sa
ys: 
e
 
CPU power p
roo
f-of-work vo
te mus
t have t
he nal sa
y
. e on
ly wa
y for 
everyone to st
ay o
n the same p
age is to be
lieve tha
t the lo
ngest c
hai
n i
s 
al
ways th
e valid o
ne, no ma
tter wha
t.
e fo
ur
th question co
ncerns transaction verication o
f a paymen
t 
transfer b
y a recip
ient.
e h question co
ncerns the role o
f nodes (i.e., miners) in the 
system. W
hen one miner discov
ers the proof-o
f-work (the has
h with 
the ap
pro
priate n
umber of leading 0s), it will br
oadc
ast the block it j
ust 
“
mined”
, which con
t
ains several transactions. Each miner o
n the net
-
wor
k t
hat r
eceives this block has to valida
te it by c
hecking the validity 
of each tran
s
action the block con
tains.
Finally
, Satoshi r
eports t
hat h
e wrote the code prior t
o w
riting the 
white pa
p
er announ
cing Bitco
in in order to p
rov
e to himself that all 
issues wer
e resolved.
Re: Bit
coi
n P2P e-ca
sh p
aper 
Satoshi Nakamoto Sun, 09 Nov 2008 11:13:34 -0800 
Hal Finney wrote:
it is mentioned that if a broadcast transaction does not reach 
all nodes, it is OK, as it will get into the block chain before 
long. How does this happen - what if the node that creates 
the “next” block (the ﬁrst node to ﬁnd the hashcash collision) 
did not hear about the transaction, and then a few more 
blocks get added also by nodes that did not hear about 
that transaction? Do all the nodes that did hear it keep that 
transaction around, hoping to incorporate it into a block 

About Transacti
ons
51
once they get lucky enough to be the one which ﬁnds the next 
collision?
Right, nodes keep transactions in their working set until they get 
into a block. If a transaction reaches 90% of nodes, then each time 
a new block is found, it has a 90% chance of being in it.
Or for example, what if a node is keeping two or more chains 
around as it waits to see which grows fastest, and a block 
comes in for chain A which would include a double-spend 
of a coin that is in chain B? Is that checked for or not? (This 
might happen if someone double-spent and two different sets 
of nodes heard about the two different transactions with the 
same coin.)
That does not need to be checked for. The transaction in whichever 
branch ends up getting ahead becomes the valid one, the other is 
invalid. If someone tries to double spend like that, one and only 
one spend will always become valid, the others invalid.
Receivers of transactions will normally need to hold transactions for 
perhaps an hour or more to allow time for this kind of possibility to 
be resolved. 
They can still re-spend the coins immediately, but they should wait 
before taking an action such as shipping goods. 
I also don’t understand exactly how double-spending, or 
cancelling transactions, is accomplished by a superior 
attacker who is able to muster more computing power than all 
the honest participants. I see that he can create new blocks 
and add them to create the longest chain, but how can he 
erase or add old transactions in the chain? As the attacker 
sends out his new blocks, aren’t there consistency checks 
which honest nodes can perfor
m, to make sure that nothing 
got erased? More explanation of this attack would be helpful, 
in order to judge the gains to an attacker from this, versus 
simply using his computing power to mint new coins honestly
.

THE BOOK O
F SA
TOSHI
52
The attacker isn’t adding blocks to the end. He has to go back and 
redo the block his transaction is in and all the blocks after it, as 
well as any new blocks the network keeps adding to the end while 
he’s doing that. He’s rewriting history. Once his branch is longer, it 
becomes the new valid one.
This touches on a key point. Even though everyone present may 
see the shenanigans going on, there’s no way to take advantage 
of that fact. 
It is strictly necessary that the longest chain is always considered 
the valid one. Nodes that were present may remember that one 
branch was there ﬁrst and got replaced by another, but there 
would be no way for them to convince those who were not present 
of this. We can’t have subfactions of nodes that cling to one branch 
that they think was ﬁrst, others that saw another branch ﬁrst, and 
others that joined later and never saw what happened. The CPU 
power proof-of-work vote must have the ﬁnal say. The only way for 
everyone to stay on the same page is to believe that the longest 
chain is always the valid one, no matter what.
As far as the spending transactions, what checks does the 
recipient of a coin have to perfor
m? Does she need to go 
back through the coin’
s entire histor
y of transfers, and make 
sure that ever
y transaction on the list is indeed linked into the 
“timestamp” block chain? Or can she just do the latest one? 
The recipient just needs to verify it back to a depth that is 
sufﬁciently far back in the block chain, which will often only require 
a depth of 2 transactions. All transactions before that can be 
discarded.
Do the timestamp nodes check transactions, making sure that 
the previous transaction on a coin is in the chain, thereby 
enforcing the rule that all transactions in the chain represent 
valid coins?
Right, exactly. When a node receives a block, it checks the 

About Transacti
ons
53
signatures of every transaction in it against previous transactions in 
blocks. Blocks can only contain transactions that depend on valid 
transactions in previous blocks or the same block. Transaction C 
could depend on transaction B in the same block and B depends 
on transaction A in an earlier block.
Sorr
y about all the questions, but as I said this does seem 
to be a ver
y promising and original idea, and I am looking 
for
ward to seeing how the concept is fur
ther developed. It 
would be helpful to see a more process oriented description 
of the idea, with concrete details of the data structures for the 
various objects (coins, blocks, transactions), the data which 
is included in messages, and algorithmic descriptions of the 
procedures for handling the various events which would occur 
in this system. Y
ou mentioned that you are working on an 
implementation, but I think a more formal, text description of 
the system would be a helpful next step.
I appreciate your questions. I actually did this kind of backwards. I 
had to write all the code before I could convince myself that I could 
solve every problem, then I wrote the paper. I think I will be able to 
release the code sooner than I could write a detailed spec. Y
ou’re 
already right about most of your assumptions where you ﬁlled in 
the blanks.
Satoshi Nakamoto
The Cr
yptography Mailing List

55
9
O
n th
e O
rphan 
B
l
ock
s
A
N “
ORPHAN BLOCK”
 occ
urs when two miners sa
tisf
y 
the pr
o
of-of-w
ork at a
ppr
oxima
tely the same time. e tw
o 
blocks crea
ted by the two miners a
re dier
ent since they may 
not co
ntain all of the same B
itcoin tran
s
actions, in which case the 
transactions wher
ein t
he two “winning
” miners transf
er the block
’
s 
transaction fees to their acco
unts ar
e a
lso dieren
t. But o
nly one of 
those two blocks will ultimatel
y b
e added to the block chain, while the 
other will become an “
orpha
n block
”
. Any tra
nsac
tions p
resent in the 
orphan b
lo
ck bu
t not incl
ude
d in the accepted block will be included 
in the next block fo
r which miners are co
mpeting. Fo
r more details, 
see the explanatio
n of orphan b
lo
cks in Chap
ter 2.

THE BOOK O
F SA
TOSHI
56
Re: Bit
coi
n P2P e-ca
sh p
aper 
Satoshi Nakamoto Sun, 09 Nov 2008 11:17:24 -0800 
James A. Donald wrote:
OK, suppose one node incorporates a bunch of transactions 
in its proof of work, all of them honest legitimate single 
spends and another node incorporates a different bunch of 
transactions in its proof of work, all of them equally honest 
legitimate single spends, and both proofs are generated at 
about the same time.
What happens then?
They both broadcast their blocks. All nodes receive them and keep 
both, but only work on the one they received ﬁrst. We’ll suppose 
exactly half received one ﬁrst, half the other. 
In a short time, all the transactions will ﬁnish propagating so that 
everyone has the full set. The nodes working on each side will 
be trying to add the transactions that are missing from their side. 
When the next proof-of-work is found, whichever previous block 
that node was working on, that branch becomes longer and the tie 
is broken. Whichever side it is, the new block will contain the other 
half of the transactions, so in either case, the branch will contain 
all transactions. Even in the unlikely event that a split happened 
twice in a row, both sides of the second split would contain the full 
set of transactions anyway.
It’s not a problem if transactions have to wait one or a few extra 
cycles to get into a block. 
Satoshi Nakamoto
The Cr
yptography Mailing List

57
10
About 
Syn
ch
r
o
n
iza
tio
n  
o
f T
ransacti
o
ns
I
N THIS POST
,
 Sa
toshi explains wha
t hap
p
ens when a miner 
receiv
es two conicting transactions. e rs
t t
ransaction r
e
ceived 
is the one tha
t the miner incorpora
tes in the next proof-o
f-work. I
f 
mor
e informa
t
ion is needed, see the explana
tion in Chap
ter 2. 
Re: Bit
coi
n P2P e-ca
sh p
aper 
Satoshi Nakamoto Sun, 09 Nov 2008 11:14:17 -0800 
James A. Donald wrote:

THE BOOK O
F SA
TOSHI
58
The core concept is that lots of entities keep complete and 
consistent information as to who owns which bitcoins.
But maintaining consistency is tricky
. It is not clear to me 
what happens when someone reports one transaction to one 
maintainer
, and someone else transpor
ts another transaction 
to another maintainer
. The transaction cannot be known to 
be valid until it has been incorporated into a globally shared 
view of all past transactions, and no one can know that 
a globally shared view of all past transactions is globally 
shared until after some time has passed, and after many new 
transactions have arrived.
Did you explain how to do this, and it just passed over my 
head, or were you conﬁdent it could be done, and a bit 
vague as to the details?
The proof-of-work chain is the solution to the synchronisation 
problem, and to knowing what the globally shared view is without 
having to trust anyone.
A transaction will quickly propagate throughout the network, so 
if two versions of the same transaction were reported at close 
to the same time, the one with the head start would have a big 
advantage in reaching many more nodes ﬁrst. Nodes will only 
accept the ﬁrst one they see, refusing the second one to arrive, so 
the earlier transaction would have many more nodes working on 
incorporating it into the next proof-of-work. In effect, each node 
votes for its viewpoint of which transaction it saw ﬁrst by including 
it in its proof-of-work effort.
If the transactions did come at exactly the same time and there was 
an even split, it’s a toss up based on which gets into a proof-of-
work ﬁrst, and that decides which is valid.
When a node ﬁnds a proof-of-work, the new block is propagated 
throughout the network and everyone adds it to the chain and 
starts working on the next block after it. Any nodes that had the 

About Synch
r
on
iza
tio
n of Transacti
ons 
59
other transaction will stop trying to include it in a block, since it’s 
now invalid according to the accepted chain.
The proof-of-work chain is itself self-evident proof that it came 
from the globally shared view. Only the majority of the network 
together has enough CPU power to generate such a difﬁcult chain 
of proof-of-work. Any user, upon receiving the proof-of-work 
chain, can see what the majority of the network has approved. 
Once a transaction is hashed into a link that’s a few links back in 
the chain, it is ﬁrmly etched into the global history.
Satoshi Nakamoto
The Cr
yptography Mailing List

61
11
Sa
t
os
h
i Discuss
es 
T
r
ansacti
o
n Fees
T
HIS POST D
ISCUSSES USE
 of transaction fees as op
p
osed to 
se
igniorage
 as a mean of paying min
ers for their wo
rk of main
-
taining the Bi
tcoin netwo
rk. 
S
eig
niorage
 is an economic t
erm 
used to describ
e the crea
t
ion o
f additional units o
f a c
urrency
. When 
all bitco
ins hav
e b
een mined and the maxim
um of 21 million BTC ha
s 
been created, in
centives fo
r miners to wo
rk to main
tain Bitco
in wi
ll 
come o
nly from transaction fees collected in the course o
f maintain
-
ing Bi
tcoin. H
owever
, prior to this, the year
ly rate o
f bitco
in ination 
will b
e so low in the end tha
t it will eect
ivel
y b
e the same as aer all 
bi
tcoins ha
ve been mined. 

THE BOOK O
F SA
TOSHI
62
Re: Bit
coi
n P2P e-ca
sh p
aper 
Satoshi Nakamoto Mon, 10 Nov 2008 11:09:26 -0800 
James A. Donald wrote:
Further
more, it cannot be made to work, as in the proposed 
system the work of tracking who owns what coins is paid for 
by seigniorage, which requires inﬂation.
If you’re having trouble with the inﬂation issue, it’s easy to tweak 
it for transaction fees instead. It’s as simple as this: let the output 
value from any transaction be 1 cent less than the input value. 
Either the client software automatically writes transactions for 1 
cent more than the intended payment value, or it could come out 
of the payee’s side. The incentive value when a node ﬁnds a proof-
of-work for a block could be the total of the fees in the block.
Satoshi Nakamoto
The Cr
yptography Mailing List

63
12
O
n Co
n
fi
rm
a
tio
n 
an
d Bl
ock T
ime
I
N THE FIRST
 ANSWER BELOW
,
 Satoshi addr
esses 
double spend
 
and 
conr
mation
.
In the second a
nswer
, he covers ho
w the dicu
lty on the p
roof-
of-wo
rk is adju
sted bas
ed on the eective time between each block so 
that the netw
ork at
temp
ts to maintain 10 min
utes per block. Cha
pter 
2’
s dis
cussion o
n proof-of-w
ork com
pared it t
o a lottery
. A maximum 
num
ber
, in hexadecimal or base 16, is selected, and the miners
’ proof-
of-wo
rk consis
ts of genera
t
ing a n
umber that is less than this n
umber
. 
e n
umber is generat
e
d through the Bi
tcoin system a
nd is random. 
e rst miner t
o obtain a hash o
utpu
t less than the maximum “
wins
” 
the right to p
rocess that block an
d b
e awa
rded its transaction fees a
nd 
the 25 BTC a
warded per block. e value c
hos
en for the maxim
um 
determines the level of diculty o
f the proof-o
f-work; the larg
er the 

THE BOOK O
F SA
TOSHI
64
value, the mo
re likely a has
h outp
ut genera
ted by the miner’
s system is 
to fall below the maxim
um, and the smaller the number
, the less likely 
the miner’
s num
b
er is to fall below the maxim
um. 
e last ques
t
ion addr
esse
d is in rega
rd to the speed of the transac-
tion no
t b
eing a fea
ture. H
e makes the poin
t t
hat boun
cing checks and 
credit ca
rd char
gebacks can take several days or even weeks t
o process, 
in con
trast to the 60 minu
tes or so for B
itcoin to valida
te with a high 
level of co
ndence a ful
ly irreversib
le bitco
in transaction.
Re: Bit
coi
n P2P e-ca
sh p
aper 
Satoshi Nakamoto Tue, 11 Nov 2008 06:30:22 -0800 
James A. Donald wrote:
So what happened to the coin that lost the race?
. 
. 
. 
it is a bit harsh if the guy who came second is likely to lose his 
coin.
When there are multiple double-spent versions of the same 
transaction, one and only one will become valid.
The receiver of a payment must wait an hour or so before believing 
that it’s valid. The network will resolve any possible double-spend 
races by then.
The guy who received the double-spend that became invalid never 
thought he had it in the ﬁrst place. His software would have shown 
the transaction go from “unconﬁrmed” to “invalid”. If necessary, 
the UI can be made to hide transactions until they’re sufﬁciently 
deep in the block chain.
Further
, your description of events implies restrictions on 
timing and coin generation - that the entire network generates 
coins slowly compared to the time required for news of a new 

O
n Confi
rma
tion an
d Block T
ime
65
coin to ﬂood the network
Sorry if I didn’t make that clear. The target time between blocks 
will probably be 10 minutes.
Every block includes its creation time. If the time is off by more 
than 36 hours, other nodes won’t work on it. If the timespan over 
the last 6*24*30 blocks is less than 15 days, blocks are being 
generated too fast and the proof-of-work difﬁculty doubles. 
Everyone does the same calculation with the same chain data, so 
they all get the same result at the same link in the chain.
W
e want spenders to have certainty that their transaction is 
valid at the time it takes a spend to ﬂood the network, not at 
the time it takes for branch races to be resolved.
Instantant non-repudiability is not a feature, but it’s still much 
faster than existing systems. Paper cheques can bounce up to a 
week or two later. Credit card transactions can be contested up 
to 60 to 180 days later. Bitcoin transactions can be sufﬁciently 
irreversible in an hour or two.
If one node is ignoring all spends that it does not care about, 
it suffers no adverse consequences.
With the transaction fee based incentive system I recently 
posted, nodes would have an incentive to include all the paying 
transactions they receive.
Satoshi Nakamoto
The Cr
yptography Mailing List

67
13
T
h
e B
yzanti
n
e 
Gen
er
al
’
s Pro
b
lem
I
N WH
A
T IS POSSIBL
Y
 the most int
eresting post made by Sa
toshi, 
he explain
s how the block cha
in s
olves a p
roblem in co
mpu
ter sci
-
ence known a
s t
he “B
yzantine fa
ult toleran
ce
”
, a mor
e generalized 
versio
n of the “
T
wo Generals
’ Problem
”
. In this pr
oblem, two (or m
ore) 
persons need to sha
re informa
tion in an unr
eliable comm
unication 
en
vironmen
t, w
here mes
sages sent can be lost or tam
pered with. e 
stat
ement of the p
roblem rs
t appeared in the 1970s in netwo
rk com
-
pu
t
ing lit
eratur
e, and a
t t
hat time the p
roblem was co
nsidered unsolv
-
able. I
n this post, Satoshi c
laims that Bi
tcoin solv
es it.
T
o i
llustra
te the prob
lem, imagine that two g
enerals are req
uired 
to a
ttack a city a
t t
he same time. I
f either one a
ttacks and the o
t
her 
does not, the fo
rces of the a
ttacking general will be annihilated by the 
city’
s defenses. Communica
tion between the generals is unreliab
le; 

THE BOOK O
F SA
TOSHI
68
the courier sending the message r
egardin
g w
hen to a
ttack must g
o 
through the ci
ty and so could be inter
cepted. e rst g
eneral can, by 9 
am, dispa
tch the messenger wi
t
h the message co
mmunicatin
g t
hat the 
at
tack wil
l commence o
n that same da
y
. Ho
wever
, once dispat
ched, 
the rst general will ha
ve no idea as to whether or not the m
ess
enger 
got thr
ough. is uncertainty ma
y le
ad the rst general t
o hesitate t
o 
at
tack since he might be a
ttacking alone if the second gen
era
l never 
receiv
e
d his message
.
Kno
wing all t
his, the second general ma
y send a conrmation back 
to the rst to in
dicate tha
t he received the message t
o attack. Bu
t that 
message
, to
o
, could be inter
cepted, leading the second general to hesi
-
tate a
s well. e rst gen
era
l could be sending a conrma
tion of the 
conrma
tion, but tha
t too could hav
e b
een inter
cepted. H
ence, again, 
the rst gen
era
l could hesi
t
at
e un
less he gets back a co
nrmation o
f 
this conrma
tion of the rst co
nr
matio
n. is process could be car
-
ried out ad inni
tum with no way f
or either general to kno
w whether 
messages w
ere dispat
ched or whether they were bu
t were in
tercept
e
d 
by the enem
y
.
T
o le
arn mor
e, read the sect
ion “
Il
lustra
ting the pro
blem
” in the fol
-
lowing W
ikipedia art
icle:
ht
tp://en.wikipedia.org/wiki/T
wo_Generals%27_Pr
oblem
See a
lso this article on the Byzan
tine fault t
olerance:
ht
tp://en.wikipedia.org/wiki/Byzan
t
ine_fa
u
lt_to
lerance
Re: Bit
coi
n P2P e-ca
sh p
aper 
Satoshi Nakamoto Thu, 13 Nov 2008 19:34:25 -0800 
James A. Donald wrote:
It is not sufﬁcient that ever
yone knows X. W
e also need 

Th
e Byzanti
ne General
’s P
roblem
69
ever
yone to know that ever
yone knows X, and that ever
yone 
knows that ever
yone knows that ever
yone knows X - which, 
as in the Byzantine Generals problem, is the classic hard 
problem of distributed data processing.
The proof-of-work chain is a solution to the Byzantine Generals’ 
Problem. I’ll try to rephrase it in that context.
A number of Byzantine Generals each have a computer and want 
to attack the King’s wi-ﬁ by brute forcing the password, which 
they’ve learned is a certain number of characters in length. Once 
they stimulate the network to generate a packet, they must crack 
the password within a limited time to break in and erase the logs, 
otherwise they will be discovered and get in trouble. They only 
have enough CPU power to crack it fast enough if a majority of 
them attack at the same time.
They don’t particularly care when the attack will be, just that 
they all agree. It has been decided that anyone who feels like 
it will announce a time, and whatever time is heard ﬁrst will be 
the ofﬁcial attack time. The problem is that the network is not 
instantaneous, and if two generals announce different attack times 
at close to the same time, some may hear one ﬁrst and others hear 
the other ﬁrst.
They use a proof-of-work chain to solve the problem. Once each 
general receives whatever attack time he hears ﬁrst, he sets his 
computer to solve an extremely difﬁcult proof-of-work problem 
that includes the attack time in its hash. The proof-of-work is 
so difﬁcult, it’s expected to take 10 minutes of them all working 
at once before one of them ﬁnds a solution. Once one of the 
generals ﬁnds a proof-of-work, he broadcasts it to the network, 
and everyone changes their current proof-of-work computation 
to include that proof-of-work in the hash they’re working on. If 
anyone was working on a different attack time, they switch to this 
one, because its proof-of-work chain is now longer.

THE BOOK O
F SA
TOSHI
70
After two hours, one attack time should be hashed by a chain of 
12 
proofs-of-work. Every general, just by verifying the difﬁculty of the 
proof-of-work chain, can estimate how much parallel CPU power 
per hour was expended on it and see that it must have required 
the majority of the computers to produce that much proof-of-work 
in the allotted time. They had to all have seen it because the proof-
of-work is proof that they worked on it. If the CPU power exhibited 
by the proof-of-work chain is sufﬁcient to crack the password, they 
can safely attack at the agreed time.
The proof-of-work chain is how all the synchronisation, distributed 
database and global view problems you’ve asked about are solved.
The Cr
yptography Mailing List

71
14
O
n B
l
ock T
ime,  
an Aut
om
a
ted T
est
, 
an
d th
e Li
b
er
t
arian 
Vi
e
wpo
i
nt
I
N THIS POST
, 
Satoshi explains why a single pending transaction 
pool is required and how these transactions are kept given that 
parallel branches of blocks exist. He references a few functions 
within the code. Recall the discussion on proof-of-work in Chapter 2. 
Not all miners might have assembled the same transactions, some of 
which might have come too late to be included in the block on which 
they are working. 
As new transactions arrive while they are working 
on the hash for their existing block, they will store these transactions 
in a transaction pool.

THE BOOK O
F SA
TOSHI
72
en, he to
uches again o
n t
ransaction pr
opaga
t
ion an
d t
he 10 
minu
tes allo
cated per crea
tion of a block, discussing the is
sue as to 
whether that migh
t b
e too short a perio
d of time.
Lastly
, he makes a refer
ence to ho
w Bitcoin 
could b
e at
trac
tive to 
libertarians, people who advocat
e individual libert
ies. 
Re: Bit
coi
n P2P e-ca
sh p
aper 
Satoshi Nakamoto Fri, 14 Nov 2008 14:29:22 -0800 
Hal Finney wrote:
I think it is necessar
y that nodes keep a separate pending-
transaction list associated with each candidate chain. 
. 
. 
. 
One might also ask 
. 
. 
. 
how many candidate chains must a 
given node keep track of at one time, on average?
Fortunately, it’s only necessary to keep a pending-transaction 
pool for the current best branch. When a new block arrives for 
the best branch, ConnectBlock removes the block’s transactions 
from the pending-tx pool. If a different branch becomes longer, 
it calls DisconnectBlock on the main branch down to the fork, 
returning the block transactions to the pending-tx pool, and 
calls ConnectBlock on the new branch, sopping back up any 
transactions that were in both branches. It’s expected that reorgs 
like this would be rare and shallow.
With this optimisation, candidate branches are not really any 
burden. They just sit on the disk and don’t require attention unless 
they ever become the main chain.
Or as James raised earlier
, if the network broadcast is reliable 
but depends on a potentially slow ﬂooding algorithm, how 
does that impact perfor
mance?

O
n Block Time, an Aut
oma
ted Test
, and the Li
ber
tarian Vi
e
wpoint 
73
Broadcasts will probably be almost completely reliable. TCP 
transmissions are rarely ever dropped these days, and the 
broadcast protocol has a retry mechanism to get the data from 
other nodes after a while. If broadcasts turn out to be slower in 
practice than expected, the target time between blocks may have 
to be increased to avoid wasting resources. We want blocks to 
usually propagate in much less time than it takes to generate 
them, otherwise nodes would spend too much time working on 
obsolete blocks.
I’m planning to run an automated test with computers randomly 
sending payments to each other and randomly dropping packets.
3. The bitcoin system turns out to be socially useful and 
valuable, so that node operators feel that they are making 
a beneﬁcial contribution to the world by their efforts (similar 
to the various “@Home” compute projects where people 
volunteer their compute resources for good causes).
 In this case it seems to me that simple altruism can sufﬁce to keep 
the network running properly.
It’s very attractive to the libertarian viewpoint if we can explain it 
properly. I’m better with code than with words though.
Satoshi Nakamoto
The Cr
yptography Mailing List

75
15
Mo
re o
n Doub
le
 
Sp
en
d, P
r
oo
f-o
f-Wo
rk
, 
an
d T
r
ansacti
o
n Fees
I
N THIS EX
CH
ANGE, 
Sa
toshi pr
ovides several clarication
s and 
discusses compensa
tion of miners (i
.e., nodes) vi
a transaction fees 
once the en
tire sup
ply of b
itcoins h
as b
een creat
ed.
Re: Bit
coi
n P2P e-ca
sh p
aper 

THE BOOK O
F SA
TOSHI
76
Satoshi Nakamoto Mon, 17 Nov 2008 09:04:47 -0800 
I’ll try and hurry up and release the sourcecode as soon as possible 
to serve as a reference to help clear up all these implementation 
questions.
Ray Dillinger (Bear) wrote:
When a coin is spent, the buyer and seller digitally sign a 
(blinded) transaction record.
Only the buyer signs, and there’s no blinding. 
If someone double spends, then the transaction record can be 
unblinded revealing the identity of the cheater
. 
Identities are not used, and there’s no reliance on recourse. It’s all 
prevention.
This is done via a fairly standard cut-and-choose algorithm 
where the buyer responds to several challenges with secret 
shares
No challenges or secret shares. A basic transaction is just what you 
see in the ﬁgure in section 2. A signature (of the buyer) satisfying 
the public key of the previous transaction, and a new public key (of 
the seller) that must be satisﬁed to spend it the next time.
They may also receive chains as long as the one they’re 
tr
ying to extend while they work, in which the last few “links” 
are links that are *not* in common with the chain on which 
they’re working.
These they ignore. 
Right, if it’s equal in length, ties are broken by keeping the earliest 
one received.
If it contains a double spend, then they create a “transaction” 
which is a proof of double spending, add it to their pool A, 

More o
n Double Sp
end, Proof-o
f-Work, an
d Transactio
n Fees
77
broadcast it, and continue work.
There’s no need for reporting of “proof of double spending” like 
that. If the same chain contains both spends, then the block is 
invalid and rejected. 
Same if a block didn’t have enough proof-of-work. That block is 
invalid and rejected. There’s no need to circulate a report about it. 
Every node could see that and reject it before relaying it.
If there are two competing chains, each containing a different 
version of the same transaction, with one trying to give money 
to one person and the other trying to give the same money to 
someone else, resolving which of the spends is valid is what the 
whole proof-of-work chain is about.
We’re not “on the lookout” for double spends to sound the alarm 
and catch the cheater. We merely adjudicate which one of the 
spends is valid. Receivers of transactions must wait a few blocks 
to make sure that resolution has had time to complete. Would be 
cheaters can try and simultaneously double-spend all they want, 
and all they accomplish is that within a few blocks, one of the 
spends becomes valid and the others become invalid. Any later 
double-spends are immediately rejected once there’s already a 
spend in the main chain. 
Even if an earlier spend wasn’t in the chain yet, if it was already in 
all the nodes’ pools, then the second spend would be turned away 
by all those nodes that already have the ﬁrst spend.
If the new chain is accepted, then they give up on adding 
their current link, dump all the transactions from pool L back 
into pool A (along with transactions they’ve received or 
created since starting work), eliminate from pool A those 
transaction records which are already part of a link in the 
new chain, and start work again tr
ying to extend the new 
chain.
Right. They also refresh whenever a new transaction comes in, so L 

THE BOOK O
F SA
TOSHI
78
pretty much contains everything in A all the time.
CPU-intensive digital signature algorithm to sign the chain 
including the new block L. 
It’s a Hashcash style SHA-256 proof-of-work (partial pre-image of 
zero), not a signature. 
Is there a mechanism to make sure that the “chain” does not 
consist solely of links added by just the 3 or 4 fastest nodes? 
‘Cause a broadcast transaction record could easily miss those 
3 or 4 nodes and if it does, and those nodes continue to 
dominate the chain, the transaction might never get added.
If you’re thinking of it as a CPU-intensive digital signing, then you 
may be thinking of a race to ﬁnish a long operation ﬁrst and the 
fastest always winning.
The proof-of-work is a Hashcash style SHA-256 collision ﬁnding. 
It’s a memoryless process where you do millions of hashes a 
second, with a small chance of ﬁnding one each time. The 3 or 4 
fastest nodes’ dominance would only be proportional to their share 
of the total CPU power. Anyone’s chance of ﬁnding a solution at 
any time is proportional to their CPU power.
There will be transaction fees, so nodes will have an incentive 
to receive and include all the transactions they can. Nodes will 
eventually be compensated by transaction fees alone when the 
total coins created hits the pre-determined ceiling.
Also, the work requirement for adding a link to the chain 
should var
y (again exponentially) with the number of links 
added to that chain in the previous week, causing the rate 
of coin generation (and therefore inﬂation) to be strictly 
controlled.
Right.
Y
ou need coin aggregation for this to scale. There needs to 

More o
n Double Sp
end, Proof-o
f-Work, an
d Transactio
n Fees
79
be a “provable” transaction where someone retires ten single 
coins and creates a new coin with denomination ten, etc. 
Every transaction is one of these. Section 9, Combining and 
Splitting Value. 
Satoshi Nakamoto
The Cr
yptography Mailing List

81
16
O
n Elli
pti
c Cur
ve 
Cr
ypt
ogr
ap
hy
, D
en
ial 
o
f Ser
vice A
t
t
acks, 
an
d Co
n
fi
rm
a
ti
o
n 
S
A
TOSHI COVERS
 tra
nsact
ion signa
tures, adds a bi
t more o
n 
denial of ser
vice attacks, a
nd, nally
, revisits transaction speed. 
A merc
hant co
u
ld wait f
or 2 minu
tes aer the con
sumer has 
made the transaction with his sma
r
tpho
ne. en the merc
hant (o
r t
he 
Bit
coin paymen
t ser
vice com
pany the mer
chan
t has chosen) would 
wat
ch for do
uble spend transactions on the B
itcoin netwo
rk. Imagine 
that a co
nsumer makes a tran
s
action which we will cal
l “X
” in which 
he or sh
e p
ays 1.5 B
TC from a Bi
tcoin addres
s AB
C t
ha
t holds 2 BTC. 
e con
sumer’
s ba
lance then falls to 0.5 BTC o
nce the paymen
t has 

THE BOOK O
F SA
TOSHI
82
been fu
lly conrmed.  Discussed here ar
e the act
ions the mer
chan
t has 
to perform in or
der to moni
tor the networ
k to se
e if an
y other transac
-
tions in
volvin
g bitco
in address ABC appear and
, if s
o
, if t
he amo
unt 
in
volved exceeds 0.5 BT
C. If transactions meeting this crit
er
ion ar
e 
detected within say
, 2 minu
tes, the paymen
t is considered no
t valid. 
W
aiting fo
r 2 minut
es g
ives p
lenty of lead fo
r t
ransaction “
X” to clea
r 
prior t
o any co
mpeting transactions co
ming later fro
m Bitco
in address 
ABC. is indicates to the mer
chan
t t
ha
t t
ransaction “
X” is very likely 
to be included in the curren
t block of the ma
jority of Bi
tcoin miners 
on which they ar
e working an
d hence assures i
ts e
ven
tual inclusio
n in 
the block chain.
Re: Bit
coi
n P2P e-ca
sh p
aper 
Satoshi Nakamoto Mon, 17 Nov 2008 09:06:02 -0800 
Ray Dillinger wrote:
One way to do this would be to have the person recieving the 
coin generate an asymmetric key pair
, and then have half of 
it published with the transaction. In order to spend the coin 
later
, s/he must demonstrate posession of the other half of 
the asymmetric key pair
, probably by using it to sign the key 
provided by the new seller
.
Right, it’s ECC digital signatures. A new key pair is used for every 
transaction.
It’s not pseudonymous in the sense of nyms identifying people, but 
it is at least a little pseudonymous in that the next action on a coin 
can be identiﬁed as being from the owner of that coin.
Mmmm. I don’t know if I’m comfortable with that. Y
ou’re 
saying there’
s no effort to identify and exclude nodes that 

O
n Elliptic Curve Cr
yptography
, Denial o
f Service A
ttacks, an
d Con
firma
tion 
83
don’t cooperate? I suspect this will lead to trouble and 
possible DOS attacks.
There is no reliance on identifying anyone. As you’ve said, it’s futile 
and can be trivially defeated with sock puppets.
The credential that establishes someone as real is the ability to 
supply CPU power. 
Until 
. 
. 
. 
until what? How does anybody know when a 
transaction has become irrevocable? Is “a few” blocks three? 
Thirty? A hundred? Does it depend on the number of nodes? 
Is it logarithmic or linear in number of nodes?
Section 11 calculates the worst case under attack. Typically, 5 
or 10 blocks is enough for that. If you’re selling something that 
doesn’t merit a network-scale attack to steal it, in practice you 
could cut it closer.
But in the absence of identity
, there’
s no downside to them 
if spends become invalid, if they’ve already received the 
goods they double-spent for (access to website, download, 
whatever). The merchants are left holding the bag with 
“invalid” coins, unless they wait that magical “few blocks” 
(and how can they know how many?) before treating the 
spender as having paid.
The consumers won’t do this if they spend their coin and it 
takes an hour to clear before they can do what they spent 
their coin on. The merchants won’t do it if there’
s no way to 
charge back a customer when they ﬁnd the that their coin is 
invalid because the customer has doublespent.
This is a version 2 problem that I believe can be solved fairly 
satisfactorily for most applications.
The race is to spread your transaction on the network ﬁrst. Think 
6 degrees of freedom -- it spreads exponentially. It would only 
take something like 2 minutes for a transaction to spread widely 

THE BOOK O
F SA
TOSHI
84
enough that a competitor starting late would have little chance of 
grabbing very many nodes before the ﬁrst one is overtaking the 
whole network.
During those 2 minutes, the merchant’s nodes can be watching 
for a double-spent transaction. The double-spender would not be 
able to blast his alternate transaction out to the world without the 
merchant getting it, so he has to wait before starting.
If the real transaction reaches 90% and the double-spent tx 
reaches 10%, the double-spender only gets a 10% chance of not 
paying, and 90% chance his money gets spent. For almost any type 
of goods, that’s not going to be worth it for the scammer.
Information based goods like access to website or downloads 
are non-fencible. Nobody is going to be able to make a living off 
stealing access to websites or downloads. They can go to the ﬁle 
sharing networks to steal that. Most instant-access products aren’t 
going to have a huge incentive to steal. 
If a merchant actually has a problem with theft, they can make 
the customer wait 2 minutes, or wait for something in e-mail, 
which many already do. If they really want to optimize, and it’s a 
large download, they could cancel the download in the middle if 
the transaction comes back double-spent. If it’s website access, 
typically it wouldn’t be a big deal to let the customer have access 
for 5 minutes and then cut off access if it’s rejected. Many such 
sites have a free trial anyway.
Satoshi Nakamoto
The Cr
yptography Mailing List

85
17
Mo
re o
n th
e 
T
r
ansacti
o
n 
Poo
l, Netwo
rki
ng 
B
r
o
adca
st
, an
d 
C
o
di
ng D
et
ai
ls
I
N THE FIRST
 SECTION
 BELOW
, 
Sa
toshi expands on the tran
s
-
action pool. He then describes his experiment o
n t
he networ
k
-
ing br
oadcast mechanism wher
e no
des request i
tems from their 
neighbors. Lastly
, Sat
oshi mention
s t
hat h
e has be
en workin
g on the 
code for the last 18 mo
nths.

THE BOOK O
F SA
TOSHI
86
Re: Bit
coi
n P2P e-ca
sh p
aper 
Satoshi Nakamoto Mon, 17 Nov 2008 13:33:04 -0800 
James A. Donald wrote:
Satoshi wrote: 
Fortunately, it’s only necessary to keep a pending-
transaction pool for the current best branch.
 This requires that we know
, that is to say an honest well 
behaved peer whose communications and data storage is 
working well knows, what the current best branch is -
I mean a node only needs the pending-tx pool for the best branch 
it has. The branch that it currently thinks is the best branch. That’s 
the branch it’ll be trying to make a block out of, which is all it 
needs the pool for.
Broadcasts will probably be almost completely reliable.
Rather than assuming that each message arrives at least once, 
we have to make a mechanism such that the information 
arrives even though conveyed by messages that frequently fail 
to arrive.
I think I’ve got the peer networking broadcast mechanism covered. 
Each node sends its neighbours an inventory list of hashes of the 
new blocks and transactions it has. The neighbours request the 
items they don’t have yet. If the item never comes through after a 
timeout, they request it from another neighbour that had it. Since 
all or most of the neighbours should eventually have each item, 
even if the coms get fumbled up with one, they can get it from any 
of the others, trying one at a time.
The inventory-request-data scheme introduces a little latency, but 
it ultimately helps speed more by keeping extra data blocks off the 
transmit queues and conserving bandwidth.

More o
n the T
r
 
ansacti
on Pool, Netwo
rking B
r
 
o
adca
 
st
, and Co
din
g Detai
ls
87
Y
ou have an outline and proposal for such a design, which is 
a big step for
ward, but the devil is in the little details.
I believe I’ve worked through all those little details over the last 
year and a half while coding it, and there were a lot of them. The 
functional details are not covered in the paper, but the sourcecode 
is coming soon. I sent you the main ﬁles. (available by request at 
the moment, full release soon)
Satoshi Nakamoto
The Cr
yptography Mailing List
 

89
18
Fi
rst Releas
e  
of
 B
i
tc
oi
n
I
N THIS POST
,
 Sa
toshi announ
ces t
he very rst release of the 
Bit
coin soware o
n 
sourceforge.net
. 
S
ourceforge.net
 is like github 
or o
t
her online ser
vices allowing people to sh
are documents an
d 
source code. is r
elease is no longer a
vailable there b
ut has been 
recop
ied at the follo
wing locations:
ht
tp://ww
w
.zorinaq.com/p
ub/bitco
in-0.1.0.rar
ht
tp://ww
w
.zorinaq.com/p
ub/bitco
in-0.1.0.tgz
ht
tp://we.lo
vebi
tco.in/b
itcoin-0.1.0.ra
r
ht
tp://ww
w
.bitco
intrading.com/les/b
itcoin-0.1.0.rar
is sowar
e is open source, meanin
g that the code is availab
le, 
cop
yr
ight free fo
r use, repr
o
duction, an
d mo
dicatio
n. 

THE BOOK O
F SA
TOSHI
90
Bit
coi
n v0.1 relea
sed 
Satoshi Nakamoto Fri, 09 Jan 2009 17:05:49 -0800 
Announcing the ﬁrst release of Bitcoin, a new electronic cash 
system that uses a peer-to-peer network to prevent double-
spending. It’s completely decentralized with no server or central 
authority.
See bitcoin.org for screenshots.
Download link:
http://downloads.sourceforge.net/bitcoin/bitcoin-0.1.0.rar
Windows only for now. Open source C++ code is included.
• 
 
Unpack the ﬁles into a directory
• 
 
Run BITCOIN.EXE
• 
 
It automatically connects to other nodes
If you can keep a node running that accepts incoming connections, 
you’ll really be helping the network a lot. Port 8333 on your 
ﬁrewall needs to be open to receive incoming connections.
The software is still alpha and experimental. There’s no guarantee 
the system’s state won’t have to be restarted at some point if it 
becomes necessary, although I’ve done everything I can to build in 
extensibility and versioning.
Y
ou can get coins by getting someone to send 
you some, or turn on
Options->Generate Coins to run a node and generate blocks. I 
made the proof-of-work difﬁculty ridiculously easy to start with, 
so for a little while in the beginning a typical PC will be able to 
generate coins in just a few hours. It’ll get a lot harder when 
competition makes the automatic adjustment drive up the difﬁculty. 
Generated coins must wait 120 blocks to mature before they can 
be spent.

First Releas
e of Bit
coi
n 
91
There are two ways to send money. If the recipient is online, you 
can enter their IP address and it will connect, get a new public 
key and send the transaction with comments. If the recipient is 
not online, it is possible to send to their Bitcoin address, which is 
a hash of their public key that they give you. They’ll receive the 
transaction the next time they connect and get the block it’s in. 
This method has the disadvantage that no comment information is 
sent, and a bit of privacy may be lost if the address is used multiple 
times, but it is a useful alternative if both users can’t be online at 
the same time or the recipient can’t receive incoming connections.
Total circulation will be 21,000,000 coins. It’ll be distributed to 
network nodes when they make blocks, with the amount cut in half 
every 4 years.
ﬁrst 4 years: 10,500,000 coins
next 4 years: 5,250,000 coins
next 4 years: 2,625,000 coins
next 4 years: 1,312,500 coins
etc. 
. 
. 
.
When that runs out, the system can support transaction fees if 
needed. It’s based on open market competition, and there will 
probably always be nodes willing to process transactions for free.
Satoshi Nakamoto

93
19
O
n th
e Purpos
e 
Fo
r Wh
i
ch B
it
co
i
n 
C
ould Be Us
ed Fi
rst
F
RO
M THIS READING, 
w
e can extrapolat
e t
hat Sa
toshi N
aka
-
moto did n
ot expec
t Bitco
in to achieve such h
uge success so ra
p
-
idly
. He sta
tes that the rs
t us
e might be fo
r micropaymen
ts or 
a porn site. I
nter
estingly
, those were not the rs
t ac
tual uses. Satos
hi 
also makes the suggestion tha
t famous people co
uld use it so t
hat fa
ns 
could send them personal messages.
H
e als
o obser
ves, “I
t mig
ht mak
e s
ense just to g
et some in case it 
cat
ches on.
” I’
m assuming he fo
llowed his own ad
v
ice. A bi
tcoin was 
worth ov
er $600 in early 2014 com
pared to pennies in its rs
t year of 
existence
.

THE BOOK O
F SA
TOSHI
94
Re: Bit
coi
n v0.1 relea
sed 
Satoshi Nakamoto Sat, 17 Jan 2009 06:58:44 -0800 
Dustin D. T
rammell wrote:
Satoshi Nakamoto wrote:
Y
ou know, I think there were a lot more people interested 
in the 90’s, but after more than a decade of failed Trusted 
Third Party based systems (Digicash, etc), they see it as a 
lost cause. I hope they can make the distinction that this is 
the ﬁrst time I know of that we’re trying a non-trust-based 
system.
Y
ea, that was the primar
y feature that caught my eye. The real 
trick will be to get people to actually value the BitCoins so that 
they become currency
.
 I would be surprised if 10 years from now we’re not using 
electronic currency in some way, now that we know a way to do 
it that won’t inevitably get dumbed down when the trusted third 
party gets cold feet.
It could get started in a narrow niche like reward points, donation 
tokens, currency for a game or micropayments for adult sites. 
Initially it can be used in proof-of-work applications for services 
that could almost be free but not quite.
It can already be used for pay-to-send e-mail. The send dialog is 
resizeable and you can enter as long of a message as you like. It’s 
sent directly when it connects. The recipient doubleclicks on the 
transaction to see the full message. If someone famous is getting 
more e-mail than they can read, but would still like to have a way 
for fans to contact them, they could set up Bitcoin and give out the 
IP address on their website. “Send X bitcoins to my priority hotline 
at this IP and I’ll read the message personally.”
Subscription sites that need some extra proof-of-work for their free 

O
n the Purpose Fo
r Which Bit
coi
n Could Be Us
ed First
95
trial so it doesn’t cannibalize subscriptions could charge bitcoins for 
the trial.
It might make sense just to get some in case it catches on. 
If enough people think the same way, that becomes a self 
fulﬁlling prophecy. Once it gets bootstrapped, there are so many 
applications if you could effortlessly pay a few cents to a website as 
easily as dropping coins in a vending machine. 
Satoshi Nakamoto
http://www.bitcoin.org
is sub
j
ect was revisited on the B
itcoin
T
a
lk forum lat
er
:
Re: Porn 
Posted by satoshi, September 23, 2010, 05:56:55 PM
Bitcoin would be convenient for people who don’t have a credit 
card or don’t want to use the cards they have, either don’t want 
the spouse to see it on the bill or don’t trust giving their number to 
“porn guys”, or afraid of recurring billing.

97
20
“P
r
oo
f-o
f-Wo
rk” 
T
o
kens an
d Sp
a
mmers
H
ERE IS AN INTERES
TING CONVERSA
TION
 between Hal 
Finney
, a well-known develo
p
er in the cr
yptograp
hy ind
ustr
y
,
 
and Sa
toshi N
akamoto tha
t foc
uses on ho
w Bitco
in
’
s proof-o
f-
wor
k could be us
ed to limit spamm
ers or to rewar
d spam recip
ients. H
al
 
Finney is credit
ed w
ith crea
ting the rst “
reusable p
roof-of-w
ork system
”
,
 
a varian
t of Bit
coin
’
s pr
o
of-o
f-work tha
t is not necessar
y to be understood
 
for this t
opic to be com
pre
hensible. Also H
al Finne
y is the recip
ient of the 
rst Bi
tcoin transaction, whose sender was Sat
oshi himself.
Re: Bit
coi
n v0.1 relea
sed 
Satoshi Nakamoto Sun, 25 Jan 2009 08:34:34 -0800 

THE BOOK O
F SA
TOSHI
98
Hal Finney wrote:
 
 
* 
 
Spammer botnets could burn through pay-per-send email 
ﬁlters trivially
If POW tokens do become useful, and especially if they 
become money
, machines will no longer sit idle. Users will 
expect their computers to be earning them money (assuming 
the reward is greater than the cost to operate). A computer 
whose earnings are being stolen by a botnet will be more 
noticeable to its owner than is the case today
, hence we might 
expect that in that world, users will work harder to maintain 
their computers and clean them of botnet infestations.
Another factor that would mitigate spam if POW tokens have 
value: there would be a proﬁt motive for people to set up massive 
quantities of fake e-mail accounts to harvest POW tokens from 
spam. They’d essentially be reverse-spamming the spammers with 
automated mailboxes that collect their POW and don’t read the 
message. The ratio of fake mailboxes to real people could become 
too high for spam to be cost effective. 
The process has the potential to establish the POW token’s value in 
the ﬁrst place, since spammers that don’t have a botnet could buy 
tokens from harvesters. While the buying back would temporarily 
let more spam through, it would only hasten the self-defeating 
cycle leading to too many harvesters exploiting the spammers.
Interestingly, one 
of the 
e-gold systems already 
has a 
form of spam 
called “dusting”. 
Spammers send 
a tiny amount 
of gold 
dust in order 
to put 
a spam 
message in the 
transaction’s comment 
ﬁeld. If the 
system let 
users conﬁgure 
the minimum payment 
they’re willing 
to
 
receive, or 
at least 
the minimum that 
can have 
a message with 
it,
 
users could 
set how 
much they’re willing 
to get 
paid to receive 
spam.
Satoshi Nakamoto
The Cr
yptography Mailing List

99
21
B
it
co
i
n An
noun
ced 
o
n P2P Foun
da
tio
n
S
A
TOSHI ANNO
UNCES 
Bit
coin v0.1 at 
p2p
foun
datio
n.nin
g.
com
. is is another f
orum that in
volves peer
-to-p
eer
 techn
ol
-
og
y
. R
ather than co
pying the exact same text of hi
s original 
anno
uncement posted on the Cryptograp
hy mailin
g list, Satoshi wr
ote 
a slightly di
erent a
nnouncemen
t for pub
lication her
e.
Bit
coi
n op
en sour
ce implement
a
tio
n  
o
f P2P currency
Satoshi Nakamoto February 11, 2009 at 22:27
I’ve developed a new open source P2P e-cash system called 
Bitcoin. It’s completely decentralized, with no central server or 

THE BOOK O
F SA
TOSHI
100
trusted parties, because everything is based on crypto proof 
instead of trust. Give it a try, or take a look at the screenshots and 
design paper:
Download Bitcoin v0.1 at http://www.bitcoin.org
The root problem with conventional currency is all the trust that’s 
required to make it work. The central bank must be trusted not 
to debase the currency, but the history of ﬁat currencies is full of 
breaches of that trust. Banks must be trusted to hold our money 
and transfer it electronically, but they lend it out in waves of credit 
bubbles with barely a fraction in reserve. We have to trust them 
with our privacy, trust them not to let identity thieves drain our 
accounts. Their massive overhead costs make micropayments 
impossible.
A generation ago, multi-user time-sharing computer systems had 
a similar problem. Before strong encryption, users had to rely on 
password protection to secure their ﬁles, placing trust in the system 
administrator to keep their information private. Privacy could 
always be overridden by the admin based on his judgment call 
weighing the principle of privacy against other concerns, or at the 
behest of his superiors. Then strong encryption became available 
to the masses, and trust was no longer required. Data could be 
secured in a way that was physically impossible for others to 
access, no matter for what reason, no matter how good the excuse, 
no matter what.
It’s time we had the same thing for money. With e-currency based 
on cryptographic proof, without the need to trust a third party 
middleman, money can be secure and transactions effortless.
One of the fundamental building blocks for such a system is digital 
signatures. A digital coin contains the public key of its owner. To 
transfer it, the owner signs the coin together with the public key 
of the next owner. Anyone can check the signatures to verify the 
chain of ownership. It works well to secure ownership, but leaves 
one big problem unsolved: double-spending. Any owner could try 

Bit
coi
n Announced o
n P2P Founda
tion
101
to re-spend an already spent coin by signing it again to another 
owner. The usual solution is for a trusted company with a central 
database to check for double-spending, but that just gets back to 
the trust model. In its central position, the company can override 
the users, and the fees needed to support the company make 
micropayments impractical.
Bitcoin’s solution is to use a peer-to-peer network to check 
for double-spending. In a nutshell, the network works like a 
distributed timestamp server, stamping the ﬁrst transaction to 
spend a coin. It takes advantage of the nature of information being 
easy to spread but hard to stiﬂe. For details on how it works, see 
the design paper at http://www.bitcoin.org/bitcoin.pdf
The result is a distributed system with no single point of failure. 
Users hold the crypto keys to their own money and transact directly 
with each other, with the help of the P2P network to check for 
double-spending.
Satoshi Nakamoto 
http://www.bitcoin.org

103
22
O
n Decentraliz
a
ti
o
n 
as Ke
y t
o Success
S
A
TOSHI T
ALKS HERE
 abou
t the importance of a decen
tralize
d 
currency as a key to success. A
s stated earlier
, the governmen
t’
s 
abili
ty to contr
ol the supp
ly of a currency pro
vides an easy way t
o 
nance deci
t spending. Any cen
trally contr
olled elec
tronic curren
-
cies that ha
ve a
ppe
ared so far ha
ve been disman
t
led by go
vernments 
for 
various reasons. 
T
ypical reasons in
clude facilitatin
g money laun
-
dering or the p
urchase of drugs, even though US dollars a
re the main 
cho
ice for these nancial activities.

THE BOOK O
F SA
TOSHI
104
Re: Bit
coi
n op
en sour
ce implement
a
tio
n  
o
f P2P currency
Satoshi Nakamoto February 15, 2009 at 16:42
Sepp Hasslberger wrote:
Could there be synergies with bitcoin?
http://opencoin.org/
Could be. They’re talking about the old Chaumian central mint 
stuff, but maybe only because that was the only thing available. 
Maybe they would be interested in going in a new direction.
A lot of people automatically dismiss e-currency as a lost cause 
because of all the companies that failed since the 1990’s. I hope 
it’s obvious it was only the centrally controlled nature of those 
systems that doomed them. I think this is the ﬁrst time we’re trying 
a decentralized, non-trust-based system.

105
23
O
n th
e Subject  
o
f Mo
n
e
y Sup
pl
y
S
A
TOSHI EXPLAINS 
his g
eneral concept on this f
orum and 
follo
ws up about the is
sue of mon
e
y sup
ply versus the pop
ul
a
-
tion. H
e then compa
res Bit
coin to pr
e
cious metals an
d refers to a 
feedback loop on the p
rice w
hich could occur when number of u
s
ers 
gro
ws faster than the sup
ply of b
itcoin
s. Int
erestingly
, this was indeed 
what did occur
.
Ima
g
ine if the popula
tion were to disco
ver
, through real life experi
-
ence, wha
t it is to cond
uct t
heir lives wi
th a c
urrency that does not lose 
its value
, but in reality ga
ins in value. A
s our econom
y grows a
nd as 
our ma
nufacturing ca
p
abili
ties increase, prices go do
wn. e only rea
-
son that 
prices are no
t going do
wn today—except in p
roducts where 
imp
rov
ements ar
e ver
y rapid (e
.g., comp
uters)—is because of g
overn
-
men
t-caused cur
rency ination. 

THE BOOK O
F SA
TOSHI
106
Re: Bit
coi
n op
en sour
ce implement
a
tio
n  
o
f P2P currency
Satoshi Nakamoto February 18, 2009 at 20:50
It is a global distributed database, with additions to the database 
by consent of the majority, based on a set of rules they follow:
• 
 
Whenever someone ﬁnds proof-of-work to generate a block, 
they get some new coins
• 
 
The proof-of-work difﬁculty is adjusted every two weeks to target 
an average of 6 blocks per hour (for the whole network)
• 
 
The coins given per block is cut in half every 4 years
Y
ou could say coins are issued by the majority. They are issued in a 
limited, predetermined amount.
As an example, if there are 1000 nodes, and 6 get coins each 
hour, it would likely take a week before you get anything.
To Sepp’s question, indeed there is nobody to act as central bank 
or federal reserve to adjust the money supply as the population of 
users grows. That would have required a trusted party to determine 
the value, because I don’t know a way for software to know the 
real world value of things. If there was some clever way, or if we 
wanted to trust someone to actively manage the money supply to 
peg it to something, the rules could have been programmed for 
that.
In this sense, it’s more typical of a precious metal. Instead of 
the supply changing to keep the value the same, the supply is 
predetermined and the value changes. As the number of users 
grows, the value per coin increases. It has the potential for a 
positive feedback loop; as users increase, the value goes up, which 
could attract more users to take advantage of the increasing value. 

107
24
Releas
e o
f  
B
it
co
i
n v0.1.3
I
N THIS RELEAS
E,
 the soware has x
ed communica
tion issues. 
Sat
oshi ta
lks about ma
tura
tion count
down for b
lo
ck pr
oof-of-
work
 discovery
, i.e., the rewa
rd miners obta
in f
rom sol
ving a block.
[b
itc
oi
n-list] Bit
co
in v0.1.3
Satoshi Nakamoto 2009-01-12 22:48:23
It looks like we’re through with the worst of the Internet connection 
issues. 0.1.3 ﬁxed a problem where your node’s communications 
could go dead after a while. The network is running much more 
smoothly now with this version. 

THE BOOK O
F SA
TOSHI
108
If you’ve successfully generated a block, you’ve seen it has a 
maturation countdown before you can spend it. Once it matures, 
the Credit column will change from 0.00 to 50.00. For a block 
to be valid, it has to be broadcasted to the network and get into 
the block chain, which is why Generate does not run if you’re not 
connected. If you generated a block without being connected, the 
network wouldn’t know about it and would continue building the 
chain without it, leaving it behind, and the maturation countdown 
would change to “(not accepted)” when your node sees that it 
wasn’t used. If you subtract 1 from the status column, that’s how 
many blocks have been chained after yours.
Satoshi Nakamoto

109
25
O
n T
imest
a
mp
i
ng 
Docu
ments
H
ERE, 
H
al mentions tha
t some people suggest
e
d using the 
block cha
in to timestamp documents b
y way o
f an extra 
hash. (See the earlier explana
tion of cryptographic ha
sh in 
the sec
tion en
titled 
Cr
yptogra
phic h
ash functio
n—a digit
al “n
ger
-
pr
int”
 in C
ha
pter 2.)
[b
itc
oi
n-list] Bit
co
in v0.1.5 releas
ed
Satos
hi Nakamot
o 2009-03-04 16:29:12 
Hal Finney wrote:
That sounds good. I’d also like to be able to run multiple 

THE BOOK O
F SA
TOSHI
110
coin/block generators on multiple machines, all behind a 
single NA
T address. I haven’t tried this yet so I don’t know if it 
works on the current software.
The current version will work ﬁne. They’ll each connect over the 
Internet, while incoming connections only come to the host that 
port 8333 is routed to. 
As an optimisation, I’ll make a switch “-connect=1.2.3.4” to make 
it only connect to a speciﬁc address. Y
ou could make your extra 
nodes connect to your primary, and only the primary connects over 
the Internet. It doesn’t really matter for now, since the network 
would have to get huge before the bandwidth is anything more 
than trivial.
BTW I don’t remember if we talked about this, but the other 
day some people were mentioning secure timestamping. Y
ou 
want to be able to prove that a certain document existed at 
a certain time in the past. Seems to me that bitcoin’
s stack of 
blocks would be perfect for this.
Indeed, Bitcoin is a distributed secure timestamp server for 
transactions. A few lines of code could create a transaction with an 
extra hash in it of anything that needs to be timestamped. I should 
add a command to timestamp a ﬁle that way.
Later I want to add interfaces to make it really easy to integrate 
into websites from any ser
ver side language.
Right, and I’d like to see more of a librar
y inter
face that could 
be called from programming or scripting languages, on the 
client side as well.
 Exactly.
Satoshi Nakamoto
http://www.bitcoin.org

111
26
B
it
co
i
nt
alk Fo
rum 
Wel
co
me Message
S
A
TOSHI ANNO
UNCES
 the launch o
f a new forum dedicated to 
Bit
coin on 
sourceforge.net
.
Wel
come t
o the n
e
w Bit
co
in fo
rum!
Satoshi Nakamoto November 22, 2009, 06:04:28 PM 
Welcome to the new Bitcoin forum!
The old forum can still be reached here: 
http://bitcoin.sourceforge.net/boards/index.php
I’ll repost some selected threads here and add updated answers to 
questions where I can. 

THE BOOK O
F SA
TOSHI
112
FAQ 
http://bitcoin.sourceforge.net/wiki/index.php?page=FAQ 
 
Download 
http://sourceforge.net/projects/bitcoin/ﬁles/

113
27
O
n B
it
co
i
n 
M
a
tur
a
ti
o
n
M
A
TUR
A
TION 
is specic to bit
coins that h
ave been newly 
crea
ted as rewards gi
ven to miners fo
r their work on the 
block cha
in. Once a block has little o
r no chance of becom
-
ing an o
rphan block, the corr
esp
ondin
g awar
de
d bi
tcoins ar
e mat
ure 
enough to be safel
y credited to the miner
.
Bit
coi
n M
a
tura
tio
n?
Satoshi Nakamoto November 22, 2009, 06:31:44 PM 
Bitcoin Maturation
Posted:Thu 01 of Oct, 2009 (14:12 UTC)

THE BOOK O
F SA
TOSHI
114
From the user’s perspective the bitcoin maturation process can be 
broken down into 8 stages.
1. 
 
The initial network transaction that occurs when you ﬁrst click 
Generate Coins.
2. 
 
The time between that initial network transaction and when 
the bitcoin entry is ready to appear in the All Transactions list.
3. 
 
The change of the bitcoin entry from outside the All 
Transaction ﬁeld to inside it.
4. 
 
The time between when the bitcoin appears in the All 
Transfers list and when the Description is ready to change to 
Generated (50.00 matures in x more blocks).
5. 
 
The change of the Description to Generated (50.00 matures 
in x more blocks).
6. 
 
The time between when the Description says Generated 
(50.00 matures in x more blocks) to when it is ready to 
change to Generated.
7. 
 
The change of the Description to Generated.
8. 
 
The time after the Description has changed to Generated.
Which stages require network connectivity, signiﬁcant local CPU 
usage and or signiﬁcant remote CPU usage? Do any of these 
stages have names?
Re: Bit
coi
n M
a
tura
tio
n?
Sirius-m October 22, 2009, 02:26 UTC
As far as I know
, there’
s no network transaction when you 
click Generate Coins–your computer just starts calculating 
the next proof-of-work. The CPU usage is 100% when you’re 
generating coins.
In this example, the network connection is used when you 
broadcast the information about the proof-of-work block 

O
n Bitco
in Ma
tura
tion
115
you’ve created (that which entitles you to the new coin). 
Generating coins successfully requires constant connectivity
, 
so that you can start working on the next block when someone 
gets the current block before you
Bit
coi
n M
a
tura
tio
n?
Satoshi Nakamoto November 22, 2009, 06:34:21 PM 
It’s important to have network connectivity while you’re trying 
to generate a coin (block) and at the moment it is successfully 
generated.
1. During generation (when the status bar says “Generating” 
and you’re using CPU to ﬁnd a proof-of-work), you must 
constantly keep in contact with the network to receive the 
latest block. If your block does not link to the latest block, it 
may not be accepted.
2. 
 
When you successfully generate a block, it is immediately 
broadcast to the network. Other nodes must receive it and 
link to it for it to be accepted as the new latest block.
Think of it as a cooperative effort to make a chain. When you add 
a link, you must ﬁrst ﬁnd the current end of the chain. If you were 
to locate the last link, then go off for an hour and forge your link, 
come back and link it to the link that was the end an hour ago, 
others may have added several links since then and they’re not 
going to want to use your link that now branches off the middle.
After a block is created, the maturation time of 120 blocks is to 
make absolutely sure the block is part of the main chain before it 
can be spent. Y
our node isn’t doing anything with the block during 
that time, just waiting for other blocks to be added after yours. Y
ou 
don’t have to be online during that time.

117
28
H
ow An
o
nymous  
are B
it
co
i
ns?
U
NLIKE A S
UITCASE 
full of $100 b
ills, w
hich can be mo
ved 
withou
t any trace
, Bitcoin tra
nsac
tions a
re recor
ded in t
he 
pub
lic le
dger
. Although Bit
coin addresses ar
e anon
ymous in 
na
ture, the transaction
s conducted in the names o
f thes
e addresses ar
e 
not.
Ho
w ano
nymous are b
itc
oi
ns?
Satoshi Nakamoto November 25, 2009, 06:17:23 PM 
Can nodes on the network tell from which and or to which bitcoin 
address coins are being sent? Do blocks contain a history of where 
bitcoins have been transfered to and from?

THE BOOK O
F SA
TOSHI
118
Bitcoins are sent to and from bitcoin addresses, which are 
essentially random numbers with no identifying information.
When you send to an IP address, the transaction is still written to 
a bitcoin address. The IP address is only used to connect to the 
recipient’s computer to request a fresh bitcoin address, give the 
transaction directly to the recipient and get a conﬁrmation. 
Blocks contain a history of the bitcoin addresses that a coin has 
been transferred to. If the identities of the people using the bitcoin 
addresses are not known and each address is used only once, 
then this information only reveals that some unknown person 
transferred some amount to someone else.
The possibility to be anonymous or pseudonymous relies on 
you not revealing any identifying information about yourself in 
connection with the bitcoin addresses you use. If you post your 
bitcoin address on the web, then you’re associating that address 
and any transactions with it with the name you posted under. If 
you posted under a handle that you haven’t associated with your 
real identity, then you’re still pseudonymous.
For greater privacy, it’s best to use bitcoin addresses only once. 
Y
ou can change addresses as often as you want using Options-
>Change Y
our Address. Transfers by IP address automatically use 
a new bitcoin address each time.
Can nodes tell which bitcoin addresses belong to which IP 
addresses?
No.
Is there a command line option to enable the sock proxy the 
ﬁrst time that bitcoin starts?
In the next release (version 0.2), the command line to run it 
through a proxy from the ﬁrst time is: 
bitcoin -proxy=127.0.0.1:9050

How An
onymous are Bit
coi
ns? 
119
The problem for TOR is that the IRC server which Bitcoin uses to 
initially discover other nodes bans the TOR exit nodes, as all IRC 
servers do. If you’ve already connected once before then you’re 
already seeded, but for the ﬁrst time, you’d need to provide the 
address of a node as such: 
bitcoin -proxy=127.0.0.1:9050 -addnode=<someipaddress>
If someone running a node with a static IP address that can accept 
incoming connections could post their IP to use for -addnode, that 
would be great.
What happens if you send bitcoins to an IP address that has 
multiple clients connected through network address translation 
(NA
T)?
Whichever one you’ve set your NAT to forward port 8333 to will 
receive it. If your router can change the port number when it 
forwards, you could allow more than one client to receive. For 
instance, if port 8334 forwards to a computer’s port 8333, then 
senders could send to “x.x.x.x:8334” 
If your NAT can’t translate port numbers, there currently isn’t a 
command line option to change the incoming port that bitcoin 
binds to, but I’ll look into it.

121
29
A Fe
w Questio
ns 
Answered b
y Sa
t
os
h
i
I
N THESE
 POSTS,
 Satoshi a
nswers a wide variety of q
uestions 
such as ho
w anon
ymous B
itcoin is, the r
equiremen
t for backu
ps, 
and wha
t happens in the case of los
t coins. Ano
t
her questio
n asked 
was whether Bit
coin
’
s being open source co
uld p
ose a se
curity pro
b
-
lem as, fo
r example a min
er was changing the code. Sa
toshi replied 
that o
ther miners would no
t accept it as it w
ould be a de
viation o
f the 
Bit
coin pr
otocol.
Re: Questio
ns about Bit
co
in
Satoshi Nakamoto December 10, 2009 08:49:02 PM 

THE BOOK O
F SA
TOSHI
122
SmokeT
ooMuch wrote:
Hi, yesterday i stumpled upon this great payment option.
I read my way trough many sites but now I have some 
questions that couldn’t get answered.
 
 
1. 
 
Is Bitcoin really anonymous ? I mean totally and 
completely ? Is my ISP able to detect, that i have sent or 
received a Bitcoin payment ? Maybe he is even able to 
see that i am running Bitcoin right now ?
 
 
2. 
 
If i understood this correctly
, my payment par
tners are 
not able to see who I am. Does this mean, he can not see 
my real IP adress ? Only the Bitcoin-adress ? Even if he 
monitors his network connections and stuff ?
 
 
3. 
 
If there is a way to tell that I am running Bitcoin for my 
ISP or a way to ﬁnd out my IP for my payment partners, 
would it be more safe to tunnel the network trafﬁc through 
a VPN (payed with Paysafecard for example). ? Could 
this be dangerous, because the VPN provider will be able 
to capture my payment ?
 
 
4. 
 
What ﬁles need to be backed up for not loosing my 
“money” ? Only the wallet.dat or the whole Bitcoin 
AppData director
y ?
 
 
5. 
 
Isn`t it possible to multiply a wallet and use it on different 
machines ? This way you would double your money 
without doing anything for it. 
Are there security measures for this case ?
 
 
6. 
 
When someone loses his wallet, will there be a way to 
recreate the lost coins in the system ? Else the 21 million 
maxmimum will not be correct. 
(I mean not to recover the lost coins for one person, but 
if all the 21mio coins were created, and someone loses 
his wallet with 1mio coins, will the the others be able to 
create these 1mio coins now or are they totally lost for the 
bitcoin network ?)
 
 
7. 
 
I have read that there currently are about 130k blocks 

A Few Questions Answered b
y Sa
tosh
i
123
out there. At my pc it only shows me about 24k. Is there 
something wrong or is this a normal behaviour ?
 
 
8. 
 
I`m afraid I didn`t understand ever
ything about the 
bitcoin creation. How many coins are created by a 
machine in 24h in average ?
 
 
9. 
 
I know that port 8333 should be for
warded to the bitcoin-
running machine. Now I ask myself if this goes for the 
TCP or the UDP
. 
And is this port required for generating coins ? Or only 
for payment transactions ?
 
10. 
 
I`ve seen that the source code for bitcoin is open for 
ever
ybody
. Can this be an actual danger ? If the code is 
manipulated people can create more bitcoins than others, 
can`t they ? This would be a massive leak of security
.
 
11. 
 
I`ve seen a formular to clalculate the coins that will be 
created in a certain amount of time. It had something to 
do with the maximum cpu speed and the availabe. Can`t 
ﬁnd it anymore, so I`m asking you to explain me the coin 
creating. Do slow machines produce as much coins as 
high-end ones ?
 
12. 
 
Are there any other exchanging systems or potential 
payment partners except for new liber
ty standard ?
 
13. 
 
What happens when my system crashes ? Is the wallet 
saved automatically or only when bitcoin gets closed 
manually ? (Maybe even real-time saving when a coint is 
created or payment is made ?)
 
14. 
 
Is there a way to see how many bitcoins have beenm 
generated this far ? And how old is Bitcoin already ?
I know .... Many many questions but I am really interested in 
your ser
vice and want to know ever
ything before i start using 
it more frequently
.
(Sorr
y 
 
for 
 
my 
 
bad 
 
English . . . )

THE BOOK O
F SA
TOSHI
124
1—3: For that level of anonymity you need to connect through TOR, 
which will be possible with version 0.2, which is only a few weeks 
away.  I’ll post TOR instructions at that time.
4: Version 0.1.5: backup the whole %appdata%\Bitcoin directory. 
Version 0.2: you can backup just wallet.dat.
5: Nope.  The whole design is all about preventing that from 
working.
6: Those coins can never be recovered, and the total circulation is 
less.  Since the effective circulation is reduced, all the remaining 
coins are worth slightly more.  It’s the opposite of when a 
government prints money and the value of existing money goes 
down.
7: It’s currently 29,296 blocks.  The circulation is the number of 
blocks times 50, so the current circulation is 1,464,800 bc.  
If you only have 24k blocks, it must not have ﬁnished the initial 
block download.  Exit bitcoin and start it again.  Version 0.2 is 
better/faster at the initial block download.
8: Typically a few hundred right now.  It’s easy now but it’ll get 
harder as the network grows.
9: Good question, it’s TCP.  The website needs to be updated to 
say TCP port 8333.
The port forwarding is so other nodes can connect to you, so it 
helps you stay connected because you are able to be connected 
with more nodes.  Y
ou also need it to receive payments by IP 
address.
10: No, the other nodes won’t accept that.
Being open source means anyone can independently review the 
code.  If it was closed source, nobody could verify the security.  I 
think it’s essential for a program of this nature to be open source.
11: Slower machines produce fewer coins.  It’s proportional to CPU 
speed.

A Few Questions Answered b
y Sa
tosh
i
125
12: There are more coming.
13: It uses a transactional database called Berkeley DB.  It will 
not lose data in a system crash.  Transactions are written to the 
database immediately when they’re received.
14: For now, you can just multiply the total blocks by 50.  The 
Bitcoin network has been running for almost a year now.  The 
design and coding started in 2007.
Re: Questio
ns about Bit
co
in
SmokeT
ooMuch wrote:
W
ow
, thanks alot for these detailed answers.
But today another question came to my mind.
Lets say we know
, that our neighbar uses Bitcoin, and we also 
know that he will receive a payment soon (maybe because 
he owns an internet shop and accepts bitcoin as payment 
option).
Also, we know that he uses WLAN and his network 
is unsecured or weak protected. Same goes for router 
conﬁguration.
W
e now could log into his router conﬁguration, change the ip 
adresses for the for
warded por
t 8333 to our system ip. 
Now ever
y payment would be received by our bitcoin client.
Is this actually going to work ?
I know this is highly criminal and the scenario is .. well, lets 
call it “uncommon”, but in theor
y it should work, right ? 
(Not that I have an interest in harming people, but I know that 
criminal people will tr
y many ways to get some money
.)

THE BOOK O
F SA
TOSHI
126
BTW
: same should work when you are on a LAN par
ty with 
unprotected router conﬁg.
Edit: Or are these scenarios totally impossible because no 
matter which ip adress uses the port, the payment will go to 
the bitcoin or ip adress that was deﬁned from the payer ?
That’s true, with the send-to-IP option, you are sending to whoever 
answers that IP. Sending to a bitcoin address doesn’t have that 
problem.
The plan is to implement an IP + bitcoin address option that would 
have the beneﬁts of both. It would still use a different address for 
each transaction, but the receiver would sign the one-time-use 
address with the given bitcoin address to prove it belongs to the 
intended receiver.

127
30
O
n “Na
tural 
D
efl
a
ti
o
n”
T
HE TOPIC OF LOSING COINS
 has been cover
ed a few 
times. ey are r
eferred to as “
nat
ural deation.
” Her
e are two 
discussions r
elating to this is
sue. No
te that na
tional currencies 
today ar
e born out o
f debt. When a loan is taken f
or a car or a ho
use, 
the same n
umber of dollars is cr
e
at
ed, and, once the loa
n is repaid, 
the currency disappears. A dea
tionar
y en
v
iro
nment in our curren
t 
system mean
s that the value of as
s
ets (houses, cars, et
c.) wi
ll decline, 
bu
t, since loans hav
e b
een taken out to p
urchase them, a cascade of 
bankruptcies will follo
w as pe
ople o
wn more tha
n t
hey can pur
chase. 
On the other han
d, when a c
urrency is intrinsically xed in am
ount, 
loans ar
e extremely ra
re. Before the cr
eation of the F
ederal Res
er
ve in 
the USA in 1913, the majo
r
ity of p
urchases wer
e done in cash, even 
for h
ouses. e implica
tion of a currency xed in value, o
r even one 

THE BOOK O
F SA
TOSHI
128
that ga
ins in value, ar
e important. P
eople would no
t have t
o spe
cu
-
lat
e in mut
u
al funds for their r
etirement; in
stead one could sim
ply 
save the m
oney to make a pur
chase. is is typically called “hoarding
” 
by the na
ncial medi
a, but so a
re retiremen
t funds. Essentially
, sav
-
ing mean
s you ar
e delaying con
sumptio
n of mat
er
ial, resour
ces, and 
time so that other
s, including co
mpanies in
vesting in new plan
ts, can 
imp
rov
e productivity no
w
. L
ater yo
u enjoy y
our retirem
ent because 
of this dela
yed consum
ption. e co
ncept of mo
ney is more a
bstrac
t 
than most people think.
Re: A fe
w suggestio
ns
Satoshi Nakamoto December 13, 2009 04:51:25 PM 
The Madhatter wrote:
One quick question about “natural deﬂation” (as I call it). I 
have noticed that it is possible to spend to old addresses that 
no longer work. In essence the coins can not be claimed. 
W
ouldn’t there be a natural deﬂation effect because of this? 
I mean if the coins max out at 21,000,000 wouldn’t the 
number of coins slowly work backwards due to payment 
errors?
There would be a command line switch at runtime to tell it to 
run without UI. All it needs to do is not create the main window. 
A simplistic way would be to disable “pframeMain->Show” and 
“ptaskbaricon->Show” in ui.cpp. The network threads don’t care 
that the UI isn’t there. The only other UI is a message box in 
CheckDiskSpace if it runs out of disk space.
Then a separate command line utility to communicate with it to do 
things. Not sure what it should be named.

O
n “Na
tural Defla
tion”
129
“natural deﬂation”... I like that name for it. Y
es, there will be 
natural deﬂation due to payment mistakes and lost data. Coin 
creation will eventually get slow enough that it is exceeded by 
natural deﬂation and we’ll have net deﬂation.
e second con
versation:
Re: Dyi
ng b
itc
oi
ns
Satoshi Nakamoto June 21, 2010 05:48:26 PM 
Hello,
if somebody’
s loosing his wallet (e.g. due to disk crash) he’
s 
not able to get back his coins, is he? 
So ever
y time a person looses coins, they’re lost forever? So 
the bitcoin network will slowly shrink over time? (Because 
there will always be people who loose wallets!)
TIA
virtualcoin
Lost coins only make everyone else’s coins worth slightly more. 
Think of it as a donation to everyone.
Quote from: laszlo on June 21, 2010, 01:54:29 PM
I wonder though, is there a point where the difﬁculty of 
generating a new coinbase is so high that it would make 
more sense to tr
y to recover keys for lost coins or steal other 
people’
s coins instead? The difﬁculty of that is really high 
so for now it makes a lot more sense to generate but I just 
wonder what the real ﬁgures are.. would that ever become 
more productive? Maybe Satoshi can address this..

THE BOOK O
F SA
TOSHI
130
Computers have to get about 2^200 times faster before that starts 
to be a problem. Someone with lots of compute power could make 
more money by generating than by trying to steal. 

131
31
B
it
co
i
n Vers
io
n 0.2  
is Here!
S
A
TOSHI ANNO
UNCES 
versio
n 0.2 of Bit
coin.
Bit
coi
n versi
on 0.2 is h
ere!
Satoshi Nakamoto December 16, 2009 10:45:36 PM 
Bitcoin version 0.2 is here! 
 
Download links: 
http://sourceforge.net/projects/bitcoin/ﬁles/Bitcoin/bitcoin-0.2.0-
win32-setup.exe/download 
http://sourceforge.net/projects/bitcoin/ﬁles/Bitcoin/bitcoin-0.2.0-
win32.zip/download 

THE BOOK O
F SA
TOSHI
132
http://sourceforge.net/projects/bitcoin/ﬁles/Bitcoin/bitcoin-0.2.0-
linux.tar.gz/download
New Features
• 
 
Martti Malmi
• 
 
Minimize to system tray option
• 
 
Autostart on boot option so you can keep it running in the 
background automatically
• 
 
New options dialog layout for future expansion
• 
 
Setup program for Windows
• 
 
Linux version (tested on Ubuntu)
Satoshi Nakamoto
• 
 
Multi-processor support for coin generation
• 
 
Proxy support for use with TOR
• 
 
Fixed some slowdowns in the initial block download
Major thanks to Martti Malmi (sirius-m) for all his coding work and 
for hosting the new site and this forum, and New Liberty Standard 
for his help with testing the Linux version.

133
32
Reco
mmen
da
tio
n o
n 
W
a
ys t
o Do a P
a
yment 
Fo
r an O
rder
T
HERE ARE MUL
TIPLE T
YPES
 of cryptograp
hic a
lgori
t
hms 
used in asymmetric encr
yption. H
ere Sat
oshi’
s main poin
t on 
the reasoning f
or using elli
ptic cur
ve cr
yptogra
phy (EDCSA
) 
instead o
f RSA is the size of the transaction (byt
es). T
o make the size of 
each transaction as small as possible so that b
lo
ck size stays m
anage
-
able, Sa
toshi decided to use EDCSA.

THE BOOK O
F SA
TOSHI
134
Re: A n
e
wb’
s test—anyo
ne w
ant to buy  
a pi
cture fo
r $1?
Satoshi Nakamoto Jnauary 29, 2010 12:22:13 PM 
The recommended ways to do a payment for an order:
1. 
 
The merchant has a static IP, the customer sends to it with a 
comment.
2. 
 
The merchant creates a new bitcoin address, gives it to the 
customer, the customer sends to that address.  This will be 
the standard way for website software to do it.
RSA vs ECDSA: it’s not the size of the executable but the size of 
the data.  I thought it would be impractical if the block chain, 
bitcoin addresses, disk space and bandwidth requirements were 
all an order of magnitude bigger.  Also, even if using RSA for 
messages, it would still make sense to do all the bitcoin network 
with ECDSA and use RSA in parallel for only the message part.  In 
that case, everything that’s been implemented up to now would be 
implemented exactly as it has been.
We can ﬁgure out the best way to do this much later.  It could 
use a separate (maybe existing) e-mail or IM infrastructure to 
pass messages, and instead of RSA, maybe just put a hash of the 
message in the transaction to prove that the transaction is for 
the order described in the message.  The message would have to 
include a salt so nobody could brute force the hash to reveal a 
short message.

135
33
O
n th
e  
P
r
oo
f-o
f-Wo
rk 
D
i
fficul
t
y
S
A
TOSHI DISCUSS
ES 
e increasin
g proof-of-w
ork diculty as 
mor
e miners begin to participate.
Proo
f-of-wo
rk diffi
cul
t
y in
crea
s
ing 
Satoshi Nakamoto February 05, 2010 07:19:12 PM 
We had our ﬁrst automatic adjustment of the proof-of-work 
difﬁculty on 30 Dec 2009.  
The minimum difﬁculty is 32 zero bits, so even if only one 

THE BOOK O
F SA
TOSHI
136
person was running a node, the difﬁculty doesn’t get any easier 
than that.  For most of last year, we were hovering below the 
minimum.  On 30 Dec we broke above it and the algorithm 
adjusted to more difﬁculty.  It’s been getting more difﬁcult at each 
adjustment since then.
The adjustment on 04 Feb took it up from 1.34 times last year’s 
difﬁculty to 1.82 times more difﬁcult than last year.  That means 
you generate only 55% as many coins for the same amount of 
work.
The difﬁculty adjusts proportionally to the total effort across the 
network.  If the number of nodes doubles, the difﬁculty will also 
double, returning the total generated to the target rate.
For those technically inclined, the proof-of-work difﬁculty can 
be seen by searching on “target:” in debug.log.  It’s a 256-
bit unsigned hex number, which the SHA-256 value has to 
be less than to successfully generate a block.  It gets adjusted 
every 2016 blocks, typically two weeks.  That’s when it prints 
“GetNextWorkRequired RETARGET” in debug.log. 
minimum 00000000ffff000000000000000000000000000000000
0000000000000000000 
30/12/2009 00000000d86a00000000000000000000000000000
00000000000000000000000 
11/01/2010 00000000c42800000000000000000000000000000
00000000000000000000000 
25/01/2010 00000000be7100000000000000000000000000000
00000000000000000000000 
04/02/2010 000000008cc300000000000000000000000000000
00000000000000000000000 
14/02/2010 00000000654657000000000000000000000000000
00000000000000000000000 
24/02/2010 0000000043b3e5000000000000000000000000000
00000000000000000000000 
08/03/2010 00000000387f6f0000000000000000000000000000
0000000000000000000000 

O
n the Proof-o
f-Work Di
fficul
ty 
137
21/03/2010 00000000381375000000000000000000000000000
00000000000000000000000 
01/04/2010 000000002a1115000000000000000000000000000
00000000000000000000000 
12/04/2010 0000000020bca7000000000000000000000000000
00000000000000000000000 
21/04/2010 0000000016546f000000000000000000000000000
00000000000000000000000 
04/05/2010 0000000013ec53000000000000000000000000000
00000000000000000000000 
19/05/2010 00000000159c24000000000000000000000000000
00000000000000000000000 
29/05/2010 000000000f67c0000000000000000000000000000
0000000000000000000000 
11/06/2010 000000000eba64000000000000000000000000000
00000000000000000000000 
24/06/2010 000000000d3142000000000000000000000000000
00000000000000000000000 
06/07/2010 000000000ae493000000000000000000000000000
00000000000000000000000 
13/07/2010 0000000005a3f4000000000000000000000000000
00000000000000000000000 
16/07/2010 000000000168fd000000000000000000000000000
00000000000000000000000 
27/07/2010 00000000010c5a000000000000000000000000000
00000000000000000000000 
05/08/2010 0000000000ba18000000000000000000000000000
00000000000000000000000 
15/08/2010 0000000000800e000000000000000000000000000
00000000000000000000000 
26/08/2010 00000000006920000000000000000000000000000
00000000000000000000000 
 
date, difﬁculty factor, % change 
2009   1.00 
30/12/2009  1.18 +18% 
11/01/2010  1.31 +11% 

THE BOOK O
F SA
TOSHI
138
25/01/2010 
 
1.34 
 
+2% 
04/02/2010 
 
1.82 
 
+36% 
14/02/2010 
 
2.53 
 
+39% 
24/02/2010 
 
3.78 
 
+49% 
08/03/2010 
 
4.53 
 
+20% 
21/03/2010 
 
4.57 
 
+9% 
01/04/2010 
 
6.09 
 
+33% 
12/04/2010 
 
7.82 
 
+28% 
21/04/2010 
 
11.46 
 
+47% 
04/05/2010 
 
12.85 
 
+12% 
19/05/2010 
 
11.85 
 
-8% 
29/05/2010 
 
16.62 
 
+40% 
11/06/2010 
 
17.38 
 
+5% 
24/06/2010 
 
19.41 
 
+12% 
06/07/2010 
 
23.50 
 
+21% 
13/07/2010 
 
45.38 
 
+93% 
16/07/2010 
 
181.54 
 
+300% 
27/07/2010 
 
244.21 
 
+35% 
05/08/2010 
 
352.17 
 
+44% 
15/08/2010 
 
511.77 
 
+45% 
26/08/2010 
 
623.39 
 
+22%

139
34
O
n th
e B
it
co
i
n Limit 
an
d Pro
fit
ab
i
lit
y  
of
 N
od
e
s
T
HE ORI
GIN
AL POSTS 
in this thread questioned the p
ro
t
-
abili
ty of miners to mine when the diculty level becomes 
high and the amo
unt of b
itcoin r
ewards decreases (it was 50 
BTC a
t the time of these posts, but was r
educed to 25 BTC la
ter on in 
early 2013).
Re: Current Bit
coi
n econ
omic mo
del  
is unsust
ainab
le 
Satoshi Nakamoto February 21, 2010 05:44:24 PM 

THE BOOK O
F SA
TOSHI
140
xc wrote:
Nothing to sweat people.  Nobody ever died of a 
‘deﬂationar
y spiral.’  : - )  I agree with “I-am-not-
anonymous.”  The market will choose the best bitcoin-like 
currency
.  I happen to believe, however
, that the rules that 
Satoshi has founded bitcoin on will be more than adequate 
for the future of a thriving bitcoin economy
.  
Ever
ybody knows exactly how fast the supply of bitcoins 
will grow: it’
s set in stone in the rules of the programming 
and the bitcoin network.  While it’
s true that there is not a 
currently existing fully-ﬂeshed out market to truly price bitcoins, 
such markets and exchanges are being developed.  As far 
as future would-be bitcoin generators are concerned, the 
question is not how much will he “demand....to compensate 
for his costs.”  The question he’ll be asking himself is “given 
current market values and my ability to utilize electricity and 
CPU resources, is it worth it for me to generate bitcoins?”  If 
the answer is yes, he participates.  If it’
s no, he stops tr
ying to 
mine for bitcoins and focuses on trading tangible assets with 
bitcoins ser
ving as an appropriate intermediar
y
.  If he’
s not 
sure, he tries his hand at it for a while and then makes a ﬁnal 
decision.
The number of nodes and associated computational cpu 
power will be in ﬂux, and that competitive ﬂux will allow for 
costs to approximate value (not the other way around.)  V
alue 
being set by the markets and the demand for use of bitcoin 
as a trade intermediar
y (a money).  In the far future, the 
competition of transaction costs will play a more important 
role for the would-be node operator
.
Contrar
y to the paradox of thrift argument you present, 
collecting bitcoins and saving them with hopes of earning 
purchasing power through deﬂation is not a bad thing.  It will 
allow for the pooling of bitcoin capital and make purchases 
of larger capital investments possible.  In the future, there 

O
n the Bit
coin Limit an
d Profit
abi
lit
y of N
odes 
141
might even be bitcoin banks that lend out saved bitcoins 
with market-set interest rates, thereby diminishing the effects 
of hoarding.  All this wonderful saving, however
, comes at 
a price: delayed gratiﬁcation of present desires.  From the 
perspective of the would-be saver
, the question will always be 
denying present desires to purchase real tangible assets now 
versus the future possibilities of purchasing more later
.  This 
time preference naturally varies with people and in different 
circumstances. 
Given the fact that bitcoins are by their electronic nature 
easily divisible, prices will be able to easily adjust to 
deﬂationar
y pressures.  If too many are saving, prices will 
fall and the rate of interest will go down.  This encourages 
demand (lower prices) and decreases the desire to save (less 
interest). 
XC
Excellent analysis, xc.
A rational market price for something that is expected to increase 
in value will already reﬂect the present value of the expected future 
increases.  In your head, you do a probability estimate balancing 
the odds that it keeps increasing.
In the absence of a market to establish the price, 
NewLibertyStandard’s estimate based on production cost is a good 
guess and a helpful service (thanks).  The price of any commodity 
tends to gravitate toward the production cost.  If the price is below 
cost, then production slows down.  If the price is above cost, proﬁt 
can be made by generating and selling more.  At the same time, 
the increased production would increase the difﬁculty, pushing the 
cost of generating towards the price.
In later years, when new coin generation is a small percentage of 
the existing supply, market price will dictate the cost of production 
more than the other way around.

THE BOOK O
F SA
TOSHI
142
At the moment, generation effort is rapidly increasing, suggesting 
people are estimating the present value to be higher than the 
current cost of production.

143
35
O
n th
e Poss
i
b
i
lit
y 
o
f B
it
co
i
n Add
ress 
C
o
llis
io
ns
B
ITCOIN AD
DRESSES 
a
re creat
ed out of a has
h of the public 
addresses, an
d concern was expres
s
ed about a possible co
lli
-
sion
, wher
e t
wo dier
ent individ
ua
ls could b
y s
ome ra
ndom 
chan
ce b
e assigned the same Bit
coin address. N
ote tha
t a 160-bit ha
sh 
yields 2 to the pow
er of 160 or 1.46 x 10
48
 possibilities, a
nd therefor
e 
the pr
obability of a co
l
lision
’
s occ
urring is extremely r
emote.
Re: Bit
coi
n Address Co
llis
io
ns 
Satoshi Nakamoto February 23, 2010 09:22:47 AM 

THE BOOK O
F SA
TOSHI
144
NewLibertyStandard wrote:
Although extremely unlikely
, what would happen if two 
Bitcoin clients generated the same Bitcoin address? W
ould 
payments be delivered to whichever client encountered the 
payment ﬁrst? If there is a mechanism in place to prevent such 
collisions, please explain it.
There’s a separate public/private keypair for every bitcoin address. 
Y
ou don’t have a single private key that unlocks everything. Bitcoin 
addresses are a 160-bit hash of the public key, everything else in 
the system is 256-bit.
If there was a collision, the collider could spend any money sent to 
that address. Just money sent to that address, not the whole wallet.
If you were to intentionally try to make a collision, it would 
currently take 2^126 times longer to generate a colliding bitcoin 
address than to generate a block. Y
ou could have got a lot more 
money by generating blocks.
The random seed is very thorough. On Windows, it uses all 
the performance monitor data that measures every bit of disk 
performance, network card metrics, cpu time, paging etc. since 
your computer started. Linux has a built-in entropy collector. 
Adding to that, every time you move your mouse inside the Bitcoin 
window you’re generating entropy, and entropy is captured from 
the timing of disk ops.
  

145
36
QR
 C
od
e
T
W
O CONVERSA
TIONS 
r
elated to Q
R co
de for m
obile 
pho
nes came up
. Base
d on an o
rigina
l suggestion fro
m user 
ec
 
on the fo
rum, Satoshi suggest
ed using QR code for the b
itcoin 
address f
or paymen
ts at poin
t of sale, a commo
n practice tod
ay
.
Re: URI-sch
eme for b
itco
in 
Satoshi Nakamoto February 24, 2010 05:57:43 AM 
That would be nice at point-of-sale. The cash register displays a 
QR-code encoding a bitcoin address and amount on a screen and 
you photo it with your mobile.
https://bitcointalk.org/index.php?topic=177.msg1814#msg1814

THE BOOK O
F SA
TOSHI
146
Re: Bit
coi
n mob
ile 
Satoshi Nakamoto February 24, 2010 05:57:43 AM 
Quote from: sirius-m on June 10, 2010, 01:51:16 PM
Y
ou can of course use ser
vices like vekja.net or mybitcoin.com 
on a mobile browser
, depositing money there to the extent 
you trust them. 
I think that’s the best option right now. Like cash, you don’t keep 
your entire net worth in your pocket, just walking around money 
for incidental expenses.
They could make a smaller version of the site optimized for mobile. 
If there was an app, it could be a front end to one of those, with 
the main feature being QR-code reader, or maybe there’s already 
a universal QR-code reading app that web sites can be designed to 
accept scans from.
If there was an iPhone app that was just a front end for vekja or 
mybitcoin, not a big involved P2P, would apple approve it and if 
not, on what basis? It could always be an Android app instead. An 
app is not really necessary though, just a mobile sized website.
A web interface to your own Bitcoin server at home wouldn’t be a 
solution for everyone. Most users don’t have a static IP, and it’s too 
much trouble to set up port forwarding. 

147
37
B
it
co
i
n Ic
o
n/L
ogo
S
A
TOSHI PRES
ENT
S 
a logo/ico
n to use for Bi
tcoin and mak
es it 
cop
yr
ight-free. is is 
no longer the logo 
b
eing used by b
itcoin.
org. e curren
t logo is this:
(See http://co
mmons.wikimedia.org/wiki/File:Bi
tcoin.svg)

THE BOOK O
F SA
TOSHI
148
Ne
w ico
n/logo 
Satoshi Nakamoto February 24, 2010 09:24:23 PM 
New icons, what do you think? Better than the old one?
Full size 530x529 image for scaling down to custom sizes: 
http://www.bitcoin.org/download/bitcoin530.png
The perspective shadow was too thick on the larger sizes.  I 
updated 32, 48 and the full size.
I release these images into the public domain (copyright-free). I 
request that derivative works be made public domain.
Quote from: Sabunir on Februar
y 25, 2010, 02:28:49AM
Excellent. This would be a good resource for those 
participating in the banner contest. Why unequal dimensions?
My only suggestion would be to make the coin’
s text stand out 
more. At tiny resolutions outlines tend to be come unworkable, 
so a better option may be to experiment with contrast. Making 
the text signiﬁcantly darker than the rest of the coin would 
likely increase readability
. Alter
nately
, you could make the 
inner circle color darker
, and the text lighter
.

Bit
coi
n Icon/L
ogo
149
Good suggestion. I made the B slightly lighter and the background 
slightly darker. Very slightly. The foreground is now exactly the 
same colour as the BC in the old one.
It’s kind of OK if you can’t easily read the B in the 16x16. At that 
size, you just need to see that it’s a coin. It doesn’t matter so 
much what’s embossed on it, just that there be some detail there 
because it wouldn’t look like a coin if it was a blank smooth circle.
It’s slightly wider than tall because the dark perspective under it 
goes more to the right than down.
I ﬁnished and posted the 32x31 and 48x47 versions in the ﬁrst 
message. I like the 48 a lot.
How does everyone feel about the B symbol with the two lines 
through the outside? Can we live with that as our logo?
Quote from: Cdecker on Februar
y 27, 2010, 03:24:07 AM
How about an SVG version? That way we could automatically 
generate smaller and larger versions as needed.
I don’t know how to do SVG, but I did the original very large, over 
500 pixels across, so it can be scaled down.  I’ll give the original 
when I’m ﬁnished.
I had to custom tweak each icon size so the vertical lines 
land square on their pixels, otherwise they’re ugly blurry and 
inconsistent.  Such is the challenge of making icons.  The original 
will be good for scaling to custom sizes between 48 and 500 but 
not smaller.

151
38
GP
L Li
cens
e Versus 
MIT Li
cens
e
A
 
SUGGES
TION 
for cr
eating a “we accep
t Bitco
in
” logo had 
a GPL license. H
ere, Sa
toshi stat
es t
ha
t he prefer
s t
he MIT 
license, the same o
p
en source license tha
t t
he Bi
tcoin so
-
war
e us
es.
Re: M
ake your “
we accept B
itc
oi
n” logo 
Satoshi Nakamoto February 24, 2010, 09:53:52 PM
If you GPL stuff, I have to avoid using it. Nothing against GPL 
per-se, but Bitcoin is an MIT license project. Anything GPL please 
clearly mark it as such.

153
39
O
n Mo
n
e
y T
r
ans
fer 
Regula
ti
o
ns
I
N THIS POST
, 
Sa
toshi suggests a ser
vice wherein bu
yers and sell
-
ers of b
itcoin
s could meet in person to com
plete the pur
chase/sa
le 
of b
itcoins a
nd thereb
y avoid a
ny sort of r
egulations. Both parties 
would b
ring a dev
ice capab
le of In
ternet access or meet a
t a place hav
-
ing pu
blic-access com
puters (e
.g., a librar
y or I
nternet caf
é). e buyer 
would p
resumabl
y pay in cash and w
ould pro
vide the s
eller his/her 
address so tha
t the t
ransf
er could be complet
ed. A s
er
vice al
lowing 
buy
ers and sellers to nd each o
t
her does exist today (see for exa
mple 
localbitcoins
.com
).

THE BOOK O
F SA
TOSHI
154
Re: Mo
ney Trans
fer Regul
a
tio
ns 
Satoshi Nakamoto March 03, 2010, 04:28:56 AM
When there’s enough scale, maybe there can be an exchange site 
that doesn’t do transfers, just matches up buyers and sellers to 
exchange with each other directly, similar to how e-bay works.
To make it safer, the exchange site could act as an escrow for the 
bitcoin side of the payment.  The seller puts the bitcoin payment 
in escrow, and the buyer sends the conventional payment directly 
to the seller.  The exchange service doesn’t handle any real world 
money.
This would be a step better than e-bay.  E-bay manages to work 
ﬁne even though shipped goods can’t be recovered if payment falls 
through.

155
40
O
n th
e Poss
i
b
i
lit
y 
o
f a Cr
ypt
ogr
ap
h
ic 
Weakn
ess
S
EVERAL THREADS 
covered di
erent is
sues to which Sat
oshi 
suggested the same sol
ution. T
wo of the threads belo
w concern 
SH
A
-256, which is the cr
yptographic h
ash funct
ion used to cre
-
at
e t
he “
message diges
t” of the b
lo
cks used as the public ledger
, each 
con
taining a set of bi
tcoin transactions. S
H
A
-256 is used by the bank-
ing ind
ustr
y and o
ther nancial institu
tions. W
ere an
y weaknesses to 
one da
y be dis
cover
ed in this encr
yption method, it wo
uld aect the 
whole nancial ind
ustr
y
, which would then be for
ced to chang
e over 
to a new method. Sat
oshi suggests the same policy for Bi
tcoin.
e second thread was in r
egard to the discov
er
y of a major crypto
-
graphic w
ea
kness. A
t rst, Satoshi r
efers to his ear
lier p
ost on S
HA
-256
 

THE BOOK O
F SA
TOSHI
156
Collisions, bu
t user 
l
lam
a
 spe
cies the case where a ma
j
or weakness is 
discover
ed in the elliptic cur
ve cr
yptograp
hic co
de that is used fo
r the 
Bit
coin priva
te key
.
Re: Deali
ng with SHA-256 Co
llisi
ons 
Satoshi Nakamoto June 14, 2010, 08:39:50 AM
Quote from: lachesis on June 14, 2010, 01:01:11 AM
A mathematician friend of mine pointed out that there are 
ver
y few if any hash protocols that have sur
vived for 10 years 
or more. What would Bitcoin’
s solution be if SHA256 were to 
be cracked tomorrow?
SHA-256 is ver
y strong. It’
s not like the incremental step from 
MD5 to SHA1. It can last several decades unless there’
s some 
massive breakthrough attack.
If SHA-256 became completely broken, I think we could come to 
some agreement about what the honest block chain was before 
the trouble started, lock that in and continue from there with a new 
hash function.
If the hash breakdown came gradually, we could transition to a 
new hash in an orderly way. The software would be programmed 
to start using a new hash after a certain block number. Everyone 
would have to upgrade by that time. The software could save the 
new hash of all the old blocks to make sure a different block with 
the same old hash can’t be used.

O
n the Possi
bility of a Cr
yptograph
ic Weakness
157
Re: M
ajo
r Mel
tdown 
Satoshi Nakamoto July 10, 2010, 04:26:01 PM
Quote from: llama on July 01, 2010, 10:21:47 PM
Satoshi, That would indeed be a solution if SHA was broken 
(certainly the more likely meltdown), because we could still 
recognize valid money owners by their signature (their private 
key would still be secure).
However
, if something happened and the signatures were 
compromised (perhaps integer factorization is solved, 
quantum computers?), then even agreeing upon the last valid 
block would be worthless.
True, if it happened suddenly. If it happens gradually, we can still 
transition to something stronger. When you run the upgraded 
software for the ﬁrst time, it would re-sign all your money with 
the new stronger signature algorithm. (by creating a transaction 
sending the money to yourself with the stronger sig)
Re: Hash() fun
ctio
n no
t secure 
Satoshi Nakamoto July 16, 2010, 04:13:53 PM
SHA256 is not like the step from 128 bit to 160 bit.
To use an analogy, it’s more like the step from 32-bit to 64-bit 
address space. We quickly ran out of address space with 16-bit 
computers, we ran out of address space with 32-bit computers at 
4GB, that doesn’t mean we’re going to run out again with 64-bit 
anytime soon.
SHA256 is not going to be broken by Moore’s law computational 
improvements in our lifetimes. If it’s going to get broken, it’ll be 

THE BOOK O
F SA
TOSHI
158
by some breakthrough cracking method. An attack that could so 
thoroughly vanquish SHA256 to bring it within computationally 
tractable range has a good chance of clobbering SHA512 too.
If we see a weakness in SHA256 coming gradually, we can 
transition to a new hash function after a certain block number. 
Everyone would have to upgrade their software by that block 
number. The new software would keep a new hash of all the old 
blocks to make sure they’re not replaced with another block with 
the same old hash.

159
41
O
n a V
ari
et
y o
f 
T
r
ansacti
o
n T
ypes
T
HIS POST
 i
s a bit mo
re technical than other posts pr
esented 
herein. H
owever
, I chose to include i
t b
ecause of i
t is usef
ul 
in explaining wh
y Satos
hi’
s rst imp
lementatio
n of the cor
e 
design sup
p
orted a variety of possible tran
sac
tion types so as to avo
id 
futur
e major modica
tions.
Re: T
r
ansactio
ns and Scri
pts: DUP 
HASH160 . . . EQUAL
VERIF
Y 
 
CHECKSIG 
Satoshi Nakamoto June 17, 2010, 06:46:08 PM
Quote from: Gavin Andresen June 17, 2010, 11:38:31 AM 

THE BOOK O
F SA
TOSHI
160
So I’m writing a little tool that dissects the Bitcoin wallet.dat, mainly
 
because I want to understand better exactly how Bitcoin works.
And I see that the outputs of transactions have a value 
(number of bitcoins) and a bunch of bytes that are run through 
the little Forth-like scripting language built in to bitcoin. E.g.: 
[‘TxOut: value: 100.00 Script: DUP HASH160 6fad...ab90 
EQUAL
VERIFY CHECKSIG’]
First: it make me a little ner
vous that bitcoin has a scripting 
language in it, even though it is a really simple scripting 
language (no loops, no pointers, nothing but math and 
cr
ypto). It makes me ner
vous because it is more complicated, 
and complication is the enemy of security
. It also makes it 
harder to create a second, compatible implementation. But I 
think I can get over that.
Looking at the code, new transactions are veriﬁed by pushing 
the signature an then public key on the interpreter’
s stack and 
then running the TxOut script (did I get that right?).
Could I write code to create transactions with any valid script 
in the TxOut? 
E.g. could I create a TxOut with a script of: OP_2DROP OP_
TRUE 
. 
. 
. 
to create a coin that could be spent by anybody?
And is ﬂexibility in the types of coins created the reason it is 
coded this way?
The nature of Bitcoin is such that once version 0.1 was released, 
the core design was set in stone for the rest of its lifetime. Because 
of that, I wanted to design it to support every possible transaction 
type I could think of. The problem was, each thing required 
special support code and data ﬁelds whether it was used or not, 
and only covered one special case at a time. It would have been 
an explosion of special cases. The solution was script, which 
generalizes the problem so transacting parties can describe their 
transaction as a predicate that the node network evaluates. The 

O
n a V
ariety of T
ransaction Types
161
nodes only need to understand the transaction to the extent of 
evaluating whether the sender’s conditions are met.
The script is actually a predicate. It’s just an equation that 
evaluates to true or false. Predicate is a long and unfamiliar word 
so I called it script.
The receiver of a payment does a template match on the script. 
Currently, receivers only accept two templates: direct payment 
and bitcoin address. Future versions can add templates for more 
transaction types and nodes running that version or higher will 
be able to receive them. All versions of nodes in the network can 
verify and process any new transactions into blocks, even though 
they may not know how to read them.
The design supports a tremendous variety of possible transaction 
types that I designed years ago. Escrow transactions, bonded 
contracts, third party arbitration, multi-party signature, etc. If 
Bitcoin catches on in a big way, these are things we’ll want to 
explore in the future, but they all had to be designed at the 
beginning to make sure they would be possible later.
I don’t believe a second, compatible implementation of Bitcoin 
will ever be a good idea. So much of the design depends on all 
nodes getting exactly identical results in lockstep that a second 
implementation would be a menace to the network. The MIT 
license is compatible with all other licenses and commercial uses, 
so there is no need to rewrite it from a licensing standpoint. 
A second version would be a massive development and 
maintenance hassle for me.  It’s hard enough maintaining 
backward compatibility while upgrading the network without a 
second version locking things in.  If the second version screwed up, 
the user experience would reﬂect badly on both, although it would 
at least reinforce to users the importance of staying with the ofﬁcial 
version.  If someone was getting ready to fork a second version, 
I would have to air a lot of disclaimers about the risks of using a 
minority version.  This is a design where the majority version wins 

THE BOOK O
F SA
TOSHI
162
if there’s any disagreement, and that can be pretty ugly for the 
minority version and I’d rather not go into it, and I don’t have to as 
long as there’s only one version.
I know, most developers don’t like their software forked, but I have 
real technical reasons in this case.
Quote from: gavinandresen on June 17, 2010, 07:58:14 PM
I admire the ﬂexibility of the scripts-in-a-transaction scheme, 
but my evil little mind immediately starts to think of ways 
I might abuse it.  I could encode all sorts of interesting 
information in the TxOut script, and if non-hacked clients 
validated-and-then-ignored those transactions it would be a 
useful covert broadcast communication channel.
That’
s a cool feature until it gets popular and somebody 
decides it would be fun to ﬂood the payment network with 
millions of transactions to transfer the latest Lady Gaga video 
to 
 
all 
 
their 
 
friends . . .
That’s one of the reasons for transaction fees.  There are other 
things we can do if necessary.
Quote from: laszlo on June 17, 2010, 06:50:31 PM
How long have you been working on this design Satoshi?  It 
seems ver
y well thought out, not the kind of thing you just sit 
down and code up without doing a lot of brainstorming and 
discussion on it ﬁrst.  Ever
yone has the obvious questions 
looking for holes in it but it is holding up well : - )
Since 2007.  At some point I became convinced there was a 
way to do this without any trust required at all and couldn’t 
resist to keep thinking about it.  Much more of the work was 
designing than coding.
Fortunately
, so far all the issues raised have been things I 
previously considered and planned for
.

163
42
Fi
rst B
it
co
i
n F
aucet
G
A
VIN ANDRESEN, 
curren
tly Lead C
ore B
itcoin Developer
, 
anno
unced t
hat h
e has written a “
Bitcoin fa
ucet
” g
iving a
way 
5 bi
tcoins per custom
er for free. Sa
toshi replies tha
t he has 
had the same idea in mind if nobody else came u
p with it.
Re: Get 5 free b
itc
oi
ns from freeb
itco
ins.
apps
pot
.c
om 
Satoshi Nakamoto June 18, 2010, 11:08:34 PM
Quote from: Gavin Andresen on June 11, 2010, 
05:38:45PM
For my ﬁrst Bitcoin coding project, I decided to do something 
that sounds really dumb:  I created a web site that gives away 

THE BOOK O
F SA
TOSHI
164
Bitcoins. It is at: https://freebitcoins.appspot.com/ 
Five 
฿
 per customer
, ﬁrst come ﬁrst ser
ved, I’ve stocked it with 
฿
1,100 to start.  I’ll add more once I’m sure it is working 
properly
.
Why?  Because I want the Bitcoin project to succeed, and 
I think it is more likely to be a success if people can get a 
handful of coins to tr
y it out.  It can be frustrating to wait 
until your node generates some coins (and that will get more 
frustrating in the future), and buying Bitcoins is still a little bit 
clunky
.
Please tr
y it out and get some free coins, even if you already 
have more Bitcoins than you know what to do with.  Y
ou can 
get some and then donate them right back; the address is: 
15VjRaDX9zpbA8L
VnbrCAFzrVzN7ixHNsC
Excellent choice of a ﬁrst project, nice work.  I had planned to 
do this exact thing if someone else didn’t do it, so when it gets 
too hard for mortals to generate 50BTC, new users could get 
some coins to play with right away.  Donations should be able to 
keep it ﬁlled.  The display showing the balance in the dispenser 
encourages people to top it up.
Y
ou should put a donation bitcoin address on the page for those 
who want to add funds to it, which ideally should update to a new 
address whenever it receives something.
Later
, as the value was goin
g up
. Satoshi sugg
est reducing the b
it
-
coin fa
ucet to 1 BTC (1 b
itcoin)

First B
itco
in F
aucet
165
Re: Do
na
tio
ns to freeb
it
coi
ns. 
apps
pot
.c
om n
eeded!
Satoshi Nakamoto July 16, 2010, 02:02:07 AM
Quote from: Gavin Andresen on June 12, 2010, 
07:15:46PM
The Bitcoin Faucet is handling the slashdotting really well... 
except that I’m running out of coins to give away
.  over 5,000 
have ﬂowed out of the Faucet since I reﬁlled it last night.
Any of you early adopters who generated tens of thousands 
of coins back in the early days, are you willing to send a 
few to the Faucet to be given away so more people can tr
y 
out Bitcoin?  I know that most of them are likely to be lost (I 
suspect there a lot of slashdot lookey-loos who won’t stick 
around long enough to spend their 5 bitcoins), but if that’
s the 
case then that’ll just increase the value of your other bitcoins, 
anyway
...
Fountain donation address 
is:  15VjRaDX9zpbA8L
VnbrCAFzrVzN7ixHNsC
Depending on donations and how long the slashdotting lasts, 
I might have to start giving away bitnickels...
5 BTC seems like a lot these days, maybe the normal amount 
should be 1 or 2 BTC.
This is an important service so new users can at least get 
something if generating is too hard.
 

167
43
B
it
co
i
n 0.3 Relea
s
ed!
S
A
TOSHI 
is not o
nly technical in terms of wha
t this new release 
oer
ed, but he also gives this sales and m
arketing pi
tch: 
“Es
cap
e 
the a
rbi
tra
r
y ina
tion risk o
f cent
rall
y man
aged curr
encies! Bi
t
-
coi
n
’
s to
tal cir
cula
tion is li
mit
ed to 21 mi
llion c
oins.
”
Bit
coi
n 0.3 relea
sed! 
Satoshi Nakamoto June 06, 2010, 06:32:35 PM
Announcing version 0.3 of Bitcoin, the P2P cryptocurrency!  Bitcoin 
is a digital currency using cryptography and a distributed network 
to replace the need for a trusted central server.  Escape the 
arbitrary inﬂation risk of centrally managed currencies!  Bitcoin’s 
total circulation is limited to 21 million coins.  The coins are 
gradually released to the network’s nodes based on the CPU 

THE BOOK O
F SA
TOSHI
168
power they contribute, so you can get a share of them by 
contributing your idle CPU time.
What’s new:
• 
 
Command line and JSON-RPC control
• 
 
Includes a daemon version without GUI
• 
 
Transaction ﬁlter tabs
• 
 
20% faster hashing
• 
 
Hashmeter performance display
• 
 
Mac OS X version (thanks to Laszlo)
• 
 
German, Dutch and Italian translations (thanks to DataWraith, 
Xunie and Joozero)
Get it at http://www.bitcoin.org or read the forum to ﬁnd out 
more.

169
44
O
n th
e Segment
a
tio
n 
o
r “Intern
et  
Ki
ll Swit
ch”
T
W
O THREADS 
in
volv
e
d the possibility o
f s
egmenta
tion or a 
spli
t of the network.
Re: Ano
nymit
y! 
Satoshi Nakamoto June 08, 2010, 07:12:00 PM
It’s hard to imagine the Internet getting segmented airtight.  It 
would have to be a country deliberately and totally cutting itself off 
from the rest of the world. 

THE BOOK O
F SA
TOSHI
170
Any node with access to both sides would automatically ﬂow the 
block chain over, such as someone getting around the blockade 
with a dial-up modem or sat-phone.  It would only take one node 
to do it.  Anyone who wants to keep doing business would be 
motivated.
If the network is segmented and then recombines, any transactions 
in the shorter fork that were not also in the longer fork are 
released into the transaction pool again and are eligible to get into 
future blocks.  Their number of conﬁrmations would start over.
If anyone took advantage of the segmentation to double-spend, 
such that there are different spends of the same money on each 
side, then the double-spends in the shorter fork lose out and go to 
0/unconﬁrmed and stay that way.
It wouldn’t be easy to take advantage of the segmentation to 
double-spend. If it’s impossible to communicate from one side to 
the other, how are you going to put a spend on each side? If there 
is a way, then probably someone else is also using it to ﬂow the 
block chain over.
Y
ou would usually know whether you’re in the smaller 
segment.  For example, if your country cuts itself off from the rest 
of the world, the rest of the world is the larger segment.  If you’re 
in the smaller segment, you should assume nothing is conﬁrmed.
is cov
ers specica
lly the case of a networ
k split.
Wha
t happens wh
en netwo
rk is split fo
r 
pro
lo
nged time and rec
on
nec
ted?
Posted by em3rgentOrdr on August 01, 2010, 11:07:24 AM
Suppose that BitCoins are being widely used all across the 
globe. Suppose that all internet connections between two 

O
n the Segment
a
tion o
r “Internet Kill Swit
ch” 
171
countries are blocked (eg China and US go to war) and 
people still engage in transactions inside each network. Now 
all transactions within each network are broadcasted to all 
nodes inside its network, but not to the other network. Within 
each network, the longest chain in each would be considered 
valid, and the BitCoin economy would continue to exist inside 
each network.
Now after several years existing independently
, what happens 
when the two networks are reconnected?
Re: Wha
t happens wh
en netwo
rk is split 
fo
r prol
on
ged time and reco
nn
ected?
Posted by kiba on August 02, 2010, 03:19:08 AM
Maybe they won’t be reconnected. Instead, we will effectively 
have two currencies. This will lead to the creation of an 
Eastern-W
estern bitcoin currency exchange market(s).
Re: Wha
t happens wh
en netwo
rk is split 
fo
r prol
on
ged time and reco
nn
ected?
Posted by throughput on August 02, 2010, 06:07:08 PM
I, as a merchant, will only care about whether my network is a 
majority network, so after a reconnect my transactions will be 
accepted. So it will be enough for me to be able to monitor 
the current number of distinct nodes. Put that into a graph and 
stop processing transactions if that number suddenly halves. 
It may be a ser
vice on a web-ser
ver running a Bitcoin node.
But is there a way to monitor that number at all? If not, it 

THE BOOK O
F SA
TOSHI
172
would be wise to add some feature to the standard, which will 
allow to determine in real time what is the number of distinct 
nodes running.
Re: Wha
t happens wh
en netwo
rk is split 
fo
r prol
on
ged time and reco
nn
ected?
Posted by creighto on August 03, 2010, 08:01:22 PM
Quote from: throughput on August 03, 2010, 01:33:08 PM
Y
es... 
But what you describe is only possible after someone have noticed 
and prooved the network split is happening. 
Do you propose any method to detect the beginning of the 
network split?
I started another thread along this line elsewhere, but for an 
individual vendor
, a simple watchdog daemon that tracks the 
average time between blocks since the last ofﬁcial change in 
difﬁculty and alerts the vendor if a single block takes more 
than twice as long as the average, perhaps suspending the 
acceptance of new coins until the vendor checks to see what 
is happening. Each block in a row that takes longer than the 
average increases conﬁdence against a false positive. So 
if one block takes twice as long as average, followed by a 
series of blocks that take 75% longer than average, then you 
can be fairly certain that you are no longer on the majority 
network.

O
n the Segment
a
tion o
r “Internet Kill Swit
ch” 
173
Re: Wha
t happens wh
en netwo
rk is split 
fo
r prol
on
ged time and reco
nn
ected?
Posted by satoshi on August 03, 2010, 10:45:07 PM
creighto: I agree with that idea.  After a few hours, it should be 
possible for the client to notice if the ﬂow of blocks has dropped off 
by more than would be likely just by chance.  It could tell if it’s not 
hearing the hum of the world anymore.
Quote from: knightmb on August 03, 2010, 07:02:13 PM
Quote from: gavinandresen on August 03, 2010, 06:38:44 PM
Or if the split lasted long enough (more than 100 blocks), 
transactions that involve generated coins on the shorter chain 
would be invalid at the merge.
Interesting info, so other than some double-spending issues, as 
long as the block chain isn’t separated for more than 100 or 
so blocks (or 16+ hours), 
In practice, splits are likely to be very asymmetrical.  It would be 
hard to split the world down the middle.  More likely it would be a 
single country vs the rest of the world, lets say a 1:10 split.  In that 
case, it would take the minority fork 10 times as long to generate 
100 blocks, so about 7 days.  Also it would be super easy for the 
client to realize it’s hearing way too few blocks and something 
must be wrong.
Quote from: knightmb on August 03, 2010, 07:02:13 PM
If there a hard coded limit on split delay? Meaning if I had a 
small network split from the public network, spent some coin 
around, came back a few days later and got them sync up to 
the public network (other than coin generation if it happened) 
transactions should be ﬁne?

THE BOOK O
F SA
TOSHI
174
There’s no time limit.  Assuming you weren’t spending coins 
generated in the minority fork, or spending someone’s double-
spends you received, your transactions can get into the other chain 
at any time later. 

175
45
O
n Co
rn
eri
n
g  
th
e M
arket
S
A
TOSHI REPLIES 
to a commen
t about someo
ne
’
s tr
ying to b
uy 
up all of the b
itcoin
s and refer
ences the H
unt br
others and 
t
he 
silver ma
rket of the lat
e 1970s. Not
e that the H
unt b
rothers
’ shar
e 
of b
uying was actually a small p
ercen
tage of the silver ma
rket. Wha
t 
doomed them was their trading on CO
MEX f
rom a levera
ged p
osition 
on the fut
ure excha
nge. COMEX ch
anged the rules by placing a ca
p on 
the total amo
unt of 
contracts one co
uld have, th
us for
cing an
yone ha
v
-
ing mo
re than the specied limit int
o a s
elling position, an
d s
o for
ced 
the H
unt b
rothers to liq
uidate. See the detailed writing on this sub
j
ect 
by M
i
ke M
a
loney a
t 
W
eal
thC
ycles.co
m
:
ht
tp://wealthcycles.com/f
e
at
ures/the-hun
t-bro
thers-capped
 
-the-price-of-g
old-not-50-silver

THE BOOK O
F SA
TOSHI
176
Re: BT
C Vulnerab
ility? (M
assive A
tt
ack 
agai
nst BTC system. Is it reall
y?) 
Satoshi Nakamoto July 09, 2010, 03:28:46 PM
Quote from: user on July 07, 2010, 06:15:28 PM
Hi. (I’m sorr
y if I don’t understand any concept). 
What you think if anyone intruder will buy up bitcoin currency 
and erase all binar
y data. This way can destroy bitcoin 
systems. Is btc network protected against that attack?
What the OP described is called “cornering the market”.  When 
someone tries to buy all the world’s supply of a scarce asset, the 
more they buy the higher the price goes.  At some point, it gets 
too expensive for them to buy any more.  It’s great for the people 
who owned it beforehand because they get to sell it to the corner 
at crazy high prices.  As the price keeps going up and up, some 
people keep holding out for yet higher prices and refuse to sell.
The Hunt brothers famously bankrupted themselves trying to 
corner the silver market in 1979: 
“Brothers Nelson Bunker Hunt and Herbert Hunt attempted to 
corner the world silver markets in the late 1970s and early 1980s, 
at one stage holding the rights to more than half of the world’s 
deliverable silver.[1] During Hunt’s accumulation of the precious 
metal silver prices rose from $11 an ounce in September 1979 to 
nearly $50 an ounce in January 1980.[2] Silver prices ultimately 
collapsed to below $11 an ounce two months later,[2] much of the 
fall on a single day now known as Silver Thursday, due to changes 
made to exchange rules regarding the purchase of commodities on 
margin.[3]”
http://en.wikipedia.org/wiki/Cornering_the_market

177
46
O
n Scal
ab
i
lit
y an
d 
Li
ghtweight Cli
ents
A
S TIME P
ASSES
, the block chain, which co
ntains a r
ecord o
f 
all transactions made since J
anuary 2009, grows co
ntinuo
usly
. 
Giv
en a Bitcoin wallet co
ntaining several Bit
coin addresses 
along wi
t
h their correspo
nding priva
te keys and bi
tcoin balances, Bi
t
-
coin m
ust know which addr
ess or addresses sho
uld b
e used to cover a 
transaction. F
or exam
ple, assume tha
t Bitco
in address A has 0.1 BT
C, 
B has 0.2 BT
C, and C has 0.3 BT
C and that a pa
yment of 0.5 B
TC is 
to be made. e Bi
tcoin wallet will have to p
ick a comb
ination o
f 2 or 
mor
e Bitco
in addresses with which to cov
er the 0.5 BTC as non
e of 
them individually has s
ucient bi
tcoins to mak
e t
he entir
e payment. 
U
n
less a Bi
tcoin clien
t has the fu
ll block chain a
nd s
o is able t
o k
now 
the current balance o
f each address, it m
ust in
terface w
ith a ser
ver 
that does ha
ve the block chain. e S
implied P
aymen
t V
erication
, 

THE BOOK O
F SA
TOSHI
178
rst described in Satoshi
’
s original Bitco
in paper
, allows clients t
o rely 
on a ser
ver participa
t
ing in the Bi
tcoin netwo
rk t
ha
t has the fu
ll block 
chain b
ut may o
r may no
t b
e participating in the minin
g process. I
t 
was im
plemented la
ter and benets ligh
tweight clien
ts.
Re: Scalab
ility 
Satoshi Nakamoto July 14, 2010, 09:10:52 PM
Quote from: jib on July 12, 2010, 11:36:17 AM
Am I correct in understanding that ever
y node receives 
information about ever
y transaction (as the technical paper 
says)? Doesn’t that make bitcoin completely impractical for 
use as a currency on a large scale?
The design outlines a lightweight client that does not need 
the full block chain. In the design PDF it’s called Simpliﬁed 
Payment Veriﬁcation. The lightweight client can send and receive 
transactions, it just can’t generate blocks. It does not need to trust 
a node to verify payments, it can still verify them itself. 
The lightweight client is not implemented yet, but the plan is to 
implement it when it’s needed. For now, everyone just runs a full 
network node. 
I anticipate there will never be more than 100K nodes, probably 
less. It will reach an equilibrium where it’s not worth it for more 
nodes to join in. The rest will be lightweight clients, which could be 
millions.
At equilibrium size, many nodes will be server farms with one or 
two network nodes that feed the rest of the farm over a LAN.

179
47
O
n F
a
st T
r
ansacti
o
n 
P
r
o
b
lems
H
ERE, 
Sa
toshi explain
s t
hat a pa
yment p
rocessing com
pany 
would mo
nitor the B
itcoin netw
ork for the tran
sac
tion of 
int
erest to the mer
chant, a
s well as an
y other conicting 
transactions. Sin
ce nodes w
ill only accept the r
st transactions and 
will reject any o
ther t
ransactions which co
nict w
ith those, the mer
-
chan
t
’
s transaction should be seen rst. I
f any co
nic
ting transactions 
ar
e s
een by the paymen
t processin
g compan
y
, it will inform the mer
-
chan
t that the tran
s
action is bad. Of course, if the co
r
rect transaction 
is ocially accept
ed, the merchan
t can reim
burse the client o
r process 
the sale.

THE BOOK O
F SA
TOSHI
180
Re: Bit
coi
n snack machi
ne  
(f
ast tr
ansactio
n prob
lems) 
Satoshi Nakamoto July 17, 2010, 10:29:13 PM
Quote from: Insti, July 17, 2010, 02:33:41 AM
How would a Bitcoin snack machine work?
 
 
1. 
 
Y
ou want to walk up to the machine. Send it a bitcoin.
 
2. ?
 
 
3. 
 
W
alk away eating your nice sugar
y snack. (Proﬁt!)
Y
ou don’t want to have to wait an hour for you transaction to 
be conﬁrmed. 
The vending machine company doesn’t want to give away lots 
of free candy
.
How does step 2 work?
I believe it’ll be possible for a payment processing company to 
provide as a service the rapid distribution of transactions with 
good-enough checking in something like 10 seconds or less.
The network nodes only accept the ﬁrst version of a transaction 
they receive to incorporate into the block they’re trying to 
generate.  When you broadcast a transaction, if someone else 
broadcasts a double-spend at the same time, it’s a race to 
propagate to the most nodes ﬁrst.  If one has a slight head start, 
it’ll geometrically spread through the network faster and get most 
of the nodes.
A rough back-of-the-envelope example:
 
 
1 
 
0
 
 
4 
 
 1
 
 
16 
 
4
 
 
64 
 
16
 
 
80% 
 
20%

O
n Fast Transactio
n Prob
lems
181
So if a double-spend has to wait even a second, it has a huge 
disadvantage.
The payment processor has connections with many nodes.  When 
it gets a transaction, it blasts it out, and at the same time monitors 
the network for double-spends.  If it receives a double-spend on 
any of its many listening nodes, then it alerts that the transaction 
is bad.  A double-spent transaction wouldn’t get very far without 
one of the listeners hearing it.  The double-spender would have 
to wait until the listening phase is over, but by then, the payment 
processor’s broadcast has reached most nodes, or is so far ahead 
in propagating that the double-spender has no hope of grabbing a 
signiﬁcant percentage of the remaining nodes.
Another la
ter thread revisited the scalabili
t
y and tran
s
action rat
e. 
Sat
oshi points back to the thr
e
ad above
.
Re: Scalab
ility and transactio
n ra
te 
Satoshi Nakamoto July 29, 2010, 02:00:38 AM
Quote from: Red, July 22, 2010, 05:17:28 AM
I’m curious about the developers feelings on scalability
. For 
example, could the system handle a million users, doing say 
5 transactions each per day
. 5 million transactions per day is 
roughly 35,000 transactions per 10 minute period? 
Is there a bottle neck in propagating 35,000 transactions to 
a million nodes for block generation? Or has that issue been 
designed for?
The current system where every user is a network node is not the 
intended conﬁguration for large scale. That would be like every 
Usenet user runs their own NNTP server. The design supports 
letting users just be users. The more burden it is to run a node, 

THE BOOK O
F SA
TOSHI
182
the fewer nodes there will be. Those few nodes will be big server 
farms. The rest will be client nodes that only do transactions and 
don’t generate.
Quote from: bytemaster on July 28, 2010, 08:59:42 PM
Besides, 10 minutes is too long to verify that payment is good. 
It needs to be as fast as swiping a credit card is today
.
See the snack machine thread, I outline how a payment processor 
could verify payments well enough, actually really well (much 
lower fraud rate than credit cards), in something like 10 seconds or 
less. If you don’t believe me or don’t get it, I don’t have time to try 
to convince you, sorry. 
http://bitcointalk.org/index.php?topic=423.msg3819#msg3819

183
 
48
Wi
ki
ped
ia Ar
ticle 
Entr
y o
n B
it
co
i
n
W
E CANNOT
 IMAGINE 
tha
t W
ikipedi
a would co
nsider 
deleting the en
t
r
y on Bi
tcoin with its curren
t level of 
int
erest. A
t t
he time of this post, Bi
tcoin was still under 
$1, bu
t was generating s
ucient int
erest to ju
stif
y an article in W
iki
-
pedia. Satoshi co
mments her
e t
hat 
he considers the timing stran
ge, as 
cov
erage of Bi
tcoin was ra
pidly increasing in the m
e
dia.
Re: T
he
y w
ant to d
elete  
th
e Wiki
pedia ar
ticle 
Satoshi Nakamoto July 20, 2010, 06:38:28 PM
Quote from: Giulio Prisco July 14, 2010, 07:21:08 AM

THE BOOK O
F SA
TOSHI
184
http://en.wikipedia.org/wiki/Bitcoin
This article is being considered for deletion in accordance 
with Wikipedia’
s deletion policy
. 
Please share your thoughts on the matter at this article’
s entr
y 
on the Articles for deletion page.
This article needs references that appear in reliable third-par
ty 
publications. Primar
y sources or sources afﬁliated with the 
subject are generally not sufﬁcient for a Wikipedia article. 
Please add more appropriate citations from reliable sources.
The recent Slashdot article should be considered as a reliable 
reference: 
http://news.slashdot.org/stor
y/10/07/11/1747245/
Bitcoin-Releases-V
ersion-03
I cannot edit at this moment, can you guys save the WP 
artcile?
Bitcoin is an implementation of Wei Dai’s b-money proposal http://
weidai.com/bmoney.txt on Cypherpunks http://en.wikipedia.org/
wiki/Cypherpunks in 1998 and Nick Szabo’s Bitgold proposal 
http://unenumerated.blogspot.com/2005/12/bit-gold.html
The timing is strange, just as we are getting a rapid increase in 3rd 
party coverage after getting slashdotted.  I hope there’s not a big 
hurry to wrap the discussion and decide.  How long does Wikipedia 
typically leave a question like that open for comment?
It would help to condense the article and make it less promotional 
sounding as soon as possible.  Just letting people know what it is, 
where it ﬁts into the electronic money space, not trying to convince 
them that it’s good.  They probably want something that just 
generally identiﬁes what it is, not tries to explain all about how it 
works.
If you post in http://en.wikipedia.org/wiki/Wikipedia:Articles_
for_deletion/Bitcoin please don’t say “yeah, but bitcoin is really 

Wiki
pedia Ar
ticle Entry o
n Bitc
oin
185
important and special so the rules shouldn’t apply” or argue 
that the rule is dumb or unfair.  That only makes it worse.  Try to 
address how the rule is satisﬁed.
Search “bitcoin” on google and see if you can ﬁnd more big 
references in addition to the infoworld and slashdot ones.  There 
may be very recent stuff being written by reporters who heard 
about it from the slashdot article.
I hope it doesn’t get deleted.  If it does, it’ll be hard to overcome 
the presumption. Institutional momentum is to stick with the last 
decision. (edit: or at least I assume so, that’s how the world usually 
works, but maybe Wiki is different)
And la
ter
, on J
uly 31
st
, the article was ocially deleted, a
nd then 
later restored.
Re: BitC
oi
n Wi
kiped
ia p
age DELETED!!! 
Posted by em3rgentOrdr
, July 31, 2010, 02:17:41 AM 
from http://en.wikipedia.org/wiki/Bitcoin
“This page has been deleted. The deletion and move log for 
the page are provided below for reference.
10:42, 30 July 2010 Polargeo (talk | contribs) deleted 
“Bitcoin” 

 (Wikipedia:Articles for deletion/Bitcoin)”
Re: BitC
oi
n Wi
kiped
ia p
age DELETED!!! 
Posted by sirius, September 30, 2010, 04:45:26 PM 
Can we just make different language versions of a deleted 

THE BOOK O
F SA
TOSHI
186
page without getting them removed? Let’
s do it if we can. I 
can write a version in Finnish.
Re: BitC
oi
n Wi
kiped
ia p
age DELETED!!! 
Posted by satoshi, September 30, 2010, 05:50:32 PM 
If you do, I think it should be a very brief, single paragraph article 
like 100 words or less that simply identiﬁes what Bitcoin is.
I wish rather than deleting the article, they put a length restriction. 
If something is not famous enough, there could at least be a stub 
article identifying what it is. I often come across annoying red links 
of things that Wiki ought to at least have heard of.
The article could be as simple as something like:
“Bitcoin 
is a 
peer-to-peer decentralised 
/link/electronic currency/link/.”
The more standard Wiki thing to do is that we should have a 
paragraph in one of the more general categories that we are an 
instance of, like Electronic Currency or Electronic Cash. We can 
probably establish a paragraph there. Again, keep it short. Just 
identifying what it is.
Re: BitC
oi
n Wi
kiped
ia p
age DELETED!!! 
Posted by ribuck, December 13, 2010, 11:23:41 AM 
It looks like the article will be restored. But one point that 
keeps being raised is that many of the article’
s references 
are to pages in this forum. If anyone can replace a forum 
reference with a reference to a page that has no perceived 
conﬂict of interest, that would help. 

187
49
O
n th
e Poss
i
b
i
lit
y  
o
f Steali
n
g Co
i
ns
A
S ST
A
TED BEFORE, 
Bi
tcoin uses asymmetric cr
yptograp
hy 
with a pub
lic and priva
te key pair as a mechanism t
o receive 
and a
uthorize spending o
f bitco
ins. Ho
wever
, Satoshi decided 
to use as the Bi
tcoin address
 the hash
 of the pub
lic key rather than the 
pub
lic key itself. Satos
hi did t
his fo
r t
wo reaso
ns. One was to reduce 
the size of each tran
s
action as the hash is o
n
ly 160 bi
ts long. e sec
-
ond bene
t was that it co
nvenien
tly added one mor
e layer o
f s
ecurity 
in case a “backdoor” o
r s
ecurity aw sho
u
ld one da
y be dis
cover
ed in 
the asymmetric cr
yptograp
hy algori
t
hm used by Bi
tcoin. T
o b
e able to 
spend bi
tcoins, a hack
er would hav
e to rst derive the p
ublic key from 
the hash and then deriv
e the privat
e key f
rom the p
ublic key
. 
Bitcoin 
M
agazin
e
 wrote an ex
cellent article on this su
bjec
t.
2
is whole thread discusses the possibility tha
t an at
t
acker with a 
lot o
f comp
uting power co
u
ld spend the bit
coins sto
red in a bit
coin 
2
   htt
p://bitcoinmagazin
e.com/7781/satoshis-geni
us-unexpec
ted-ways-in-which-bi
tcoin-dodged-
some-cryptographic-bullet/

THE BOOK O
F SA
TOSHI
188
address. S
ince the bitco
in block chain is a
n open le
dger
, it can be 
inspected in order t
o identify a bitco
in address havin
g a large balance, 
and so an a
ttacker co
u
ld focus on those addresses.
Sat
oshi concl
ude
d that this wo
uld b
e quit
e dic
ult, as it w
ould 
requir
e a brute fo
rce a
ttack to nd a pub
lic key with a matchin
g hash
. 
I
t also shows the value o
f open source code (code that is open fo
r all to 
see) for security
, as opposed to closed s
ource
.
e im
p
ortant pa
r
ts of the threads, incl
uding Sat
oshi’
s entire post
-
ing, ar
e repr
o
duced here:
Steali
ng Co
ins
Posted by Red, July 25, 2010, 05:08:03 PM
I think there is a pretty signiﬁcant cr
ypto ﬂaw in Bitcoin as 
currently implemented. I’m not sure it is exploitable now (I’m 
not a real cr
yptohacker) but it is more than plausible that will 
be in the near future.
The ﬂaw would enable anonymous stealing of coins from 
arbitrar
y bitcoin addresses. And no it doesn’t involve solving 
any of the hard problems that keep existing cr
ypto systems 
secure. It is simply a *potential* correctable logic ﬂaw in the 
implementation.
I would like bitcoins to succeed, so I’d rather not jump up 
and down in public yelling about ﬂaws in public. Is there an 
appropriate place to discuss these types of issues?

O
n the Possi
bility of Steali
ng Co
ins 
189
Re: Steali
ng Co
ins
Posted by Satoshi, July 25, 2010, 05:45:22 PM 
It’s best if you tell it to me privately so it can be ﬁxed ﬁrst.
I just e-mailed you my e-mail address. (or you could PM me here)
Re: Steali
ng Co
ins
Posted by Satoshi, July 25, 2010, 07:06:23 PM 
Red, thanks for telling me privately ﬁrst! Please go ahead and post 
it (and relieve the suspense for everyone!)
His point is that transactions paid to a Bitcoin Address are only as 
secure as the hash function. To make Bitcoin Addresses short, they 
are a hash of the public key, not the public key itself. An attacker 
would only have to break the hash function, not ECDSA.
Re: Steali
ng Co
ins
Posted by Red, July 25, 2010, 07:09:43 PM
Thanks Satoshi,
Here is what I sent him.
-----------
Public key cr
yptography depends on the fact that it is hard to 
factor large prime numbers. Ever
yone knows that. If bitcoins 
were transfers were assigned to a well formed public key
, and 
an associated private key signature was required for future 

THE BOOK O
F SA
TOSHI
190
transfer I would concede that bitcoins cr
ypto transfers were 
completely secure.
However
, bitcoin transactions don’t seem to work that way (by 
my reading). T
ransactions assign coin amounts to a par
ticular 
“bitcoin address”. Where the address is a hash of the public 
key
.
T
o validate a transaction, nodes take the public key from the 
signature and use that to verify the actual signature. If the 
signature is valid, it then hashes the public key to conﬁrm 
it matches the bitcoin address assigned in the previous 
transaction. If both match, by deﬁnition, the transaction is 
good.
The potential weakness is in associating the public key in the 
signature with the bitcoin address.
There is a many to one relationship between public keys and 
a given hash. Now
, if ﬁnding a pair of prime numbers that 
creates a secure public/private key pair where the public key 
part hashes to a par
ticular bitcoin address seems hard... it 
probably is.
However
, that is not required.
All you need is ANYTHING representing a public key that 
hash collides with a know large bitcoin account. It does NOT 
have to be a secure key pair based on primes. It is simply has 
to work once and allow the transfer of the stolen money to 
another account. That is potentially much easier
.
Some hashes are harder to collide than others. I’m not sure 
the strength of the hash being used. However
, colliding any 
hash gets much easier if you don’t have to care about the 
content being hashed.
Because of the nature of public keys they look like random 
data. As I understand them, you can’t know if a public key is 

O
n the Possi
bility of Steali
ng Co
ins 
191
based upon secure math unless you succeed in factoring it. 
Therefore clients don’t try
. They normally just do the validation 
of the signature and presume the public key was generated in 
a secure fashion if it worked.
NOTE: The following analysis needs double checking by a 
real cr
yptohacker
. IANACR
So depending on the hash, you could use one of the up-and-
coming hash collision algorithms to generate a colliding block 
of data which represents a public key
. Then by reversing the 
public/private key math, generate an associated (but hardly 
secure at all) private key that would generate valid signatures.
Y
ou then take your insecure, easily factorable, key pair and 
generate a signed transaction that matches the target bitcoin 
address.
Since the transaction log, can’t validate the full public key the 
coins were intended for
, it simple presumes it must have been 
the one presented.
By recording the full public key of the transfer target in the 
block list you can regain the intended strength. However
, you 
lose the ability to pass around 34 character addresses.
If I’m off base, I apologize for wasting your time.
Cheers! 
Red
Re: Steali
ng Co
ins
Posted by Red, July 25, 2010, 07:22:14 PM
Satoshi pointed out that my scenario still required the hash 
function to be broken. That is true, but I was surprised to learn 

THE BOOK O
F SA
TOSHI
192
how successful some have been with that. MD4 and MD5 
are obvious examples. But work is well under
way at colliding 
SHA-1 and siblings like SHA-256.
What hash is being used in this part of Bitcoin?
He is also skeptical that you could you could use something 
other than a generated keypair
.
On this point, I’m pretty conﬁdent that it is a simple matter 
of mathematics. I didn’t pay enough attention to this until I 
learned about “blind signing” of documents.
It turns out you can take a document and multiply it by 
a random number
. Then have someone sign the jumbled 
ﬁle. Finally
, you divide your random number out of their 
signature and the result is still a valid signature for the original 
document. Who’d ﬁgured that would work!
Anyway
, if keypairs are only secure if they are based upon 
pairs of primes. Then nothing changes any of the math if the 
numbers are not prime. They are just much easier to factor
.
I’d be perfectly happy for some cr
ypto guy to prove me an 
idiot. It effects some features of a previous project I created 
that relied on the same association. I didn’t think of this then 
either
.
Re: Steali
ng Co
ins
Posted by knightmb, July 25, 2010, 07:34:42 PM
V
er
y nice. *another reason why I love open source*
As I understand it then, and please correct me if I’m wrong
Since the hash of the public key is smaller than the actual 

O
n the Possi
bility of Steali
ng Co
ins 
193
public key itself, one need only ﬁnd a collision that matches 
the hash and when that collision is found you’ll know the 
public/private key combo. Then you simply spend coin using 
the known ones and the other clients will think it’
s a valid 
transfer because the clients are only concerned that your hash 
matches the hash of the victim and the transaction is recorded 
for all time.
Currently the hash is 35 characters long, alpha-numeric 
26 (upper case) +26 (lower case) +10 (numbers) = 62 
possible per character
So we have 541,638,008,296,341,754,635,824,011,3
76,225,346,986,572,413,939,634,062,667,808,768 
possible combinations.
So I think we have about half of much work to do compared 
to going brute force against the main private/public key
. 
Never hurts to plan for the future : - )
Re: Steali
ng Co
ins
Posted by knightmb, July 25, 2010, 07:44:02 PM
Quote from: Red on July 25, 2010, 07:22:14 PM
Satoshi pointed out that my scenario still required the hash 
function to be broken. That is true, but I was surprised to learn 
how successful some have been with that. MD4 and MD5 are 
obvious examples. But work is well under
way at colliding SHA-1 
and siblings like SHA-256.
What they often don’t mention though is *collision 
generating* still takes a lot of CPU time.
If I ﬁgure out that Public Key 123456 generates Hash ABCD 

THE BOOK O
F SA
TOSHI
194
and Public Key 654321 also generates Hash ABCD
I’m still left without the Private Key
.
But from what you are saying, all I need is Public Key 
654321 and I can spend coin pretending to be Public Key 
123456.
Re: Steali
ng Co
ins
Posted by Red, July 25, 2010, 07:52:23 PM
From what I was told, bitcoin is using one of the 160 bit 
hashes for generating bitcoin address.
The SHA-1 family of hash algorithms are some of the most 
commonly used. SHA-1 is a 160 bit hash.
Here is a paper that claims to ﬁnd SHA-1 collisions in 2^52 
cr
ypto operations. And optimally secure hash would take 
2^80 operations. 2^52 time is still large, but it is getting into 
cluster and botnet range.
http://www
.ictlex.net/wp-content/iacrhash.pdf
The MD5 hashes can already be crashed in seconds on 
laptops. That was why it was retired from certiﬁcate based 
signatures.
And yes what I’m saying is **I think** you can think of a 
public key as two secret numbers mathematically combined 
together
. And the private key as those two numbers kept 
separately
. The thing that make the system secure requires that 
the two secret numbers be really large prime numbers.
But if they are really large non-prime numbers the combination 
math still works, it is just must faster to break the algorithm.

O
n the Possi
bility of Steali
ng Co
ins 
195
I’ll do a little more googling and see if I can substantiate my 
claims. I was hoping someone could dismiss them out of hand 
though.
Re: Steali
ng Co
ins
Posted by Satoshi, July 25, 2010, 08:01:40 PM
Quote from: knightmb on July 25, 2010, 07:44:02 PM
If I ﬁgure out that Public Key 123456 generates Hash ABCD 
and 
Public Key 654321 also generates Hash ABCD
I’m still left without the Private Key
.
But from what you are saying, all I need is Public Key 
654321 and I can spend coin pretending to be Public Key 
123456.
Y
ou would still have to sign it with public key 654321.  Y
ou need to 
ﬁnd a collision using a public key for which you know the private 
key. 
 
When you claim a Bitcoin Address transaction, you give your public 
key that matches the hash, then you must sign it with that key. 
 
Red’s point is that it’s easy to quickly generate insecure public keys 
which you could break and ﬁnd the private key after you ﬁnd a 
collision. 
 
He points out that if the public key was required to be a secure 
one, one which must have required signiﬁcant work to ﬁnd the 
prime numbers, that would increase the strength above that of the 
hash function alone.  Someone trying to brute force would have to 
take time generating a key for each attempt.

THE BOOK O
F SA
TOSHI
196
Re: Steali
ng Co
ins
Posted by knightmb, July 25, 2010, 08:20:41 PM
Quote from: satoshi on July 25, 2010, 08:01:40 PM
Y
ou would still have to sign it with public key 654321.  Y
ou need 
to ﬁnd a collision using a public key for which you know the 
private key
.
When you claim a Bitcoin Address transaction, you give your 
public key that matches the hash, then you must sign it with that 
key
.
Red’
s point is that it’
s easy to quickly generate insecure public keys 
which you could break and ﬁnd the private key after you ﬁnd a 
collision.
He points out that if the public key was required to be a secure 
one, one which must have required signiﬁcant work to ﬁnd the 
prime numbers, that would increase the strength above that of the 
hash function alone.  Someone tr
ying to brute force would have to 
take time generating a key for each attempt.
Y
eah, I thought the private key had to be in the mix 
somewhere. It kind of adds another randomness though, you 
have to ﬁnd the hash that collides with another public key 
and at the same time, the private key has to be weak enough 
to break. I’m not saying it’
s impossible, but it introduces 2 
variables into the reverse collision ﬁnding.
Basically
, one would build a rainbow table of weak private 
keys and then have to compare those to public hashes and 
then have to hope that someone out there has a hash that 
happens to be a part of that attack. Not impossible of course, 
but how feasible even if computers were 100 times faster in 
10 years?
[edit] ok, re-read what you wrote, the public key is generated 

O
n the Possi
bility of Steali
ng Co
ins 
197
from the private key
, not independently
. So just ﬁnding a weak 
public key is the issue.
Re: Steali
ng Co
ins
Posted by satoshi, July 25, 2010, 08:48:01 PM
Quote
Here is a paper that claims to ﬁnd SHA-1 collisions in 2^52 
cr
ypto operations. And optimally secure hash would take 
2^80 operations. 2^52 time is still large, but it is getting into 
cluster and botnet range.
2^80 is if you can use a birthday attack.  Y
ou can’t use a birthday 
attack for this, so the difﬁculty is the full 2^160 bits. Although, if 
you were trying to crack any one of 1 million (2^20) transactions, 
you could do a partial birthday attack 2^160/2^20 = 2^140
Bitcoin Addresses are the only place where 160-bit hash is 
used.  Everything else is SHA-256.  They’re calculated as:
bitcoinaddress = RIPEMD-160(SHA-256(publickey))
Correct me if I’m wrong (please, and I’ll gladly eat crow) but I think 
it would be hard to use an analytical attack on RIPEMD-160 in this 
case.  An analytical attack prescribes a certain range or pattern 
of inputs to try that will greatly increase your chance of ﬁnding a 
collision.  Here, you don’t have that kind of control over RIPEMD-
160’s input, because the input is the output of SHA-256.  If an 
analytical attack helps you ﬁnd an input to RIPEMD-160 that 
produces a collision, what are you going to do with it?  Y
ou still 
have to get SHA-256 to output that value, so you would still have 
to break SHA-256 too.
For brute force, RIPEMD-160(SHA-256(x)) is no stronger than 

THE BOOK O
F SA
TOSHI
198
RIPEMD-160 alone.  But for analytical attack, it seems like you 
must analytical attack both RIPEMD-160 and SHA-256.  If I’m 
wrong, then the strength is the same as RIPEMD-160 and the SHA-
256 only serves as one round of key strengthening.
Re: Steali
ng Co
ins
Posted by Red, July 25, 2010, 09:04:01 PM
Quote from: satoshi on July 25, 2010, 08:48:01 PM
bitcoinaddress = RIPEMD-160(SHA-256(publickey))
Correct me if I’m wrong (please, and I’ll gladly eat crow) but I 
think it would be hard to use an analytical attack on RIPEMD-160 
in this case.
I think you are correct on the analytical attack. At least a far 
as I understand (minimally) the mathematical genius that is 
analyzing them.
I was worried it was the simpler:
bitcoinaddress = RIPEMD-160(publickey)
Re: Steali
ng Co
ins
Posted by Red, July 25, 2010, 09:19:11 PM
So the way I read it.
Given two numbers p and q. Which for RSA are supposed to 
be large primes.
Then n = p*q

O
n the Possi
bility of Steali
ng Co
ins 
199
The public key is the two ﬁelds (n, e). e is called the public 
exponent and appears to be chosen from a set of common 
values.
The private key is also two ﬁelds (n, d). d is called the private 
exponent it it is derived by knowing e, p-1, and q-1.
The trick is, it is really hard to factor n into p & q. Therefore it 
is equally as hard to ﬁnd p-1 and q-1
My postulation is that if n is arbitrar
y
, and e is one of the 
common values, then there are lots of different p, q pairs that 
would work. The less prime the numbers the easier to ﬁnd 
p and q, and therefore p-1 and q-1. And if you have a big 
block of arbitrar
y data that give you lots of ﬂexibility in tr
ying 
to collide a hash.
(That is the point where I could be totally off base though. 
Really interested, if a cr
ypto geek knows better than me.)
I did read that the key generation algorithms create p and q 
such that they are “ver
y likely prime” but it is too much work 
to know for sure. This leads me to believe non-primes don’t 
cause any obvious F
AILs. I could be wrong though.
Re: Steali
ng Co
ins
Posted by satoshi, July 25, 2010, 10:27:36 PM
Sorry, actually it’s ECDSA (Elliptic Curve Digital Signature 
Algorithm) not RSA. I shouldn’t have said “prime numbers”. ECDSA 
doesn’t take much time to generate a keypair.

THE BOOK O
F SA
TOSHI
200
Re: Steali
ng Co
ins
Posted by Red, July 26, 2010, 12:46:04 PM
Quote from: satoshi on July 25, 2010, 10:27:36 PM
Sorr
y
, actually it’
s ECDSA (Elliptic Cur
ve Digital Signature 
Algorithm) not RSA. I shouldn’t have said “prime numbers”. 
ECDSA doesn’t take much time to generate a keypair
.
I’ll learn how elliptic cur
ves work one day
, but not today
. I should 
have taken more ﬁnite math when I was I college. Who’d a 
thought it would have come in handy for anything!
By the way
, nice idea and implementation of BitCoin Satoshi!
It opens a whole new world of possibilities. I particularly like the 
concept of distributed agreement without relying upon trust. I think 
that is the breakthrough concept.
Also, I think the idea of BitCoin mining was brilliant! I doubt you 
could have gotten the network bootstrapped any other way
. I 
disagree that it’
s a “fair way” to distribute coins, but hey the world 
is not fair! And really
, I don’t think any other way would have 
generated as much user excitement.
By the way
, I concede that there is no thread of stealing bitcoins 
from my earlier postulation. The double hash seems to assure that 
from my perspective. Nice call!
Incidentally
, I’d still like to know what happens if you generate 
RSA keys based upon non-prime numbers though. I ﬁgure there 
are other systems out there that didn’t double hash. :-)
Re: Steali
ng Co
ins

O
n the Possi
bility of Steali
ng Co
ins 
201
Posted by Bitcoiner
, July 27, 2010, 02:01:16 AM
I’m glad that there’
s guys like Red out there keeping a sharp 
eye out on things! This thread also makes me appreciative 
of open source software, since there’
s so many smart and 
interested people on this forums that can validate the software 
and place an additional degree of trust in it. Not sure that 
Bitcoin could be too successful if it was closed source!
Re: Steali
ng Co
ins
Posted by bytemaster
, July 28, 2010, 09:42:17 PM
It would seem to me that the obvious solution to minimize the 
risk of any potential attack is to make the potential “reward” 
small.  Thus never keep too many coins in one address. If the 
economic value of the “prize” is less than the cost of breaking 
it then no one will bother tr
ying. After saying that, I still think 
that it is best to keep things as hard as possible to crack.
Re: Steali
ng Co
ins
Posted by knightmb, July 28, 2010, 10:45:16 PM
It would certainly be hard by both luck and CPU/storage 
power to do this.
If you found a collision and a private key
, that would do you 
no good since you would have to peg an account out of the 
541,638,008,296,341,754,635,824,011,376,225,3
46,986,572,413,939,634,062,667,808,768 possible 
combinations of people using accounts.

THE BOOK O
F SA
TOSHI
202
So look at it two-fold. I ﬁnd a collision in the hash and I 
ﬁnd the private key
. Now I have to hope my odds are that 
someone else is using that hash. Since there are more possible 
hash account numbers than ever
y person ever
y born on this 
planet and was each using a million addresses, the attack by 
it’
s own nature, while interesting, just isn’t really feasible on a 
large scale.

203
50
M
ajo
r Fl
a
w 
D
isco
vered
A
 
MAJOR FLA
W 
was discov
ered in the Bitco
in soware/p
ro
-
tocol that allo
wed a sender to send invalid transactions, o
ne 
where the sender crea
tes new bitco
ins. By the time it was 
xed, several millions of in
valid bit
coins had been creat
e
d. ey wer
e 
lat
er eras
ed from the block cha
in.
*** ALER
T *** U
pgrade to 0.3.6
Posted by satoshi, July 29, 2010, 07:13:06 PM
Please upgrade to 0.3.6 ASAP!  We ﬁxed an implementation bug 
where it was possible that bogus transactions could be displayed as 
accepted.  Do not accept Bitcoin transactions as payment until you 

THE BOOK O
F SA
TOSHI
204
upgrade to version 0.3.6!
If you can’t upgrade to 0.3.6 right away, it’s best to shut down 
your Bitcoin node until you do.
Also in 0.3.6, faster hashing:
• 
 
midstate cache optimisation thanks to tcatm
• 
 
Crypto++ ASM SHA-256 thanks to BlackEye
Total generating speedup 2.4x faster.
Download: 
http://sourceforge.net/projects/bitcoin/ﬁles/Bitcoin/bitcoin-0.3.6/
Windows and Linux users: if you got 0.3.5 you still need to 
upgrade to 0.3.6.

205
51
O
n Fl
oo
d A
tt
ack 
P
re
ventio
n
T
HE CONCERN RAIS
ED HERE 
is the equivalen
t of a denial of 
ser
vice attack o
n t
he Bit
coin networ
k w
here o
ne entity co
u
ld 
send millions of tra
nsac
tions, each tran
sferring a small amoun
t,
 
1 satos
hi (0.00000001 BTC) fo
r instance. is thr
e
ad is mor
e technical
 
than some o
t
hers, an
d not all of the posts have been reco
pied here
 
on
ly
 
those relevan
t to the topic a
nd those about concerns addr
essed by Sat
oshi.
Fl
ood a
tt
ack 0.00000001 BC
Posted by Mionione, July 12, 2010, 12:04:24 PM
hi, what would happen if someone sends millions of 
0.00000001 BC to millions of address please ? 

THE BOOK O
F SA
TOSHI
206
=> all of the networks peers must store all transactions ? 
=> are each 0.00000001 owner/hash stocked in blocks on 
all peers?
i don’t really understand how bitcoin handle fractions of bc
Re: Fl
ood a
tt
ack 0.00000001 BC
Posted by Gavin Andresen, July 12, 2010, 12:08:45 PM
From the source code:
main.h:  // T
o limit dust spam, require a 0.01 fee if any 
output is less than 0.01
Re: Fl
ood a
tt
ack 0.00000001 BC
Posted by llama, July 12, 2010, 02:23:46 PM
Hmm, I didn’t realize that was in there, and I really don’
t like 
that approach.
That pretty much ruins the possibility of using bitcoin for 
true micropayments. W
ouldn’t it be better for clients to just 
ignore a spammy IP? Sure an attacker could get more, but he 
couldn’t get millions.
Re: Fl
ood a
tt
ack 0.00000001 BC
Posted by Gavin Andresen, July 12, 2010, 02:45:54 PM

O
n Flood A
ttack P
re
vention
207
But how would you distinguish between a legitimate 
micropayment-processing IP and a spammy “I want to make 
Bitcoin use so much bandwidth nobody is willing to run it any 
more” IP?
Really small micropayments seem to me to be a really hard 
problem, and I don’t think Bitcoin should try to solve too many 
ver
y hard problems all at once.
Re: Fl
ood a
tt
ack 0.00000001 BC
Posted by Gavin Andresen, July 12, 2010, 02:45:54 PM
But how would you distinguish between a legitimate 
micropayment-processing IP and a spammy “I want to make 
Bitcoin use so much bandwidth nobody is willing to run it any 
more” IP?
Re: Fl
ood a
tt
ack 0.00000001 BC
Posted by Insti, August 04, 2010, 02:58:31 PM
What exactly is this ‘dust spam’ that this 0.01BTC transaction 
fee “solving”? 
It seems to do more harm than good because it prevents 
micropayment implementations such as the one bytemaster is 
suggesting.
I’m not aware that the network is straining under the weight of 
the existing transaction volume. 
Anyone wishing to send a lot of transactions can already do 
this by sending x BTC to themselves a lot.

THE BOOK O
F SA
TOSHI
208
Re: Fl
ood a
tt
ack 0.00000001 BC
Posted by satoshi, August 04, 2010, 04:25:36 PM
Quote from: Insti on August 04, 2010, 02:58:31 PM
It seems to do more harm than good because it prevents 
micropayment implementations such as the one bytemaster is 
suggesting.
Bitcoin isn’t currently practical for very small micropayments.  Not 
for things like pay per search or per page view without an 
aggregating mechanism, not things needing to pay less than 
0.01.  The dust spam limit is a ﬁrst try at intentionally trying to 
prevent overly small micropayments like that.
Bitcoin is practical for smaller transactions than are practical with 
existing payment methods.  Small enough to include what you 
might call the top of the micropayment range.  But it doesn’t claim 
to be practical for arbitrarily small micropayments.
Re: Fl
ood a
tt
ack 0.00000001 BC
Posted by satoshi, August 05, 2010, 04:03:21 PM
Forgot to add the good part about micropayments.  While I don’t 
think Bitcoin is practical for smaller micropayments right now, 
it will eventually be as storage and bandwidth costs continue to 
fall.  If Bitcoin catches on on a big scale, it may already be the 
case by that time.  Another way they can become more practical 
is if I implement client-only mode and the number of network 
nodes consolidates into a smaller number of professional server 
farms.  Whatever size micropayments you need will eventually be 
practical.  I think in 5 or 10 years, the bandwidth and storage will 
seem trivial.

O
n Flood A
ttack P
re
vention
209
I am not claiming that the network is impervious to DoS attack.  I 
think most P2P networks can be DoS attacked in numerous 
ways.  (On a side note, I read that the record companies would like 
to DoS all the ﬁle sharing networks, but they don’t want to break 
the anti-hacking/anti-abuse laws.)
If we started getting DoS attacked with loads of wasted 
transactions back and forth, you would need to start paying a 0.01 
minimum transaction fee.  0.1.5 actually had an option to set that, 
but I took it out to reduce confusion.  Free transactions are nice 
and we can keep it that way if people don’t abuse them.
That brings up the question: if there was a minimum 0.01 fee for 
each transaction, should we automatically add the fee if it’s just 
the minimum 0.01?  It would be awfully annoying to ask each 
time.  If you have 50.00 and send 10.00, the recipient would 
get 10.00 and you’d have 39.99 left.  I think it should just add it 
automatically.  It’s trivial compared to the fees many other types of 
services add automatically.
Quote from: FreeMoney on August 04, 2010, 07:30:32 PM
Does including more slow down your hashing rate?  
No, not at all.
Re: Fl
ood a
tt
ack 0.00000001 BC
Posted by satoshi, August 05, 2010, 04:30:20 PM
Quote from: bytemaster
Payments would generally be advanced, say 1 BTC at a time 
and when the connection closes any “change” would be 
returned.  This rule makes it impossible to pay for a simple 
“search quer
y” with no fur
ther transactions.

THE BOOK O
F SA
TOSHI
210
One alternative is to use a round-up system.  Y
ou pay for, say, 
1000 pages or images or downloads or searches or whatever at a 
time.  When you’ve used up your 1000 pages, you pay for another 
1000 pages.  If you only use 1 page, then you have 999 left that 
you may never use, but it’s not a big deal because the cost per 
1000 is still small.
Or you could pay per day.  The ﬁrst time you access the site on a 
given day, you pay for 24 hours of access.
Per 1000 or per day may be easier for consumers to get their 
heads around too.  They worry about per item because it’s harder 
to ﬁgure if it might add up too fast.  Unlimited for 24 hours they 
know what the cost will be.  Or if 1000 seems like plenty, they’re 
not worrying that it’s costing more with each click if they ﬁgure 
1000 is more than they’ll probably use.
Re: Fl
ood a
tt
ack 0.00000001 BC
Posted by satoshi, August 05, 2010, 04:39:58 PM
Quote from: bytemaster on August 05, 2010, 03:39:19 PM
The only solution to this problem is to make broadcasting of a 
transaction “non free”.  Namely
, if you want me to include it 
you have to pay me.  The net (no pun intended) result is that 
each client would need to pay other clients to whom they even 
send their transaction, not just the individual who gets it in a 
block. In this way the laws of economics take over and no one 
gets a free ride on the transaction broadcast system.  
I don’t know a way to implement that.  The transaction fee to 
the block creator uses a special trick to include the transaction 
fee without any additional size.  If there was a transaction for 
each transaction fee, then what about the transactions fees for 
the transaction fee’
s transaction?

O
n Flood A
ttack P
re
vention
211
Re: Fl
ood a
tt
ack 0.00000001 BC
Posted by satoshi, August 05, 2010, 05:49:43 PM
Quote from: bytemaster on August 05, 2010, 04:46:52 PM
Right now the transaction fee address is left “blank” and the 
block generator ﬁlls it out. 
Now you would ﬁll it in with the address of the person you 
are asking to build the block.  
If you’re only going to have one person work on building the block, 
that could take days. Oh, do you mean send a different variation 
to each node with the tx fee written to them?
The way it is now, it’s whoever builds this gets it.
If we needed to, we could have a BitTorrent-esque tit-for-tat for 
transaction broadcast. Relay paying transactions to me, or I won’t 
relay them to you. It probably won’t be an actual problem though. 
It only takes one node relaying like it should to cancel out 7 others 
greedily not relaying.
Re: Fl
ood a
tt
ack 0.00000001 BC
Posted by satoshi, August 11, 2010, 11:28:50 PM
It would be nice to keep the blk*.dat ﬁles small as long as we can.
The eventual solution will be to not care how big it gets.
But for now, while it’s still small, it’s nice to keep it small so new 
users can get going faster. When I eventually implement client-only 
mode, that won’t matter much anymore.
There’s more work to do on transaction fees. In the event of a 
ﬂood, you would still be able to jump the queue and get your 

THE BOOK O
F SA
TOSHI
212
transactions into the next block by paying a 0.01 transaction fee. 
However, I haven’t had time yet to add that option to the UI.
Scale or not, the test network will react in the same ways, but with 
much less wasted bandwidth and annoyance.

213
52
D
r
ai
nage  
o
f B
it
co
i
n F
aucet
A
S THE V
AL
UE 
of b
itcoin
s increased, the Bitco
in faucet (see 
pr
e
vious ref
erence) was becoming mo
re a
ttract
ive. Ga
vin 
Andresen r
ep
orts that the value 
of a bit
coin has increased by 
a factor o
f 10 since he creat
e
d the Fa
ucet.
Who’
s the Sp
anis
h jerk  
drai
ni
ng th
e F
aucet?
Posted by Gavin Andresen, August 04, 2010, 08:40:55 PM
I just shut down freebitcoins.appspot.com; it looks like 
somebody in Spain is being a jerk and getting a new IP 
address, bitcoin address, and solving the captcha. Over and 

THE BOOK O
F SA
TOSHI
214
over and over again:
Code:
79.154.133.217 - - [04/Aug/2010:12:46:55 -0700] 
“POST / HTTP/1.1” 200 1294 “https://freebitcoins.appspot.
com/” 
“Opera/9.80 (Windows NT 6.0; U; es-LA) Presto/2.6.30 
V
ersion/10.60,gzip(gfe)”
79.146.112.13 - - [04/Aug/2010:12:45:20 -0700] 
“POST / HTTP/1.1” 200 1294 “https://freebitcoins.appspot.
com/” 
“Opera/9.80 (Windows NT 6.0; U; es-LA) Presto/2.6.30 
V
ersion/10.60,gzip(gfe)”
81.44.159.81 - - [04/Aug/2010:12:42:20 -0700] 
“POST / HTTP/1.1” 200 1294 “https://freebitcoins.appspot.
com/” 
“Opera/9.80 (Windows NT 6.0; U; es-LA) Presto/2.6.30 
V
ersion/10.60,gzip(gfe)” 
Those IP addresses all map to T
elefonica de 
Espana. If it was you: give them back, please: 
15VjRaDX9zpbA8L
VnbrCAFzrVzN7ixHNsC
Now that 5 bitcoins is worth a fair bit, I’m thinking I need 
more cheating countermeasures. I can think of four things to 
tr
y:
1. 
 
Rate limit based on the ﬁrst byte of the IP address (79.  
 
 
or 81. in this case).
2.  
Rate limit based on the USER-AGENT string  
 
 
 
 
 
 
(“Opera/9.8 . . .” 
 
in 
 
this 
 
case).
3. 
 
Rate limit based on last two domains of reverse DNS  
 
 
 
 
lookup of the IP address (rima-tde.net in this case).

Drainage o
f Bit
coin F
aucet 
215
4. 
 
Make the standard amount given away 0.5 Bitcoins  
 
 
 
 
(Bitcoins have gone up 10 times in value since I started the  
 Faucet).
If you get rate limited, you’ll get a message that asks you to 
tr
y again tomorrow
.
BitcoinFX: thanks again for the donation to the faucet; I’m 
going to drain the Faucet below 500 coins temporarily
, 
and will reﬁll it with your donation after the new cheating 
countermeasures are in place.
Re: Who’
s the Sp
anis
h jerk drai
ni
ng  
th
e Faucet?
Posted by satoshi, August 04, 2010, 08:40:55 PM
Silently failing would look bad.
Quote from: gavinandresen on August 04, 2010, 08:40:55 
PM
1. Rate limit based on the ﬁrst byte of the IP address (79. or 
81. in this case).
Deﬁnitely needed.  What rate are you thinking of?  Ultimately, it’s 
better to rate limit it than to let it all drain out.
Quote from: gavinandresen on August 04, 2010, 08:40:55 
PM
3. Rate limit based on last two domains of reverse DNS 
lookup of the IP address (rima-tde.net in this case).
That might work surprisingly well.  If it works, it keeps them from 
hitting the rate limit, but the rate limit is there as the last line of 
defence. 

THE BOOK O
F SA
TOSHI
216
Quote from: gavinandresen on August 04, 2010, 08:40:55 
PM
4. Make the standard amount given away 0.5 Bitcoins 
(Bitcoins have gone up 10 times in value since I started the 
Faucet).
Deﬁnitely time to lower it.

217
53
T
r
ansacti
o
n t
o IP 
Add
ress Ra
th
er than 
B
it
co
i
n Address
I
N THE BEGINNING
, the ability to send to a
n IP address rather 
than (or perha
ps in addition to) a B
itcoin addr
ess was consider
ed.
b
itc
oi
nd transacti
o
n to i
p address
Posted by lfm, August 05, 2010, 02:22:14 PM
I cant ﬁgure out how to send a transaction to an ip address 
from bitcoind command line interface. Has the function been 
implemented yet? (linux 64 if it matters)

THE BOOK O
F SA
TOSHI
218
Re: b
itc
oi
nd transacti
o
n to i
p address
Posted by satoshi, August 05, 2010, 05:28:40 PM
It’s not implemented.
It turned out nobody liked that mode of transfer anyway, so it 
hasn’t had much development attention.

219
54
O
n Escr
ow an
d 
Mul
ti-Si
gna
ture 
T
r
ansacti
o
ns
T
RANSA
CTIONS 
 
req
uir
ing m
ultiple signa
tures ar
e built in 
to the Bi
tcoin pr
otocol and can be used by escro
w ser
v
ices. 
Fo
r examp
le, three keys are in
volv
ed, but onl
y two of these 
ar
e required to sign the tran
s
action. In suc
h cas
e, on
e key is owned by 
the payer
, the second by the pa
yee, and the third b
y the es
cro
w agent. 
When ther
e are no dis
putes o
r conicts, the payer an
d t
he pay
ee sig
n 
the transaction so that the pa
yee can receive the funds.
If ther
e is a disput
e, the escrow ag
ent reviews the dispu
te and, a
er 
deciding fo
r either the payer o
r t
he pay
e
e, signs the transaction o
ver to 
whichever party the escrow ag
ent has decided in fav
or of. is is a
nal
-
ogou
s to a bank check that r
equires two signa
tures from a
ny o
f t
hree 

THE BOOK O
F SA
TOSHI
220
persons, in this case the payer
, payee, a
nd the escrow agen
t. Escrow 
ser
vices for Bi
tcoin transactions do exist t
o
day
. e fo
l
lowing thr
ee 
threads con
tain discussions r
elated to ho
w escrow co
uld b
e handled 
and the im
plication
s of escrow t
o Bitcoin.
A pro
posal for a s
emi-aut
om
a
ted  
Escrow mechanism
Posted by Olipro, July 30, 2010, 07:29:08 PM
So, the basic escrow works by two people working through a 
third party to exchange (usually money) for some other for
m of 
goods or ser
vices.
In a transaction where both people are honest, the escrow 
business can essentially be automatic since the buyer gets his 
goods and approves release of funds, only when there is a 
dispute does human interaction become necessar
y
. Therefore, 
I propose the following system:
1) you create an escrow transaction for the amount, 
authorised by your key and containing the recipient’
s key/
data etc - this block cannot be claimed until a subsequent 
block is issued by the buyer to approve it, it’
s also impossible 
for the buyer to reclaim it without the seller approving it to be 
returned.
 
2) it enters the network, gets veriﬁed and the seller sends 
the goods, once the buyer gets them, he creates a release 
transaction and the seller gets his bitcoins.
3) if a dispute occurs and both parties are refusing to release 
the money one way or the other
, clearly it’
s now necessar
y to 
get a third party to arbitrate - in this situation, a signature from 
both the buyer and seller authorising a third party is required 

O
n Escr
ow and Mul
ti-Signa
ture Transactio
ns
221
which will give that third party ownership of the original 
escrow transaction and they can then arbitrate the matter
.
Re: A pro
posal for a s
emi-aut
om
a
ted 
Escrow mechanism
Posted by satoshi, August 05, 2010, 06:08:30 PM
A transaction can be written that requires two signatures to spend 
it next. Y
ou write a payment that requires the signature of both 
the recipient and the sender to spend it. To release the escrow, 
you give the recipient the signature for your half, or the payee can 
return it by giving you his signed half. There’s no mediator in this 
simple case. The recourse is to refuse to ever release it, essentially 
burning the money.
Re: A pro
posal for a s
emi-aut
om
a
ted 
Escrow mechanism
Posted by satoshi, August 07, 2010, 08:04:59 PM
Quote from: jgarzik on August 05, 2010, 07:00:30 PM
Due to that recourse, it is unlikely to be used as an escrow 
mechanism : - )
Really? Do you think people won’t be able to understand the 
beneﬁt? (If your response is an argument that there’s no beneﬁt at 
all, I guess that will reinforce the case that people won’t be able to 
understand it.)
H
ere, Sa
toshi creat
es a sp
ecic thread regar
ding escrow ha
ndling.

THE BOOK O
F SA
TOSHI
222
Escrow
Posted by satoshi, August 07, 2010, 08:13:52 PM
Here’s an outline of the kind of escrow transaction that’s possible 
in software.  This is not implemented and I probably won’t have 
time to implement it soon, but just to let you know what’s possible.
The basic escrow: The buyer commits a payment to escrow. The 
seller receives a transaction with the money in escrow, but he 
can’t spend it until the buyer unlocks it. The buyer can release the 
payment at any time after that, which could be never. This does 
not allow the buyer to take the money back, but it does give him 
the option to burn the money out of spite by never releasing it. The 
seller has the option to release the money back to the buyer.
While this system does not guarantee the parties against loss, it 
takes the proﬁt out of cheating.
If the seller doesn’t send the goods, he doesn’t get paid. The 
buyer would still be out the money, but at least the seller has no 
monetary motivation to stiff him.
The buyer can’t beneﬁt by failing to pay. He can’t get the escrow 
money back. He can’t fail to pay due to lack of funds. The seller 
can see that the funds are committed to his key and can’t be sent 
to anyone else.
Now, an economist would say that a fraudulent seller could start 
negotiating, such as “release the money and I’ll give you half of it 
back”, but at that point, there would be so little trust and so much 
spite that negotiation is unlikely. Why on earth would the fraudster 
keep his word and send you half if he’s already breaking his word 
to steal it? I think for modest amounts, almost everyone would 
refuse on principle alone.

O
n Escr
ow and Mul
ti-Signa
ture Transactio
ns
223
Re: Escrow
Posted by jgarzik, August 07, 2010, 09:25:40 PM
Buyer not having recourse except burning the money will limit 
the utility
, I think.
Re: Escrow
Posted by aceat64, August 08, 2010, 02:55:59 AM
Quote from: jgarzik on August 07, 2010, 09:25:40 PM
Buyer not having recourse except burning the money will limit the 
utility
, I think.
Perhaps we could work in a way to do arbitration. If both the 
buyer and seller agree, the money can be diverted to a 3rd 
party
. That person could then arbitrate and either return the 
money to the buyer
, give it to seller or steal it (obviously you’d 
want to choose a trustworthy arbitrator).
Re: Escrow
Posted by jgarzik, August 08, 2010, 03:58:03 AM
Quote from: aceat64 on August 08, 2010, 02:55:59 AM
Quote from: jgarzik on August 07, 2010, 09:25:40 PM
Buyer not having recourse except burning the money will limit 
the utility
, I think.
 

THE BOOK O
F SA
TOSHI
224
Perhaps we could work in a way to do arbitration. If both the 
buyer and seller agree, the money can be diverted to a 3rd 
party
. That person could then arbitrate and either return the 
money to the buyer
, give it to seller or steal it (obviously you’d 
want to choose a trustworthy arbitrator).
That’
s how online escrow operates today
.  Buyer and seller 
agree to let a 3rd party physically hold the money
.  Buyer and 
seller both agree to rules that the neutral 3rd party will follow
, 
for transaction resolution / redemption. The neutral third party 
is the one who disburses funds to one party or the other
.
This is a pretty decent over
view: https://www
.escrow
.com/
solutions/escrow/process.asp
Some
 people might choose to use the bitcoin-speciﬁc signed 
escrow method...  but I think the “burn the money” recourse 
ser
ves as a incentive to 
avoid
 bitcoin escrow entirely
, rather 
than an incentive to use bitcoin escrow honestly
.
Re: Escrow
Posted by aceat64, August 08, 2010, 05:49:44 AM
I like Olipro’
s suggestion is this thread: http://bitcointalk.org/
index.php?topic=645.0
The buyer and seller both an equal amount of bitcoins into 
escrow and the seller can’t retrieve both sets until the buyer 
signs off on it. Optionally if both parties agree the funds are 
returned to their original owners or both sets are transfered to 
an agreed upon arbitrator
. I deviate from his suggestion that 
the arbitrator only have control over the buyers half, I think 
they should have control of both so that both parties still have 
a bitcoin stake in the issue.

O
n Escr
ow and Mul
ti-Signa
ture Transactio
ns
225
Re: Escrow
Posted by jgarzik, August 10, 2010, 06:53:57 PM
Quote from: nimnul on August 10, 2010, 05:51:49 PM
The Satoshi solution is good, because if customer can take money 
back, it will be a big problem to sellers. See current situation with 
internet credit card payments and chargebacks. Chargebacks are 
major PIT
A for sellers, bitcoin must avoid that at all cost : - )
Ask some real-world business owners if they want to tell their 
customers about the chance of the money being lost forever
, 
unrecoverable by either party
.
Re: Escrow
Posted by nelisky
, August 10, 2010, 08:20:36 PM
Regardless of what the technical options are, I think that an 
escrow will always need to be, by deﬁnition, a trusted entity
. 
I can see the automated workﬂow being easy enough when 
things go well: 
 
• 
 
Buyer sends btc to escrow
, stating the recipient address
 
• 
 
Seller sees btc in escrow
, marked to send to his address
 
• 
 
Buyer can release funds to seller
 
• 
 
Escrow will automatically do so after x days
 
• 
 
Both par
ties can open a complaint
And that’
s all I would automate. When things go bad, both 
parties should have a fee to pay to the escrow (that fee may 
be paid in advance to open account there?) so ever
yone 
looses something. Then the escrow will just have to mediate. 
 

THE BOOK O
F SA
TOSHI
226
Because there’
s a fee *and* a human intermediar
y
, the 
chances of successful fraud will probably not be economically 
interesting in the long run. Someone already trusted would 
make the ideal person for this, and maybe for a small fee 
some of us ‘common guys’ could help assert allegations from 
either side, if we are local to them.
But the money burning solution, while great at preventing 
economically viable fraud, does nothing to prevent revenge 
and actually makes ever
yone loose if one side is dishonest. I 
would certainly not endorse that.
Re: Escrow
Posted by satoshi, August 11, 2010, 01:30:02 AM
Quote from: jgarzik on August 10, 2010, 06:53:57 PM
Ask some real-world business owners if they want to tell their 
customers about the chance of the money being lost forever
, 
unrecoverable by either party
.
That makes it sound like it might somehow get lost and the parties 
can’t get it even if they want to cooperate.
When you pay for something up front, you can’t get it back either. 
Consumers seem comfortable with that. It’s no worse than that.
Either party always has the option to release it to the other.
Quote from: nelisky on August 10, 2010, 08:20:36 PM
But the money burning solution, while great at preventing 
economically viable fraud, does nothing to prevent revenge 
and actually makes ever
yone loose if one side is dishonest. I 
would certainly not endorse that.

O
n Escr
ow and Mul
ti-Signa
ture Transactio
ns
227
Then you must also be against the common system of payment up 
front, where the customer loses.
Payment up front: customer loses, and the thief gets the money. 
Simple escrow: customer loses, but the thief doesn’t get the money 
either.
Are you guys saying payment up front is better, because at least 
the thief gets the money, so at least someone gets it?
Imagine someone stole something from you. Y
ou can’t get it 
back, but if you could, if it had a kill switch that could be remote 
triggered, would you do it? Would it be a good thing for thieves to 
know that everything you own has a kill switch and if they steal it, 
it’ll be useless to them, although you still lose it too? If they give it 
back, you can re-activate it.
Imagine if gold turned to lead when stolen. If the thief gives it 
back, it turns to gold again.
It still seems to me the problem may be one of presenting it 
the right way. For one thing, not being so blunt about “money 
burning” for the purposes of game theory discussion. The money 
is never truly burned. Y
ou have the option to release it at any time 
forever.
Re: Escrow
Posted by ribuck, August 11, 2010, 11:13:12 AM
Quote from: Inedible on August 11, 2010, 01:52:53 AM
. 
. 
. 
It’
s just a shame there’
s nothing that can be done to mitigate 
malicious intent by offering to sell something, only to ‘burn’ the 
payment and never send the goods (assuming they even existed). 
 

THE BOOK O
F SA
TOSHI
228
This would just be a case of spite but a ver
y real threat none the 
less.
E.g.
A offers to sell laptop 
B offers to buy and escrows 2000 bitcoins 
A conﬁrms that item is sent but never sends it 
B never receives it so never release the bitcoins 
A doesn’t care because their intent was to make B ‘spend’ their 
bitcoins with no recompense
How about this:
A offers to sell laptop for 2000 bitcoins, and escrows 2500 
bitcoins as security 
B offers to buy and escrows 2500 bitcoins 
A conﬁrms that item is sent but never sends it 
B never receives it so never release the bitcoins 
A now cares because he has 2500 bitcoins in escrow as 
security
In this scenario, it’
s in A
’
s interest to send the laptop, 
other
wise he loses his BTC 2500 security
. It’
s also in B’
s 
interest to conﬁrm receipt of the laptop, other
wise he loses his 
BTC 500 “excess”.
The awkward situations are going to arise if both A and B are 
honest, but an uninsured deliver
y ser
vice loses or breaks the 
laptop, or if one of the participants dies before releasing the 
escrow
.
And ano
ther thread surfaced later:

O
n Escr
ow and Mul
ti-Signa
ture Transactio
ns
229
Ho
w to Make a Distributed B
itc
oi
n 
Escrow Servi
ce
Posted by harding, September 26, 2010, 01:16:18 AM
Summar
y: Giving BitCoin a decentralized escrow would give 
it an advantage over all other exchange mediums, which 
might increase its adoption rate. Details follow
.
For a 
decentralized
 currency
, 
centralized
 escrows seem to be 
the norm for BitCoin today
. An example:
Alice wants to buy $5 USD worth of BitCoins from Bob, 
but neither Alice nor Bob fully trust the other
, so they go to 
a site they both trust--say Mt. Gox. There they deposit their 
respective monies and there they have Mt. Gox make the 
exchange for them.
No offense to Mt. Gox (a site I like), but can we do without its 
escrow ser
vice?
An almost distributed alternative: 
Charlie, a trusted third-party
, generates a BitCoin private 
key
.
Charlie then uses the Unix command 
split
 to split the 
private key in half--giving one half to Alice and one half to 
Bob.
Bob deposits $5 USD worth of BitCoins into the split BitCoin 
account;
Alice veriﬁes the transaction using the public block; 
Alice sends $5 USD to Bob by PayPal; 
Bob veriﬁes the PayPal transaction; 
Bob sends Alice his half of the split private key so Alice can 

THE BOOK O
F SA
TOSHI
230
access the BitCoins he deposited earlier
.
 
(For simplicity I omit part of the PayPal details like who 
pays the transaction fee and how long you should wait to 
avoid chargeback fraud. I also omit any incentive for Bob to 
perfor
m the ﬁnal step.)
More advanced almost-distributed examples can be made 
if we substitute something more sophisticated for the Unix 
command 
split
. For example: a Shamir’
s secret sharing 
scheme implementation like 
ssss
[1]. A utility like 
ssss
 
allows Alice and Bob to appoint an arbiter in case they get 
in a disagreement.
The problem with all of this, of course, is that we must trust 
Charlie to not abuse the full copy of the private key he 
creates.
The ideal solution would be for Alice and Bob to each 
generate half of the private key on their own. I don’t fully 
understand the math used in modern keypairs, but I doubt 
this is possible with the current algorithm.
Is there an alternative way for Alice and Bob to each 
acquire half of a private key without giving the whole key to 
any party?
—Dave
[1] See: http://en.wikipedia.org/wiki/Shamir’
s_Secret_
Sharing

O
n Escr
ow and Mul
ti-Signa
ture Transactio
ns
231
Re: Ho
w to Make a Distributed  
Bit
coi
n Escr
ow Servi
ce
Posted by satoshi, September 26, 2010, 05:34:26 PM
It’s not implemented yet, but the network can support a transaction 
that requires two signatures. It’s described here: 
http://bitcointalk.org/index.php?topic=750.0
It’s absolutely safer than a straight payment without escrow, but 
not as good as a human arbitrated escrow, assuming you trust the 
human enough.
In this kind of escrow, a cheater can’t win, but it’s still possible for 
you to lose. It at least takes away the proﬁt motive for cheating 
you. The seller is assured that the money is reserved for him, while 
the buyer retains the leverage that the seller hasn’t been paid yet 
until completion.

233
55
O
n B
it
co
i
n Mi
n
i
ng as 
a W
a
ste o
f Resour
ces
T
HE ARGU
MENT 
that b
itcoin minin
g is a waste of r
es
ources 
has o
en b
een reported in the media. If Sa
toshi were no
t anon
-
ymous a
nd were still inv
olved, his in
ter
views would inevitably 
incl
ude t
his question. 
us, seeing the answer h
e would likely giv
e 
pr
es
ent
e
d in these posts is il
lumina
ting.
Bit
coi
n minti
ng  
is th
ermodynamicall
y per
vers
e
Posted by gridecon, August 06, 2010, 01:52:00 PM
Let me begin by saying that Bitcoin is an amazing project 
and I am ver
y impressed with the implementation and the 

THE BOOK O
F SA
TOSHI
234
goals. From reading these forums it seems to be understood 
that debate about the design and operation of the bitcoin 
economy ultimately ser
ves to strengthen it, so I hope these 
comments are taken in that spirit. *EDIT - I have been 
convinced by further research and discussion that Bitcoin 
is actually highly efﬁcient compared to most traditional 
currencies, because the infrastructure required to support a 
government issued ﬁat currency represents a much larger 
investment of resources than Bitcoin’
s cpu power consumption. 
I am leaving this thread active though because it has been 
generating a lot of interesting discussion.*
I believe that the amount of energy input required to the 
bitcoin economy represents a serious obstacle to its growth. I 
think in the long-term, transactions may be even more serious 
than minting in this regard, but I will for the moment discuss 
minting because it is more precisely bounded and deﬁned. 
The idea that the value of bitcoins is in some way related to 
the value of the electricity required, on average, to mint a 
winning block is generally accepted, but the precise nature of 
this relationship is contentious. 
One argument is that anyone who chooses to generate 
coins is actually making the choice to purchase bitcoins with 
electricity/computational resources, and that because some/
many people are in fact making that choice, bitcoins have 
at least that much “value” to the generators, who can be 
assumed to be maximizing their utility
. A contrasting argument 
is that cost of production is different than market value, and 
the most objective measure is the current market conversion 
price to a more liquid and widely traded currency such as the 
US dollar
.
My contention is that both of these arguments miss the point 
and the real problem, which is the fundamental per
versity 
of wasting large amounts of energy and computations in 
generating the winning blocks for the minting process. The 

O
n Bitco
in Min
ing as a W
aste of Resources
235
minting process exists because of the necessity of actually 
“printing” the currency
, and cer
tain desirable proper
ties of 
cr
ypto-math for making the currency’
s behavior predictable. 
The fact that the current minting process requires a large 
energy input of computational work is highly unfortunate and 
has the per
verse consequence that bitcoin may actually be 
“destroying wealth” in the sense of wasting energy producing 
a digital object worth less than the resources invested in it.
As is often pointed out, a currency does not necessarily 
have, or need to have, any inherent value - a medium of 
exchange is a useful tool and can have value purely as a 
consequence of social convention. The cost of production 
of bitcoins in electricity consumed represents a waste, a 
“thermodynamic burden” that the currency has to carr
y
. 
Consider a hypothetical alternative digital currency called 
“compucoin”, which purchases cpu cycles from nodes on the 
network. The market value of this currency would converge 
ver
y closely with the cost of electricity required to generate 
cpu cycles. Instead of costing cpu cycles to mint, the value of 
the cpu cycles the coins could be exchanged for would create 
a rational basis for the currency’
s value and integrate it with 
an existing market. I imagine that alternatives to Bitcoin (many 
of them probably sharing a lot of Bitcoin’
s source code) will 
inevitably emerge and Bitcoin’
s current minting process makes 
the currency “expensive” in terms of energy input. I believe 
this places it at a competitive disadvantage to other currencies 
and can only hinder its widespread adoption and long-term 
value. *Edit - as mentioned above, I am now much more 
optimistic about Bitcoin long term. I still think compucoins 
would be a cool idea, though!*

THE BOOK O
F SA
TOSHI
236
Re: Bit
coi
n minti
ng  
is th
ermodynamicall
y per
vers
e
Posted by satoshi, August 07, 2010, 05:46:09 PM
It’s the same situation as gold and gold mining.  The marginal cost 
of gold mining tends to stay near the price of gold.  Gold mining 
is a waste, but that waste is far less than the utility of having gold 
available as a medium of exchange.
I think the case will be the same for Bitcoin.  The utility of the 
exchanges made possible by Bitcoin will far exceed the cost of 
electricity used.  Therefore, 
not
 having Bitcoin would be the net 
waste.
Quote from: gridecon on August 06, 2010, 04:48:00 PM
As an overall point, I also do not agree with the idea that 
the ver
y high computational burden of coin generation is 
in fact a necessity of the current system. As I understand it, 
currency creation is fundamentally metered by TIME - and if 
that is the fundamental controlling variable, what is the need 
for ever
yone to “roll as many dice as posible” within that 
given time period? The “chain of proof” for coin ownership 
and transactions doesn’t depend on the method for spawning 
coins. 
Each node’s inﬂuence on the network is proportional to its CPU 
power.  The only way to show the network how much CPU power 
you have is to actually use it.
If there’s something else each person has a ﬁnite amount of that 
we could count for one-person-one-vote, I can’t think of it.  IP 
addresses 
. 
. 
. 
much easier to get lots of them than CPUs.
I suppose it might be possible to measure CPU power 
at certain 
times
.  For instance, if the CPU power challenge was only run for 
an average of 1 minute every 10 minutes.  Y
ou could still prove 

O
n Bitco
in Min
ing as a W
aste of Resources
237
your total power at given times without running it all the time.  I’m 
not sure how that could be implemented though.  There’s no way 
for a node that wasn’t present at the time to know that a past 
chain was actually generated in a duty cycle with 9 minute breaks, 
not back to back.
Proof-of-work has the nice property that it can be relayed through 
untrusted middlemen.  We don’t have to worry about a chain 
of custody of communication.  It doesn’t matter who tells you a 
longest chain, the proof-of-work speaks for itself.
Re: Bit
coi
n minti
ng  
is th
ermodynamicall
y per
vers
e
Posted by satoshi, August 09, 2010, 09:28:39 PM
The heat from your computer is not wasted if you need to heat 
your home. If you’re using electric heat where you live, then your 
computer’s heat isn’t a waste. It’s equal cost if you generate the 
heat with your computer.
If you have other cheaper heating than electric, then the waste is 
only the difference in cost.
If it’s summer and you’re using A/C, then it’s twice.
Bitcoin generation should end up where it’s cheapest. Maybe that 
will be in cold climates where there’s electric heat, where it would 
be essentially free.

THE BOOK O
F SA
TOSHI
238
Re: Bit
coi
n minti
ng  
is th
ermodynamicall
y per
vers
e
Posted by throughput, August 10, 2010, 12:27:30 PM
I think the discussion have eventually lost the ethic aspects of 
motivating the botnet creators to 
invest even more resources in their business in case when 
BTCs generated will deliver the value, 
 comparable to the current uses of botnets. 
What if Bitcoin operation will outperfor
m the other activities? 
How can you imagine, that botnet building process is done in 
a way
, that beneﬁt the community?
Quote from: jgarzik on August 06, 2010, 07:53:25 PM
Participation in the network as an honest node helps ever
yone.
Y
es, but only when it is not against the computer owner’
s will, he 
pays the electricity bill.
If it is, then he loses REAL money for an extra power consumption 
caused by 100% CPU load. 
So, Bitcoin motivates behavior of stealing computing power from 
innocent computer owners.
W
ell, you may now tr
y to compare the social harm to the beneﬁts, 
but do you really feel you have the moral right to do so?
Re: Bit
coi
n minti
ng  
is th
ermodynamicall
y per
vers
e
Posted by Gavin Andresen, August 10, 2010, 09:26:14 PM
Quote from: throughput on August 10, 2010, 12:27:30 PM

O
n Bitco
in Min
ing as a W
aste of Resources
239
So, Bitcoin motivates behavior of stealing computing power from 
innocent computer owners.
Sure, in exactly the same way the existence of credit cards 
motivates behavior of stealing credit card numbers from 
innocent credit card users.
Or the existence of bank accounts motivates hackers to tr
y to 
break into your system to ﬁnd out your bank account number
.
Or the existence of cars motivates some people to steal 
gasoline from innocent ser
vice station owners.
I believe the beneﬁts of Bitcoin will outweigh the harm, and 
I further believe that I 
am
 capable of making that moral 
judgment.  I might be wrong, and I might regret I ever got 
involved, but if I only ever did things that I was 100% certain 
were going to work out for the best I would never accomplish 
anything new and interesting.

241
56
O
n an Al
terna
te T
yp
e 
o
f B
l
ock Chai
n with 
Just Has
h Reco
rds
H
ERE, 
a sugges
t
ion tha
t Satoshi co
nsidered int
eresting is dis
-
cussed. is suggestion r
elies on giving less inf
ormation in 
the block chain, wi
th t
he int
ent of p
roviding a gr
eater level 
of p
r
ivacy
.
No
t a suggestio
n
Posted by Red, August 10, 2010, 05:45:45 AM
As some might have noticed, one of the things that bugs 
me about bitcoin is that the entire histor
y of transactions is 

THE BOOK O
F SA
TOSHI
242
completely public. I totally understand the beneﬁts of how 
this simpliﬁes things and makes it easy for ever
yone to prove 
coins are valid. 
So this is not a suggestion for a change to bitcoin. Rather it is 
a question about what could be possible, and what couldn’t 
be possible.
The general question is, could the block list be/have been 
implemented in a way that didn’t store the full transactions in 
the list? Speciﬁcally
, *perhaps* it would be possible to store 
only hashes of the in-points, out-points in the block list. These 
would be time stamped (notarized) in the blocklist exactly as 
is being done now
.
The major difference is that it would be the coin receiver’
s 
responsibility to store the full transaction. And perhaps he 
might have to store previous transactions (X) deep to show 
histor
y
.
Then when he wanted to transfer the coins to the next party
, 
he would create a transaction exactly as is being done 
now
, except he would have to submit the antecedents to 
the transaction for validation as well. For validation, each 
antecedent of the in-points would be hashed and validated as 
existing in the block list. The in-points would be hashed and 
identiﬁed in the blocklist as not yet spent. Then the transaction 
would be validated as is currently done.
If ever
ything validated correctly
, the additional in/out-
point hashes would be added to the block. This closes the 
transaction’
s in-points, and marks the new out-point hashes as 
unspent.
Once a node completes the block (by winning the hashing 
contest), he then broadcasts the block of hashes and the 
related transactions+plus antecedents to the other nodes for 
conﬁrmation and acceptance.

O
n an Alterna
te Type of B
lock Chain with Just Hash Rec
ords
243
as a rough example:
{block-9 
 hash-a, hash-b, hash-c, hash-x  
} 
{block-12 
 hash-a, hash-y
, hash-c, hash-d  
} 
{block-17 
 hash-b, hash-d, hash-e, hash-z, hash-f  
}
{T
ransaction 
 {in-points: hash-x, hash-y
, hash-z} 
 {address, signature and other transactions stuff} 
 {out-points: hash-payed, hash-change 
}
{generating-block 
 hash-x, hash-y
, hash-z, hash-payed, hash-change 
}
So basically
, if the i/o-point hash existed twice in the block 
list, it has been spent. If it exists only once it has not been 
spent.
So in after block-17:  
 a, b, c & d are spent.  
 e, f, x, y
, z are unspent.
The transaction spends x, y & z and creates hash-payed & 
hash-change, so the transaction is valid.
After the generating-block: 
 a, b, c, d, x, y
, & z are spent.  
 e, f, payed, change are unspent.
====

THE BOOK O
F SA
TOSHI
244
The Goal: 
The goal is to provide all the same security of the existing 
system, but to avoid creating a public graph of ever
y 
transaction that is easily correlated. In this case, the hashes 
don’t even have to associate in the block. The block could 
simply sort all hashes in ascending order
.
In effect, I want to create real gold coins. I can give my coins 
to you, but ever
yone in the world doesn’t know I did. Y
ou 
can give them to the next guy and prove they are pure gold 
coins, because you have the pedigree of the coins AND ever
y 
generation in the pedigree was notarized in the public record.
====
The Question:
Satoshi showed that you can remove transactions from 
the block list through the Merkle tree structure, without 
compromising security
. I guess my real question is: 
“What is the earliest you can remove the transactions?”
Y
ou could argue that nodes could remember ever
ything 
anyway (the web never forgets). But if you structured the 
protocol so that new nodes would only receive a block list of 
hashes, they could only remember from this moment for
ward. 
That would give a little additional privacy
. (Maybe)
====
Any thoughts? Is there an obvious way that people could 
cheat and get rich?

O
n an Alterna
te Type of B
lock Chain with Just Hash Rec
ords
245
Re: No
t a suggestio
n
Posted by Insti, August 10, 2010, 09:34:14 AM
In your system, Rather than just getting transactions from the 
block chain I just have to watch ever
y transaction (which I’ll 
see anyway) and log them to my secret ser
ver
.
Y
ou’re just advocating security through obscurity
.
Re: No
t a suggestio
n
Posted by Red, August 10, 2010, 02:09:36 PM
Quote from: Insti on August 10, 2010, 09:34:14 AM
Y
ou’re just advocating security through obscurity
.
I did mention that. I wouldn’t count on this for monetary 
security
. I would like the system to be equivalent to the current 
one.
However
, privacy obscurity is known to add value. Y
our 
neighbors, or the FBI could me watching ever
ything you do all 
day long. But they probably aren’t. If you happen to become 
“of interest”, sure they could start watching you now and from 
this time for
ward.
But the most asked for additional legal powers seems to be, 
“let me examine ever
yone’
s logs!” (phone calls, cell towers, 
email connections, facebook connections, credit/debit card 
transactions, Google histor
y
, browser histor
y
.) The other systems
 
are “security though authority
.” Bitcoin doesn’t have that.
By the way
, I’d rather not broadcast ever
y transaction to ever
y 
node either
. But that is for another thread.

THE BOOK O
F SA
TOSHI
246
By the way
, this is the way most digital notar
y ser
vices work. 
Y
ou send them a hash of a signed document and they log it 
permanently
. Then they create a hash chain like bitcoin does. 
They periodically publish the current hash chain value in a 
newspaper or other ofﬂine redundant record.
Y
ou don’t have to send your private documents/transaction 
to the notar
y for them to be time stamped and recorded. The 
notar
y is just cer
tifying that something that matched this hash 
existed at this point in time.
Re: No
t a suggestio
n
Posted by Insti, August 10, 2010, 03:06:16 PM
Quote from: Red on August 10, 2010, 02:22:09 PM
By the way
, this is the way most digital notar
y ser
vices work. 
Y
ou send them a hash of a signed document and they log it 
permanently
. Then they create a hash chain like bitcoin does. They 
periodically publish the current hash chain value in a newspaper 
or other ofﬂine redundant record.
Y
ou don’t have to send your private documents/transaction to the 
notar
y for them to be time stamped and recorded. The notar
y is 
just certifying that something that matched this hash existed at this 
point in time.
Y
ou also don’t have to prove to the notary that you have X 
BTC in your account to spend.
Although I was recently reading about Zero-knowledge proofs 
((http://en.wikipedia.org/wiki/Zero-knowledge_proof) if you 
could use something like that to prove that your account had 
X BTC in it without revealing anything else it might be what 
you’re looking for
.

O
n an Alterna
te Type of B
lock Chain with Just Hash Rec
ords
247
I’m just worried what you want is theoretically impossible.
Re: No
t a suggestio
n
Posted by Red, August 10, 2010, 05:29:44 PM
Quote from: Insti on August 10, 2010, 03:06:16 PM
Although I was recently reading about Zero-knowledge proofs 
(http://en.wikipedia.org/wiki/Zero-knowledge_proof) 
Interesting idea to revisit! Thanks. Hadn’t thought of them in a 
while.
Re: No
t a suggestio
n
Posted by satoshi, August 11, 2010, 12:14:22 AM
This is a very interesting topic.  If a solution was found, a much 
better, easier, more convenient implementation of Bitcoin would 
be possible.
Originally, a coin can be just a chain of signatures.  With a 
timestamp service, the old ones could be dropped eventually 
before there’s too much backtrace fan-out, or coins could be kept 
individually or in denominations.  It’s the need to check for the 
absence of double-spends that requires global knowledge of all 
transactions.
The challenge is, how do you prove that no other spends exist?  It 
seems a node must know about all transactions to be able to verify 
that.  If it only knows the hash of the in/outpoints, it can’t check 
the signatures to see if an outpoint has been spent before.  Do you 
have any ideas on this?

THE BOOK O
F SA
TOSHI
248
It’s hard to think of how to apply zero-knowledge-proofs in this 
case.
We’re trying to prove the absence of something, which seems to 
require knowing about all and checking that the something isn’t 
included.
Re: No
t a suggestio
n
Posted by Red, August 11, 2010, 04:58:50 AM
Satoshi: I know you know the ﬁrst part of what I’m writing, but 
I want others to be able to follow and for you to correct any 
misconceptions I might have.
I was looking at the current Merkle tree implementation tr
ying 
to ﬁgure out when transactions could be removed without 
losing security
. 
In transaction graph terms, the transactions represent the 
nodes. The edges of the transaction graph are represented 
by the in-points which point to previous transactions using a 
BlockHash->T
ransHash->OutPoint kind of structure. It is the 
existence of an in-point that marks a previous out-point spent. 
So for a transaction to be valid, you most show for ever
y 
in-point in a transaction that BOTH, a previous out-point exists 
AND no previous in-point exists that references that out-point. 
So for ever
y out-point, there are zero or one in-points referring 
to it. zero = unspent. one = spent.
That also means that no transaction can be culled from the 
block list, until both its out-points are spent. Other
wise coins 
will disappear
. 
Y
ou can however
, delete all double-bound transactions as 

O
n an Alterna
te Type of B
lock Chain with Just Hash Rec
ords
249
soon as you are conﬁdent the 2nd binding block will stick 
around. (earliest possibility)
However
, as you delete transactions and replace them with 
their tree hashes, you lose the graph structure present in the 
block list. In effect, all transactions undeleted from the block 
list have unspent value purely because they still exist. They 
can no longer prove validity by ancestr
y since that par
t of the 
graph was culled.
Which got me thinking, is there a way to prove validity if you 
never put the whole transactions into the graph to begin with?
Quote from: satoshi on August 11, 2010, 12:14:22 AM
The challenge is, how do you prove that no other spends exist?  It 
seems a node must know about all transactions to be able to verify 
that.  If it only knows the hash of the in/outpoints, it can’t check 
the signatures to see if an outpoint has been spent before.  Do you 
have any ideas on this?
The key is to hash the transaction information as par
t of the 
out-point hash. So instead of creating a single transaction 
hash, you represent the transaction as two out-point hashes. 
(I originally considered an in-point/transaction/out-point 
structure using hashes, but that proved unnecessar
y
.)
Only transaction validators need to know the bitcoin address 
associated with a recorded out-point hash. That comes from 
the submitted antecedent transaction for an in-point of the 
current transaction. The antecedent transaction and out-point 
is hashed and presumed BOTH valid and unspent if that hash 
appears one-and-only-one time in the block list.
The current transaction must be signed by the key for the 
address in the antecedent transactions of course. If this proves 
valid, two new out-point hashes are generated and inserted 
in the current block. The in-point hashes are marked spent by 
including them in the current block as well. (If a hash exists 

THE BOOK O
F SA
TOSHI
250
twice it is spent.) If you want to represent the transaction as a 
unit (and the currently visible transaction graph), the in-point 
hashes and out-point hashes could be grouped. However
, this 
is not strictly necessar
y to prove validity
.
Quote from: satoshi on August 11, 2010, 12:14:22 AM
We’re trying to prove the absence of something, which seems to 
require knowing about all and checking that the something isn’t 
included.
In this case we are tr
ying to prove the presence of ONE 
matching hash and the absence of TWO matching hashes. It 
does require knowing all of them to prove.
I think the prohibitions against double spending are as strong 
as in the current version.
==== CAUTION! ====
However
, you have to consider the case where a node causes 
mischief by deliberate adding random “canceling hashes”. 
In this case, the node wouldn’t be able to gain access to the 
coins, as he has no signed transaction hashing to a valid 
unspent out-point hash. However
, the current owner wouldn’t 
be able to spend the coins either
. The in-point would be 
presumed already spent.
That means the validation conditions are EXACTL
Y THE SAME 
as with the current implementation. All validating nodes must 
examine and validate all transactions represented in a block 
before accepting it and building on it.
If there exist any hashes in the proposed block that are not 
represented by valid transactions, the block must be rejected.  
That is exactly the same as the current system’
s, if any 
transaction doesn’t validate, the block must be rejected.
I had hoped the condition to pass all transactions to all 

O
n an Alterna
te Type of B
lock Chain with Just Hash Rec
ords
251
validators could be weakened but I can’t see how (yet) without 
relying on trusted delegation.
----------
An interesting feature is that this simpliﬁes the validation 
process. All that needs to be done is to parse the block list 
(of hashes) once. As each hash is parsed you simply look it 
up in a hash-set. If it doesn’t exist you add it. If it does exist 
you delete it. When you are done parsing the block list, you 
will have the minimal set of valid and unspent out-points. Y
ou 
might even be able to keep the whole set in memor
y
. (at least 
for a while!)
Quote from: satoshi on August 11, 2010, 12:14:22 AM
It’s hard to think of how to apply zero-knowledge-proofs in this 
case.
It’
s hard for me too! :-) W
as interesting to re-read though!
W
as hoping it would spawn some insight on a way for nodes 
to demonstrate that they “always follow” the block generating 
rules, in absence of ever
yone needing to have the set of all 
transactions to double check.
It didn’t. :-)
Re: No
t a suggestio
n
Posted by satoshi, August 11, 2010, 09:07:59 PM
Still thinking this idea through 
. 
. 
.
The only job the network needs to do is to tell whether a spend of 
an outpoint is the ﬁrst or not.

THE BOOK O
F SA
TOSHI
252
If we’re willing to have clients keep the history for their own 
money, then some of the information may not need to be stored by 
the network, such as:
• 
 
the value
• 
 
the association of inpoints and outpoints in one transaction
The network would track a bunch of independent outpoints. It 
doesn’t know what transactions or amounts they belong to. A client 
can ﬁnd out if an outpoint has been spent, and it can submit a 
satisfying inpoint to mark it spent. The network keeps the outpoint 
and the ﬁrst valid inpoint that proves it spent. The inpoint signs a 
hash of its associated next outpoint and a salt, so it can privately 
be shown that the signature signs a particular next outpoint if you 
know the salt, but publicly the network doesn’t know what the next 
outpoint is.
I believe the clients would have to keep the entire history back to 
the original generated coins. Someone sending a payment would 
have to send data to the recipient, as well as still communicating 
with the network to mark outpoints spent and check that the spend 
is the ﬁrst spend. Maybe the data transfer could be done as an 
e-mail attachment.
The fact that clients have to keep the entire history reduces the 
privacy beneﬁt. Someone handling a lot of money still gets to see 
a lot of transaction history. The way it retrospectively fans out, 
they might end up seeing a majority of the history. Denominations 
could be made granular to limit fan-out, but a business handling a 
lot of money might still end up seeing a lot of the history.

O
n an Alterna
te Type of B
lock Chain with Just Hash Rec
ords
253
Re: No
t a suggestio
n
Posted by Red, August 12, 2010, 01:10:19 AM
Quote from: satoshi on August 11, 2010, 09:07:59 PM
Still thinking this idea through...
It’
s a bit of a brain twisting idea isn’t it. :-)
It turns out the notion of a cancelable notarization generalizes 
nicely
. 
For example this system is not limited to bitcoin transactions. 
Since the signed contracts are kept externally
, with additional 
validation/notarization rules, you could easily implement 
things like IOUs/claim checks. 
If someone gave you $5, you could give him a $5 IOU. Its 
IOU hash would be notarized into the blocks list (of hashes). 
When you pay them back you could have them sign the IOU 
for conﬁrmation. Then have the notar
y inser
t an IOU hash 
cancellation. Then no one could show back up with a copy of 
the IOU and demand double payment.
Quote from: satoshi on August 11, 2010, 09:07:59 PM
I believe the clients would have to keep the entire histor
y back to 
the original generated coins. The fact that clients have to keep the 
entire histor
y reduces the privacy beneﬁt. 
I thought this too at ﬁrst. But then I convinced myself 
other
wise.
It is really a matter of how much trust you place in the veriﬁers 
and the process of veriﬁcation. People like the warm fuzzys 
that having ever
y transaction available lets them trace the 
roots of their money back to its creation. However that is not 
required. 

THE BOOK O
F SA
TOSHI
254
If you are conﬁdent in the process that validated the 
transactions during block creation (> 50% CPU agreement). 
And if you are conﬁdent the previous blocks can’t be changed 
(you proved this). Then you only need to check that related 
out-points have not been spent. The security features remain 
in the block list and procedure, even if the transactions 
themselves are stored externally and the predecessors are 
not stored at all. Y
ou showed this yourself by proving old 
transactions can be deleted using the Merkle tree to maintain 
consistency
. 
Quote from: satoshi on August 11, 2010, 09:07:59 PM
Someone handling a lot of money still gets to see a lot of 
transaction histor
y
. The way it retrospectively fans out, they might 
end up seeing a majority of the histor
y
. Denominations could be 
made granular to limit fan-out, but a business handling a lot of 
money might still end up seeing a lot of the histor
y
.
T
rue, privacy is directly related to obser
vability
. If there is a central 
party like a money changer
, he can relate a lot of out-points. But if 
we get away from the notion that ever
y coin must be traced back 
to creation, the obser
vation horizons will be much closer
. 
----
It’
s really weird getting used to the notion that this coin is valid 
simply because the process wouldn’t let it be included otherwise. 
But really
, that is exactly how bitcoin generation works. The 
transaction has no inputs, but ever
yone decides the out-point must 
be valid purely because other
wise, it wouldn’t be in the block at 
all. :-)

O
n an Alterna
te Type of B
lock Chain with Just Hash Rec
ords
255
Re: No
t a suggestio
n
Posted by satoshi, August 12, 2010, 02:46:56 AM
Quote from: Red on August 12, 2010, 01:10:19 AM
Quote from: satoshi on August 11, 2010, 09:07:59 PM
I believe the clients would have to keep the entire histor
y back to 
the original generated coins.  The fact that clients have to keep the 
entire histor
y reduces the privacy beneﬁt.  
I thought this too at ﬁrst. But then I convinced myself 
other
wise.
Are you back to talking about the existing Bitcoin system here?
I was talking about in the hypothetical system I was describing, 
if the network doesn’t know the values and lineage of the 
transactions, then it can’t verify them and vouch for them, so the 
clients would have to keep the history all the way back.
If a client wasn’t present until recently, the two ways to convince it 
that a transaction has a valid past is: 
1) Show it the entire history back to the original generated coin. 
2) Show it a history back to a thoroughly deep block, then trust that 
if so many nodes all said the history up to then was correct then it 
must be true.
But if the network didn’t know all the values and lineage of the 
transactions, it couldn’t do 2), I don’t think

THE BOOK O
F SA
TOSHI
256
Re: No
t a suggestio
n
Posted by Red, August 12, 2010, 04:25:51 AM
Quote from: satoshi on August 12, 2010, 02:46:56 AM
Quote from: Red on August 12, 2010, 01:10:19 AM
I thought this too at ﬁrst. But then I convinced myself other
wise.
Are you back to talking about the existing Bitcoin system here?
Y
es, I am talking about the hypothetical system.
The way I proposed the system, each time a block gets 
generated ever
y validating node must accept or reject that 
block by validating the transactions and conﬁrming the hashes 
in the block. In effect, the same work that is being done with 
the current system, plus the out-point hash checks. Since the 
other validators were already competing to generate the 
block, they already have (at least most of) the transactions.
As with the current system, if the transactions don’t validate 
(plus match included out-point hashes) the other nodes will 
reject the block. If the block doesn’t get acceptance by at least 
50% of the CPU power
, it doesn’t make the block list.
So the presence of the hashes in the block list, signiﬁes that 
at least 50% of the existing validators at that time saw and 
validated all the containing transactions and out-point hashes. 
Therefore (barring hash crashes) if someone submits an 
antecedent transaction that matches an unspent out-point, it 
must be valid. 
That antecedent’
s antecedent must have been valid as well, 
other
wise the antecedent would have been rejected. And so 
on and so on.

O
n an Alterna
te Type of B
lock Chain with Just Hash Rec
ords
257
For that not to be the case, you have to postulate that there 
was a period in time where blocks weren’t being validated 
against out-point hashes. But that’
s plausibly implausible with 
the CPU competition system. 
Quote from: satoshi on August 12, 2010, 02:46:56 AM
If a client wasn’t present until recently
, the two ways to convince it 
that a transaction has a valid past is:
1) 
 
Show it the entire histor
y back to the original generated 
coin.
2) 
 
Show it a histor
y back to a thoroughly deep block, then 
trust that if so many nodes all said the histor
y up to then was 
correct then it must be true.
If a client joined the network recently
, it did so presuming that 
prior validators followed the rules and all pre-existing blocks are 
valid. (No one would join a known corrupt network)
Sure, in the current system, if transactions were never purged, a 
new node could validate all prior blocks for self consistency
. But 
they still couldn’t prove absolute truth. A bot net could have taken 
over and erased some transactions leaving “a new truth” and 
unhappy users. Equivalent to case 1) above.
In the current system, if transactions were Merkle tree purged then 
you have case 2) above. New comers must trust in the process. 
Anything missing, they don’t need to worry about. Ever
yone must 
presume it was valid.
The unique thing I’m saying is that, if you have conﬁdence in the 
bitcoin validation competition process (and we do!), then you 
really don’t need “a 2) thoroughly deep block” to be very deep at 
all. Someone said in another thread that clients reject any changes 
to blocks more than two hours old. So we can have absolute 
conﬁdence in all blocks buried 12 deep. 

THE BOOK O
F SA
TOSHI
258
So if a transaction is unspent and buried 12 deep, we can 
purge all it’
s ancestors. They add warm fuzzies but no additional 
validation. W
e have to rely on them. There is simply no way to 
back up and change course.
After that, ever
y succeeding block presumes all the preceding 
blocks are true. Other
wise it would be a fork and not a 
succeeding block. So for any transaction validated against 
out-points in a preceding block, if those out-points exist and are 
unspent, they must be presumed valid. If those are presumed valid, 
their ancestors must be presumed valid even if purged.
---
In the proposed system, exactly the same things are true.
If an antecedent out-point hash is unspent and buried 12 blocks 
deep, then it is absolutely unspent. Nothing can change that fact. 
No point in checking its ancestors. Y
ou can ﬁnish validating the 
transaction, cancel the in-points hashes and create new out-point 
hashes.
Interestingly
, if an antecedent out-point hash is unspent and 
buried LESS THAN 12 blocks deep, then it is RELA
TIVEL
Y unspent. 
Curiously
, there is still no point in checking its ancestors. The 
only thing that could change the antecedent’
s validity is a branch 
swap to a longer chain. If an ancestor of the antecedent you 
are validating this transaction against was swapped out, this 
transaction would be swapped out as well.
It’
s one of those cheesy time machine movie plots. Someone when 
back in time and spent my ancestor
. Now I don’t exist!
=====
So what I’m saying is that in BOTH systems (existing and 
proposed) the only thing validators need to do is to validate that 
the antecedent out-points exist and are unspent (for the current 
block chain). The process assures that ever
ything else remains 

O
n an Alterna
te Type of B
lock Chain with Just Hash Rec
ords
259
relatively or absolutely valid. 
 
The rest is just warm fuzzies. 
 
-- PS -- 
 
I know this is too long and redundant, but I’m to tired to edit. :-)
Re: No
t a suggestio
n
Posted by satoshi, August 13, 2010, 07:28:47 PM
I’m not grasping your idea yet. Does it hide any information from 
the public network? What is the advantage?
If at least 50% of nodes validated transactions enough that old 
transactions can be discarded, then everyone saw everything and 
could keep a record of it.
Can public nodes see the values of transactions? Can they see 
which previous transaction the value came from? If they can, then 
they know everything. If they can’t, then they couldn’t verify that 
the value came from a valid source, so you couldn’t take their 
generated chain as veriﬁcation of it.
Does it hide the bitcoin addresses? Is that it? OK, maybe now I 
see, if that’s it.
Crypto may offer a way to do “key blinding”. I did some research 
and it was obscure, but there may be something there. “group 
signatures” may be related.
There’s something here in the general area: 
http://www.users.zetnet.co.uk/hopwood/crypto/rh/
What we need is a way to generate additional blinded variations 

THE BOOK O
F SA
TOSHI
260
of a public key. The blinded variations would have the same 
properties as the root public key, such that the private key could 
generate a signature for any one of them. Others could not tell if 
a blinded key is related to the root key, or other blinded keys from 
the same root key. These are the properties of blinding. Blinding, 
in a nutshell, is x = (x * large_random_int) mod m.
When paying to a bitcoin address, you would generate a new 
blinded key for each use.
Then you need to be able to sign a signature such that you can’t 
tell that two signatures came from the same private key. I’m not 
sure if always signing a different blinded public key would already 
give you this property. If not, I think that’s where group signatures 
comes in. With group signatures, it is possible for something to be 
signed but not know who signed it.
As an example, say some unpopular military attack has to be 
ordered, but nobody wants to go down in history as the one who 
ordered it. If 10 leaders have private keys, one of them could sign 
the order and you wouldn’t know who did it.
Re: No
t a suggestio
n
Posted by Red, August 13, 2010, 09:48:56 PM
I’m going to reply to this in two parts.
Quote from: satoshi on August 13, 2010, 07:28:47 PM
I’m not grasping your idea yet. 
That’
s my fault, because I was tr
ying not to make too many 
claims at once. I was also not tr
ying to introduce too many 
new “features” at once for analysis.
My mental goal is to incrementally constrain the horizon of 

O
n an Alterna
te Type of B
lock Chain with Just Hash Rec
ords
261
transaction visibility
. Both in time and in space. Time meaning 
say to only nodes running at a particular instant. Space 
meaning to less than the set of all nodes running at the time. 
Optimally
, a transaction would only be known to the sender 
and the receiver
. Then all proof would disappear
. 
I hand you a $10 bill. Then we walk away forever
. As long as 
no one obser
ved me handing you the bill at that moment, no 
one can ever discover it by examining the bill itself.
Quote from: satoshi on August 13, 2010, 07:28:47 PM
Does it hide any information from the public network? What is the 
advantage? 
 
If at least 50% of nodes validated transactions enough that old 
transactions can be discarded, then ever
yone saw ever
ything and 
could keep a record of it.
I initially hoped that all transactions would be validated only 
between the parties concer
ned. In effect the block generating 
nodes would just record the hashes that got told to them.
However
, at the last minute I realized that since the hashes were 
not signed or other
wise veriﬁed, it became possible to easily 
falsify a “cancel the previous out-point hash”. Y
ou couldn’t steal 
someone’
s coins but you could invalidate them.
I can see three possible ways for
ward on that pesky detail. 1) let 
all veriﬁers see the transactions, minimize what is saved. 2) come 
up with some way to minimize the number of validators that need 
to see each transaction. 3) create a single use keypair for each 
new out-point. Sign the hashes. (Last minute entr
y!)
1) I initially wrote about the ﬁrst case, because it introduced less 
variables at once. I wanted to be sure recording only hashes 
wasn’t an obvious F
AIL.
I tried to quantify what bit of privacy we would gain. It is minimal 

THE BOOK O
F SA
TOSHI
262
in the worst case, (ever
yone saves ever
ything anyway) but it 
is considerable in the nominal case, most people don’t save 
anything they don’t need for themselves.
So in this increment, the beneﬁt is, any new threats can only 
obser
ve a transactions that occur after they join. They can’t look 
back in time, unless they can both identify an earlier adopter who 
recorded ever
ything from when they joined, and convince them to 
share. So minimal protection, but at least your Ex isn’t going to be 
snooping around after the fact. :-)
2) However
, it is possible to minimize the space horizon with a 
clever use of a DHT
. All details are not worked out yet, but you 
can visualize it by splitting the block list into say 1024 identical 
block lists each with 10 redundant validating nodes. Rather than 
one blocks list with 10,000 redundant validating nodes. Each 
randomly chosen set of nodes is responsible for a segment of the 
hash space. 
But instead of guaranteeing that 50% of all CPU power is required 
to fake something, you might aim for 100% consensus and a 
complete broadcast of the chain checksum and/or blocks. So 
upon periodic DHT re-org any new node can verify that the chain 
has always remained 100% consistent. (Similar to publishing each 
of the 1024 checksums in the newspaper each day)
This restricts an attacker’
s visibility to know what hash he would 
want to cancel. (I only see 1/1024th of the transactions) And it 
limits his time window to submit a fraudulent cancelation to a time 
window when he controls 100% of a bucket’
s veriﬁers.
So there is a potential path to gain some privacy by restricting 
some visibility
. It comes at some potential risk.
3) So in reality I need to give you credit for sparking the best 
case idea. Kudos! I initially dismissed the idea of signing the out-
point hashes, because it seems so much like the existing bitcoin 
addresses. I assumed the public key required in the signature 

O
n an Alterna
te Type of B
lock Chain with Just Hash Rec
ords
263
would associate too many things.
However
, if you use a one-time public key where you sign a 
combination of the out-point hash and the current block number
. 
Then when the out-point hash is initially created it is recorded with 
a public key
. When it is spent the hash is veriﬁed by having a 
different but related signature, signed by the same key
. 
I think that solves the problem completely
. There are no additional 
associations because the two single use instances of the out-point 
hash in the block list HA
VE TO be related. Adding a second single 
use public key identiﬁer adds nothing. 
T
o simplify the “current block number” issue, the submitter might 
submit signatures for the next 3-4 block numbers. The validator 
would only record the appropriate one. T
o the block
It does add more bits to the block list than I was hoping to. I 
thought a hash only was optimal.
====
What is the smallest cr
ypto construct that has the following 
properties? Might be able consider that instead of a hash and full 
signature.
1) I give you something that appears arbitrar
y
. 
2) I give you something that appears easily related to your #1 but 
unrelated to anyone else’
s #1. 
3) Nobody else could ﬁgure out your #2 from #1.
====
For example
1) I give you Z where Z = X * Y and both X & Y are large primes 
2) I give you the tuple (X, Y) 
3) Nobody can factor X and Y from Z
In that case, when sending an ofﬂine transaction, the sender 

THE BOOK O
F SA
TOSHI
264
would enclose (X,Y) for each in-point. 
The receiver would privately create a new (X,Y) for each new out-
point. 
The receiver then broadcasts each in-point’
s (X,Y) to cancel them. 
It broadcasts each out-point’
s Z to create them.
Does that work, or is it too naive?
Re: No
t a suggestio
n
Posted by Red, August 13, 2010, 10:20:50 PM
Quote from: satoshi on August 13, 2010, 07:28:47 PM
Cr
ypto may offer a way to do “key blinding”. I did some research 
and it was obscure, but there may be something there. “group 
signatures” may be related.
There’
s something here in the general area: 
http://www
.users.zetnet.co.uk/hopwood/cr
ypto/rh/
What we need is a way to generate additional blinded variations 
of a public key
. The blinded variations would have the same 
properties as the root public key
, such that the private key could 
generate a signature for any one of them. Others could not tell if 
a blinded key is related to the root key
, or other blinded keys from 
the same root key
. These are the proper
ties of blinding. Blinding, 
in a nutshell, is x = (x * large_random_int) mod m.
When paying to a bitcoin address, you would generate a new 
blinded key for each use.
Then you need to be able to sign a signature such that you can’t 
tell that two signatures came from the same private key
. I’m 
not sure if always signing a different blinded public key would 
already give you this property
. If not, I think that’
s where group 

O
n an Alterna
te Type of B
lock Chain with Just Hash Rec
ords
265
signatures comes in. With group signatures, it is possible for 
something to be signed but not know who signed it.
As an example, say some unpopular militar
y attack has to be 
ordered, but nobody wants to go down in histor
y as the one who 
ordered it. If 10 leaders have private keys, one of them could sign 
the order and you wouldn’t know who did it.
This is a really cool idea. I think I see where you were going 
with it. It took me a few tries to ﬁt it all together
. I’m a bit slow
.
I’m correct, you were suggesting that you could sign an out-
point hash with a single-use blinded key
.
Where the blinded public key is equivalent to the public key 
of the transaction’
s bitcoin address. Say the bitcoin address’ 
public/private key pair was P/p. The the blinded public keys 
would be P1, P2, P3...Pn. Where each can validate anything 
signed with the private key (p).
So upon creation when you submit the out-point hash for 
validation it appears as signed by P1. However
, when 
receiver submits the out-point for cancellation it would be 
signed P2 or anything besides P1 (since it is already of public 
record). Both calculated signatures would be the same, but the 
public key would change. That would signify only someone in 
possession of the common private key could have generated 
it.
That is genius!

267
57
O
n th
e Hi
gh
er Cost 
of
 M
ining
T
HIS THREAD DISCUSS
ES 
the increase in diculty of min
-
ing fo
l
lowing a
n increase in the amoun
t of com
put
er p
ower
, 
when the increase in com
puter po
wer is follo
wed by a dro
p in 
com
puter po
wer
. en, the miners le in the netwo
rk would then hav
e 
to deal with a muc
h hig
her diculty level, which incr
e
ases the time 
per block until the next adj
ustment.
is pr
oblem has not a
ected Bitco
in, but it did gr
e
atly a
ect s
ome 
alterna
tive cr
yptocurrencies such as F
eatherco
in. A solution called 
Kimo
to
’
s Gra
vity W
el
l was developed fo
r alternativ
e c
urrencies to in
te
-
grate
. e thread below addresses this poten
tial problem.
Sat
oshi specic
ally addresses the mark
et response to the cost o
f 
mining.

THE BOOK O
F SA
TOSHI
268
Po
tential disaster scenario
Posted by gebler
, August 14, 2010, 12:43:54 PM
The difﬁculty for generating bitcoins is periodically adjusted 
using a method that has worked well this far
. However
, I am 
afraid there are plausible scenarios where the current method 
would misbehave quite spectacularly
.
One scenario goes like this:
1) As bitcoins become more known, competition among 
minters continues to increase, with corresponding increases in 
difﬁculty
. The increased difﬁculty will eventually make bitcoin 
minting clearly unproﬁtable for those who do not have access 
to good energy prices and cheap access to an energy-efﬁcient 
HW/SW combination.
2) Some bitcoin users may continue to mint bitcoins even 
though it is not proﬁtable for them. This could be due to 
ideology
, the fun factor
, or just ignorance. But it is quite 
plausible that the vast majority of bitcoins will be minted by 
those who proﬁt from it. Let’
s say that 99% of all bitcoins are 
eventually minted by for-proﬁt-minters.
3) The competition among for-proﬁt-minters will drive proﬁt 
margins down, to the point where it is proﬁtable to continue 
minting, but barely so. Let’
s say that the typical proﬁt margin 
during one difﬁculty adjustment period (2016 blocks) is 10%.
4) Since bitcoin minting is a decentralized uncoordinated 
process, we can expect random ﬂuctuations in bitcoin minting 
activity
. This does not affect the difﬁculty during a speciﬁc 
2016-block period, so the minting activity can e.g. increase 
by 20% during a period without making minting unproﬁtable 
within that period.
Given the above assumptions, we now have a disaster at 

O
n the Higher C
ost of Min
ing
269
hand at the next difﬁculty adjustment. As bitcoin production 
was 20% more than target, difﬁculty is adjusted upwards 
by 20%. But the proﬁt margin was only 10%, so for-proﬁt-
minters would now lose money if they continued minting. They 
will therefore stop minting, and as they make up 99% of the 
minting capacity
, generating the next 2016 blocks will take 
100 times longer than normal. Ever
ything that depends on 
block generation will slow to a crawl, and this slowness will 
persist for a ver
y long time, since the next 2016 blocks will 
take 100 times longer to generate (almost 4 years rather than 
two weeks).
Now
, if this was to happen, I guess a new client could be 
released that resets the difﬁculty to some sensible number and 
started using a better algorithm for difﬁculty adjustment. But it 
would be much better to do it proactively before it becomes a 
problem (perhaps with a predetermined “ﬂag day” activating 
the new algorithm at a certain time in the future, giving the 
new client a chance to propagate).
A simple(?) modiﬁcation of the algorithm would be to apply 
the adjustment after a certain amount of time rather than at a 
certain block number
. The switch could still be synced to take 
effect for the next block, so time synchronization between 
clients would not need to be super exact to have the vast 
majority of them agree on when the new difﬁculty is to be 
applied.
Also, the difﬁculty adjustment should probably take into 
account the adjustments of the number of bitcoins minted per 
event (now 50, halved ever
y 4 years). Halving the number 
of bitcoins generated each time is equivalent to doubling the 
difﬁculty as far as proﬁtability is concerned, and such a 
drastical drop in proﬁtability is unnecessar
y if it can be 
avoided easily
. 
I’m not sure if the current adjustment algorithm already takes 
that into 

THE BOOK O
F SA
TOSHI
270
account somehow
, but I couldn’t see any obvious adjustment 
for it in the source code. 
Re: Po
tential disaster scenario
Posted by satoshi, August 15, 2010, 04:37:16 PM
Some places where generation will gravitate to:
1) places where it’s cheapest or free 
2) people who want to help for idealogical reasons 
3) people who want to get some coins without the inconvenience 
of doing a transaction to buy them
There are legitimate places where it’s free.  Generation is basically 
free anywhere that has electric heat, since your computer’s heat is 
offsetting your baseboard electric heating.  Many small ﬂats have 
electric heat out of convenience.
How expensive is heating oil?  With the price of oil so high, if it’s 
actually more expensive than electric, then generating would have 
negative cost.
There’s also kids putting it on their parent’s power bill, employees 
their employer, botnets, etc.
Case 3 comes into play for small amounts.  The overhead of doing 
an exchange doesn’t make sense if you just need a small bit of 
pocket change for incidental micropayments.  I think this is a nice 
advantage vs ﬁat currency, instead of all the seigniorage going 
to one big entity, let it go in convenience amounts to people who 
need to scrape up a small amount of change.

271
58
O
n th
e De
vel
o
pment 
o
f an Aler
t System
S
A
TOSHI DISCUSS
ES 
his develop
ment of a
n aler
t system where 
impo
r
tant mes
s
ages can be deliv
ered across the Bi
tcoin netwo
rk 
only b
y those w
ho own a p
r
iva
te key
, in this case Satoshi him
s
elf. 
is could be used, for exa
mple, t
o report to all miners the requir
e
-
men
t for an im
port
an
t s
owar
e upgrade aer a bug (i
ssue) has been 
found
.
Develo
pment o
f aler
t system
Posted by satoshi, August 22, 2010, 11:55:06 PM
I’ve been working on writing the alert system.  Alerts are 
broadcast through the network and apply to a range of version 

THE BOOK O
F SA
TOSHI
272
numbers.  Alert messages are signed with a private key that only I 
have.
Nodes can do two things in response to an alert:
• 
 
Put a warning message on the status bar.
• 
 
Make the money handling methods of the json-rpc interface 
return an error.
In cases like the overﬂow bug or a fork where users may not be 
able to trust received payments, the alert should keep old versions 
mostly safe until they upgrade.  Manual users should notice the 
status bar warning when looking for received payments, and the 
json-rpc safe mode stops automated websites from making any 
more trades until they’re upgraded.
The json-rpc methods that return errors during an alert are:
sendtoaddress 
getbalance 
getreceivedbyaddress 
getreceivedbylabel 
listreceivedbyaddress 
listreceivedbylabel
In a r
eply to someo
ne regardin
g the aler
t system:
Re: Develo
pment o
f aler
t system
Posted by satoshi, August 24, 2010, 11:51:12 PM
If you’re so paranoid that you’re getting hysterical over this, then 
surely you’re paranoid enough that if a warning message displays 
on the status bar, you’ll check the website and forum.
I think if another bug like the overﬂow bug occurs, it’s important 

O
n the Development o
f an Aler
t System
273
that automated websites stop trading until their admins can check 
out what’s going on and decide what to do.  If you decide it’s 
a false alarm and want to take your chances, you can use the 
“-disablesafemode” switch.
Re: Develo
pment o
f aler
t system
Posted by satoshi, August 25, 2010, 03:17:37 PM
It can’t do arbitrary actions remotely.  Maybe some of you are 
responding to other posters who suggested the alert system should 
do more?
If there is an alert, the following json-rpc methods return an error:
sendtoaddress 
getbalance 
getreceivedbyaddress 
getreceivedbylabel 
listreceivedbyaddress 
listreceivedbylabel
The remaining 14 methods function as normal. 
I believe the safer option should be enabled by default.  If you 
want your server to keep trading and ignore an alert saying the 
money its receiving might be like the money from the overﬂow 
bug, then you can use the switch and not blame anyone else if you 
lose your money.
Worst case if you leave alerts enabled, your site stops trading until 
you upgrade or add the -disablesafemode switch.
Getting surprised by some temporary down time when your node 
would otherwise be at risk is better than getting surprised by a thief 
draining all your inventory.

THE BOOK O
F SA
TOSHI
274
Someday when we haven’t found any new bugs for a long time 
and it has been thoroughly security reviewed without ﬁnding 
anything, this can be scaled back.  I’m not arguing that this is the 
permanent way of things forever.  It’s still beta software. 
Re: Develo
pment o
f aler
t system
Posted by satoshi, August 25, 2010, 04:56:15 PM
Quote from: jimbobway on August 25, 2010, 04:45:22 PM
Quote from: BioMike on August 23, 2010, 05:15:43 AM
@mizer
ydearia, I think the quote button is easier to ﬁnd then the 
reply one. 
So, theoretical this is a ﬁrst control system where <some 
goverment> can arrest satoshi and demand  
that he hands over his key (or get it from his computer) and shut 
down the complete network?
Or is that not possible? How far would <some goverment> get?
A few rhetorical questions for satoshi:
Can you resist waterboarding? 
Can you endure electric shock? 
All forms of tor
ture? 
Lastly
, are you Jack Bauer by any chance? Seriously
.
WRT the alert system, who cares?  The most the key can do 
is temporarily disable six json-rpc commands until the site 
owners either add the -disablesafemode switch or upgrade.  All 
nodes keep running and generating, the network stays up.  If 
I’m not available, any script kiddie can ﬁgure out how to add 
two characters and make a new version that disables the alert 
system.  It would be a temporary inconvenience only.

O
n the Development o
f an Aler
t System
275
Quote from: BioMike on August 23, 2010, 05:15:43 AM
So, theoretical this is a ﬁrst control system where <some 
goverment> can arrest satoshi and demand  
that he hands over his key (or get it from his computer) and shut 
down the complete network?
This is what makes me think the people objecting don’t know what 
they’re talking about.  It can’t “shut down the complete network”.
Re: Develo
pment o
f aler
t system
Posted by satoshi, August 25, 2010, 04:56:15 PM
Quote from: BioMike on August 25, 2010, 06:23:45 PM
Quote from: satoshi on August 25, 2010, 04:56:15 PM
This is what makes me think the people objecting don’t know what 
they’re talking about.  It can’t “shut down the complete network”. 
I’ve never objected this change/idea, just asking if this was 
possible and to what extent. 
What’
s wrong with getting informed? : - )
My apologies, your post was indeed a question not a statement.

277
59
O
n th
e Defi
n
itio
n o
f 
Mo
n
e
y an
d B
it
co
i
n
S
A
TOSHI RESPO
NDS
 to a thread regar
ding Bit
coin and M
ur
-
ray Ro
thbard
’
s view on mon
e
y
. Rothbard was part of the A
us
-
trian School of Econo
my
, an econo
mic s
chool of tho
ught whose 
man
y founder
s originated fro
m V
ienna during the la
te 19
th
 cent
ur
y
. 
I
ts distinctive trai
t is its belief that the wo
rkings of the b
roader econ
-
om
y are the sum o
f all individuals
’ decisions an
d ac
tions. I
n contras
t 
to most o
ther e
cono
mic s
chools, the A
ustrian school belie
ves tha
t 
no cen
t
ral planners co
uld p
ossibly be ab
le to pro
p
erly estima
te the 
resul
ting aggregate o
er and also demand o
f any p
roduct or ser
vice. 
If cen
tral planners cha
nge an
y economic para
meters that they con
trol 
(typically a
pplicable to in
terest ra
te under cen
tra
l banking), how co
uld 
they pro
p
erly estima
te the resulting s
um of all decisions on s
p
end
-
ing hab
its by co
nsumers as w
ell as inves
t
ing decision
s of businesses 

THE BOOK O
F SA
TOSHI
278
and in
vesto
rs. No ma
tter ho
w man
y charts and sta
t
istics ar
e collec
ted, 
deviations between expectation an
d outco
me are una
voidable a
nd will 
lead to event
ual disr
uptio
ns. 
Bit
coi
n does N
O
T vio
la
te  
Mis
es’ Regressio
n Th
eorem
Posted by xc, July 27, 2010, 02:09:27 AM
The Money Regression and Emergence of Money 
from the Barter Economy
 
The entire purpose of the regression theorem was to help 
explain an apparent paradox of money: how does money 
have value as a medium of exchange if it is valued because it 
ser
ves as a medium of exchange?  Menger and Mises helped 
break this apparent circularity by explaining the essential time 
component missing from the phrasing of the paradox.
As Rothbard explains in Man, Economy
, and State (p 270),  
“. 
. 
. 
a money price at the 
end 
of day X is determined by the 
marginal utilities of money and the good as they existed at 
the 
beginning 
of day X. But the marginal utility of money is 
based, as we have seen above, on a 
previously existing array 
of money prices
. Money is demanded and considered useful 
because of its already existing money prices. Therefore, the 
price of a good on day X is determined by the marginal utility 
of the good on day X and the marginal utility of money on 
day X, which last in turn depends on the prices of goods on 
day X – 1. 
The economic analysis of money prices 
is therefore not circular
. If prices today depend on 
the marginal utility of money today
, the latter is 
dependent on money prices yesterday
.
” [all emphasis 
added] 
Rothbard then goes on to explain that in order for money to 

O
n the Defin
ition o
f Mon
e
y and Bit
coi
n
279
emerge from a 
bar
ter
 economy
, it must have a preexisting 
commodity value.  This commodity value arises from barter 
demand for the potential money in 
direct consumption
 (i.e. 
ornamentation).  This value 
seeds
 future estimations of the 
value of the money as a medium of exchange.  The natural 
market emergence of money is thus fully explained.
The Monetary Economy
 
However
, once an economy has been monetized and a 
memor
y of price ratios for goods and ser
vices has been 
established, a money may lose its direct commodity 
value and still be used as a money (medium of indirect 
exchange).  Rothbard explains (p 275): 
“On the other hand, it does not follow from this analysis that if 
an extant money were to lose its direct uses, it could no longer 
be used as money
. Thus, if gold, after being established 
as money
, were suddenly to lose its value in or
naments or 
industrial uses, it would not necessarily lose its character as a 
money
. Once a medium of exchange has been established as 
a money
, 
money prices continue to be set
. If on day X 
gold loses its direct uses, there will still be previously existing 
money prices that had been established on day X – 1, and 
these prices form the basis for the marginal utility of gold on 
day X. Similarly
, the money prices thereby deter
mined on day 
X form the basis for the marginal utility of money on day X 
+ 1. From X on, gold could be demanded for its exchange 
value alone, and not at all for its direct use. Therefore, while 
it is absolutely necessar
y that a money 
originate as a 
commodity
 with direct uses, it is not absolutely necessar
y 
that the direct uses continue after the money has been 
established.”
This explains the histor
y of ﬁat currencies.  They originally 
started off as simple names for weights of commodity 
money (silver) that developed out of the pre-monetar
y bar
ter 
economy
.  Despite later losing their ties to direct commodity 
value through state interference, paper currency retained 

THE BOOK O
F SA
TOSHI
280
status as money because of 
memory of previous money 
prices
.  This factor is so strong that the relationship between 
gold and the USD, for example, is somewhat inverted.  Gold 
no longer circulates as a common medium of exchange. 
Prices are set in USD, not in gold.  Most individuals wishing 
to trade in gold do so based on their knowledge of USD/gold 
price ratios.  (“Hey
, let me buy that $100 couch from you 
in gold?”  “Ok, USD/gold is $1000/oz. Give me 1/10oz 
of gold.”)  Legal tender laws, state taxation, and the entire 
ﬁnancial regulator
y environment maintain this iner
tia of 
USD prices and make it challenging to return to gold money 
directly
, despite the destructive inﬂationar
y nature of ﬁat 
currencies.
The Emergence of the Bitcoin Economy
 
The ver
y ﬁrst businesses in the Bitcoin economy were 
exchangers (NewLibertyStandard, BitcoinMarket, 
BitcoinExchange,....).  This is not an accident, but ﬂows from 
the analysis above.  In order for Bitcoins to ser
ve as a medium 
of exchange without commodity value for uses besides indirect 
exchange, there must be a translated knowledge of money 
prices.  Market exchangers ﬁll this gap and give Bitcoin users 
access to this knowledge.  Bitcoins may therefore currently 
ser
ve as a money intermediar
y for paypal dollars\pecunix\
euros.  But why is there demand for Bitcoin over USD??  This 
is a subjective valuation arising from properties such as 
anonymity
, decentralized system of clearance, cr
yptographic 
trust, predetermined and deﬁned rate of growth, built in 
deﬂation, divisibility
, low transaction fees, etc.... inherent to 
the Bitcoin system.
The essential point is that once exchange can occur between 
a money (USD) and Bitcoins, providers of goods have a 
means by which to value Bitcoins as a potential medium of 
exchange.  The money regression is satisﬁed, because taken 
back far enough we reach traditional commodity money: 
BITCOINS -> USD -> MONETIZED GOLD & SIL
VER [star
t 

O
n the Defin
ition o
f Mon
e
y and Bit
coi
n
281
monetar
y economy] -> [end bar
ter economy] COMMODITY 
GOLD & SIL
VER.  
Of course, if a major meltdown occurred and knowledge 
of all price ratios was wiped out, Bitcoin probably would 
NOT directly emerge as a money (assuming Bitcoins have 
limited value outside of exchange).  Fiat currencies with zero 
direct barter value cer
tainly would not.  Commodities such as 
gold and silver that have widely recognized direct value in 
barter would likely emerge ﬁrst.  The economy would then be 
monetized with price ratios in gold and silver
.  Bitcoins then, 
being valued for intrinsic properties amenable to exchange, 
might then become prevalent in trade.  Initially
, creators of 
value would continue to make their price value ratios in terms 
of the true money (gold oz/BTC ratio), but with time Bitcoin 
prices (BTC) can emerge (see vekja.net as example).  W
e are 
in this initial phase now
.  
Therefore, so long as exchange of BTC and USD/Euros/etc… 
occurs, knowledge of existing price ratios can be utilized in 
the Bitcoin economy
.  In time as Bitcoins become increasingly 
marketable, these ﬁat<->BTC price ratios will seed direct BTC 
price ratios.  The Bitcoin Economy thus emerges.  The Misean 
regression theorem is satisﬁed.
XC
edit: clariﬁed possibility of direct emergence of bitcoin as 
money from barter economy
.
Re: Bit
coi
n does N
O
T vio
la
te Mises’  
Regress
io
n Th
eorem
Posted by satoshi, August 27, 2010, 05:32:07 PM
As a thought experiment, imagine there was a base metal as 

THE BOOK O
F SA
TOSHI
282
scarce as gold but with the following properties:
• 
 
boring grey in colour
• 
 
not a good conductor of electricity
• 
 
not particularly strong, but not ductile or easily malleable either
• 
 
not useful for any practical or ornamental purpose 
and one special, magical property: 
• 
 
can be transported over a communications channel
If it somehow acquired any value at all for whatever reason, then 
anyone wanting to transfer wealth over a long distance could buy 
some, transmit it, and have the recipient sell it.
Maybe it could get an initial value circularly as you’ve suggested, 
by people foreseeing its potential usefulness for exchange.  (I 
would deﬁnitely want some)  Maybe collectors, any random reason 
could spark it.
I think the traditional qualiﬁcations for money were written with the 
assumption that there are so many competing objects in the world 
that are scarce, an object with the automatic bootstrap of intrinsic 
value will surely win out over those without intrinsic value.  But if 
there were nothing in the world with intrinsic value that could be 
used as money, only scarce but no intrinsic value, I think people 
would still take up something.
(I’m using the word scarce here to only mean limited potential 
supply)
Another post o
n t
he same sub
je
ct:

O
n the Defin
ition o
f Mon
e
y and Bit
coi
n
283
Re: Bit
coi
n does N
O
T vio
la
te Mises’  
|Regress
io
n Th
eorem
Posted by epaulson, August 17, 2010, 06:45:18 PM
There has been a lot of debate about what Bitcoins are -- i.e. 
currency vs. commodity
. Also there has been a lot of debate 
about inﬂation vs. deﬂation with respect to Bitcoins, whether 
people would lend them, at what rates, etc.
I think the most apt description of Bitcoins is that they are 
shares of stock in this communal Bitcoin enterprise we are 
undertaking. It is a lot like being par
t of a company (right now 
a ver
y small company) and being paid in stock shares. There 
are a ﬁxed number of Bitcoins, as there are a ﬁxed number of 
shares in a company (barring new issues/etc.).
The primar
y value of Bitcoins right now is the hope that they 
will someday be worth signiﬁcantly more than they are right 
now
. For that to happen, the Bitcoin enterprise as a whole 
needs to gain collective value. W
e, as employee/owners of 
Bitcoin need to generate that added value. The most obvious 
way is to facilitate internet commerce by bar
tering shares of 
Bitcoin for other goods. The collective computational effort of 
all the employee/owners helps ensure that the barter is fair by 
keeping a record of each transaction. The individual efforts 
of some Bitcoiners are helping to make the barter of Bitcoins 
easier or more useful.
Regarding lending/borrowing of Bitcoins, to me it is 
analogous to lending/borrowing stock. The primar
y reason 
to borrow Bitcoins would be because you think they are 
over
valued and will be wor
th less when you have to return 
them. When you borrow the Bitcoins, you can sell them now 
(barter them now) and hopefully it will cost you less to buy 
them back at a later date so that you can return them to your 
lender (probably plus a fee).

THE BOOK O
F SA
TOSHI
284
In essence, Bitcoins are like a “direct public offering” of stock 
in the Bitcoin enterprise.
Re: Bit
coi
ns are most like s
hares  
o
f commo
n st
ock
Posted by satoshi, August 27, 2010, 04:39:26 PM
Bitcoins have no dividend or potential future dividend, therefore 
not like a stock.
More like a collectible or commodity. 

285
60
O
n th
e Requi
rement 
o
f a T
ransacti
o
n Fee
S
A
TOSHI’S
 ADVICE 
i
s to allow some transactions 
to b
e pr
o
cessed 
even if they do not ha
ve transaction fees. Curr
ently
, miners
 ar
e still 
being rewar
ded w
ith bi
tcoins, b
ut this is scheduled to sto
p w
hen 
all 21 million bit
coins ha
ve be
en mined—somewhere in the middle of 
the 22
nd
 cent
ur
y
. A
t that poin
t, transaction fees might become ma
nda
-
tory so t
hat min
ers are a
ppr
opriate
ly rewarded f
or use of their resour
ces.
Al
w
a
ys p
a
y tr
ansactio
n fee?
Posted by jgarzik, September 07, 2010, 03:17:34 AM
T
o accurately reﬂect that processing a transaction has certain 
resource costs across the network, I propose that tx fee be 

THE BOOK O
F SA
TOSHI
286
required for 
every
 transaction after X datetime (where X is a 
few months in the future).
Re: Al
w
a
ys p
a
y tr
ansactio
n fee?
Posted by satoshi, September 07, 2010, 04:32:21 PM
Another option is to reduce the number of free transactions 
allowed per block before transaction fees are required.  Nodes 
only take so many KB of free transactions per block before they 
start requiring at least 0.01 transaction fee.
The threshold should probably be lower than it currently is.
I don’t think the threshold should ever be 0.  We should always 
allow at least some free transactions.
Re: Al
w
a
ys p
a
y tr
ansactio
n fee?
Posted by satoshi, September 08, 2010, 05:30:14 PM
Currently, paying a fee is controlled manually with the -paytxfee 
switch. It would be very easy to make the software automatically 
check the size of recent blocks to see if it should pay a fee. We’re 
so far from reaching the threshold, we don’t need that yet. It’s a 
good idea to see how things go with controlling it manually ﬁrst 
anyway.
It’s not a big deal if we reach the threshold. Free transactions 
would just take longer to get into a block.
I did a rough tally of 4000 blocks from around 74000-78000. This 
is excluding the block reward transactions:

O
n the Requirement o
f a Transactio
n Fee
287
There were average 2 transactions per block, 17 transactions per 
hour, 400 transactions per day.
Average transaction bytes per block was 428 bytes, or 214 bytes 
per transaction.
The current 
threshold is 
200KB per block, 
or about 
1000 transactions 
per block. 
I think 
it should be 
lowered to 
50KB per block. 
That would 
still be 
more than 
100 times the 
average transactions 
per block.
The threshold can easily be changed in the future. We can decide 
to increase it when the time comes. It’s a good idea to keep it 
lower as a circuit breaker and increase it as needed. If we hit the 
threshold now, it would almost certainly be some kind of ﬂood and 
not actual use. Keeping the threshold lower would help limit the 
amount of wasted disk space in that event.
Re: Al
w
a
ys p
a
y tr
ansactio
n fee?
Posted by satoshi, September 23, 2010, 04:08:35 PM
Quote from: satoshi on September 08, 2010, 05:30:14 PM
The current threshold is 200KB per block, or about 1000 
transactions per block.  I think it should be lowered to 50KB 
per block.  That would still be more than 100 times the 
average transactions per block.
I implemented this change in SVN rev 157.
The reason I previously made it so high was to allow very large 
transactions without hitting the transaction fee.  The threshold was 
around 26,000 BTC for transactions made of 50 BTC generated 
coins.  Even though it was 100 times easier to generate back then, 
only a few people ever encountered the fee at that level.  The new 
threshold puts it at around 11,000 BTC for sending generated 

coins.  It would mostly only be reached with generated bitcoins.  If 
you bought your bitcoins, they’ll be denominated in larger 
transactions and won’t be anywhere near the fee limit, unless you 
bought them in several hundred separate transactions.  Even if you 
do reach the fee level, you only have to pay it once to bundle your 
little transactions together.

289
61
O
n Sites with 
CAPT
CHA an
d P
a
yp
al 
Requi
rements
S
OMEO
NE PROPOS
ES
 a few other possible wa
ys in which Bit
-
coin co
u
ld be usef
ul. Sat
oshi’
s repl
y addresses the one rega
rding 
websi
tes with both 
CAPTCH
A
 a
nd
 Pa
y
Pa
l
 requir
ements.
T
he Nich
e List
Posted by kiba, September 23, 2010, 04:00:16 PM
This is Operation Economic Growth. Our mission is to grow 
the bitcoin economy by making ever
yone specialize in a 
narrow range of good and ser
vices.

THE BOOK O
F SA
TOSHI
290
Simply put, announce what you want to consume and I’ll add 
it to the list. Somebody then will announce that he will tr
y to 
enter that niche. There can be competition within niches too, 
but there are other niches to ﬁll.
W
e’ll hold those people “accountable” for their niches by 
plodding, encouraging, starting a thread and then getting 
disappointed when the ser
vice didn’t come online etc. 
W
anted Niches:
 
 
1. 
 
craigslist like classiﬁed ads for locale.
 
 
2. 
 
“Mechanical T
urk”-like site that list simple jobs for people 
to do. Suggested by noagendamarket in the Stable 
Exchange Rate? topic of the Economic forum.
 
 
3. 
 
Beer supply store. Malt, yeasts, hops, etc.
 
 
4. 
 
Plant store for selling various herbs and stuff.
 
 
6. 
 
Hacker Academy
. Free educational video. Flat tutiion fee 
classes. Pay as you go for personal tutors.
 
 
7. 
 
Dating site that accept bitcoins.
 
 
8. 
 
Easy encr
yption and backup ser
vice.
Niche ﬁlled or being worked on: 
 
 
1. 
 
Advertising clearing house like http://projectwonder
ful.
com. Suggested by mskwik.(I used projectwonderful to 
make tiny bit of money
. I wonder if I can get more money 
from a bitcoin advertising clearing house) noagenda 
offered a large bounty on it and being worked on 
Biomike.
 
 
2. 
 
Download site like rapidshare and other crappy host. 
Inconvenient captcha and required paypal. Bitcoin 
can possibly take both roles and streamline the whole 
process. Suggested by Kiba. T
aken by Hippich. 
Eventually sprawned 3 competitors.
 
 
3. 
 
Freelancer site. T
aken by whichspace.
 
 
4. 
 
Pizza order system. Y
ou can order on the web, from the 

O
n Sites with Captcha and P
ayp
al Requirements
291
commandline, from your smartphone, sms, etc. T
aken by 
mizer
ydearia.
Re: T
he Nich
e List
Posted by satoshi, October 06, 2010, 11:10:31 PM
Quote from: kiba on September 23, 2010, 04:00:16 PM
1. Download site like rapidshare and other crappy host. 
Inconvenient captcha and required paypal. Bitcoin can 
possibly take both roles and streamline the whole process.
Repeating myself here, but there is open source software for 
that, so it would just be a matter of bolting on a Bitcoin payment 
mechanism.  One good one I found was Mihalism Multi Host.  It’s 
designed as a free host, so it would just need a few tweaks to 
loosen up restrictions consistent with paid use.

293
62
O
n Sho
r
t Messages  
i
n th
e Bl
ock Chai
n
T
HE BLOCK CH
AIN
 
is the p
ublic ledger of all bi
tcoin transac
-
tions a
nd is shared wi
t
hin the peer-to-peer networ
k. A
t pres
-
ent, i
t conta
ins only the transactions them
s
elves. I
n this thread, 
someone p
roposes adding ano
ther piece of info
r
ma
t
ion within each 
transaction con
tained in the block chain tha
t would be the equivalen
t 
of the “
Not
e
” s
ect
ion o
n b
ank checks. U
nlike these, however
, this note 
would be pub
lic and so visible to all. Sa
toshi expres
s
ed concerned that 
someone co
uld publish in this no
te some informa
tion that was m
e
an
t 
to be kept p
rivate, s
uch as a customer acco
unt n
umber
.
N
e
vertheless, this feat
ure is curren
t
ly being con
sidered for a fut
ure 
updat
e of Bit
coin but is n
ot yet ava
il
able as o
f this wr
iting. F
or now
, 
only a third pa
r
ty ser
vice such as 
blockchain.info
 a
llows users to add 
extra text info
r
matio
n, but it i
s not part of the block cha
in itself.

THE BOOK O
F SA
TOSHI
294
Miners ha
ve the ab
i
lity to add some extra t
ext in t
he block. As a 
ma
tter of fact, the very rst block crea
ted by Sat
oshi Nakam
oto
, block 
0, has the follo
wing message in i
t:
“e Times 03/J
an/2009 Chancell
or on b
rink  
of second bailout fo
r banks”
e message i
s in ASCII encode
d form b
ut easy to extract for those 
who k
now how
.
Suggestio
n: Allow s
ho
r
t messages to b
e 
s
ent togeth
er with bit
co
ins ?
Posted by ShadowOfHarbringer
, October 23, 2010, 
03:11:17 PM
Bitcoin is great, but it misses one thing that usual bank 
transfers have: payment title.
Perhaps it should be possible to include short (<=512 bytes) 
message for each transaction. 
The message could be encr
ypted with public/private keys so 
only the receiver can see its contents.
What do Y
ou think ?
PS. 
I might be wrong, but the messages could also be used to 
increase randomness of hashing process by the way
, couldn’t 
they ? If not, never mind.

O
n Shor
t Messages in th
e Block Chai
n 
295
Re: Suggestio
n: Allow s
ho
r
t messages to b
e 
s
ent togeth
er with bit
co
ins ? 
Posted by satoshi, October 23, 2010, 07:02:57 PM
ECDSA can’t encrypt messages, only sign signatures.
It would be unwise to have permanently recorded plaintext 
messages for everyone to see.  It would be an accident waiting to 
happen.
If there’s going to be a message system, it should be a separate 
system parallel to the bitcoin network.  Messages should not be 
recorded in the block chain.  The messages could be signed with 
the bitcoin address keypairs to prove who they’re from.

297
63
O
n Han
dli
n
g a 
T
r
ansacti
o
n Sp
a
m 
Fl
oo
d A
tt
ack
I
N THIS EX
CH
ANGE, 
Sa
toshi talks about the in
t
roduction o
f 
chan
ges in the soware tha
t wil
l make it mo
re econo
mica
lly di
-
cult for so
meone to “
spam
” the network with m
ultiple tran
s
actions.
T
r
ansactio
n / sp
a
m floo
d a
t
t
ack 
currentl
y und
er w
a
y
Posted by jgarzik, November 19, 2010, 07:02:38 PM
Someone is apparently “testing” the main bitcoin network by 
ﬂooding it with 0.01 BTC transactions from A->A and B->B, 

THE BOOK O
F SA
TOSHI
298
where A and B are two random public keys.  Y
ou can watch 
at http://theymos.ath.cx:64150/bbe 
W
e’ve hit the free transaction limit on each block, for many 
blocks now -- appears to be ~219 free transactions per 
block.  “real” transactions do not appear DoS’d at this time, 
presumably due to logic that prioritizes, in part, based on 
transaction value.
<soapbox> 
Fr
ee T
X’
s ar
e just asking f
or permanent leve
l of 
spam. er
e should be a cost to each T
X, even if it
’
s 
only 0.001 B
TC or so
. 
</soapbox>
Re: T
r
ansactio
n / sp
a
m floo
d a
t
t
ack 
currentl
y und
er w
a
y
Posted by satoshi, November 19, 2010, 11:50:24 PM
Quote from: creighto on November 19, 2010, 08:29:12 PM
Perhaps in addition to the age priority rule recently 
implimented, there should be a minimum age rule without a 
transaction fee.  Said another way
, perhaps a generation rule 
that says that a free transaction must be 3 blocks deep before 
it can be transfered again for free.  This will still allow real 
users to immediately spend new funds if they have to, while 
still permitting real users to reshufﬂe funds to suit their needs 
without an overhead cost.  I think that this would signiﬁcantly 
inhibit the type of spamming attack that is currently under
way
.
I’m doing something like that.  Priority is a more formalised version 
of the concept you’re describing.

O
n Handlin
g a Transactio
n Spam Floo
d A
ttack
299
Quote from: FreeMoney on November 19, 2010, 05:39:44 
PM
As it stands now 3.15 has a lot of free transaction space 
and that space is given ﬁrst to transactions with the highest 
[age]*[value]/[size] correct? W
ould it be reasonable to 
make some arbitrar
y por
tion of the free space require 
[age]*[value]/[size] > C ?
Maybe set C so that a standard 1BTC transaction can get 
into the main free area on the next block. And a .1 can get 
in after waiting about 10 blocks. And make the area which 
allows [age]*[value]/[size] < C to let in about a dozen 
transactions or so.
Y
es, like this.  And the no-priority-requirement area is 3K, about a 
dozen transactions per block.
I just uploaded SVN rev 185 which has a minimal priority 
requirement for free transactions.  Transaction ﬂoods are made 
up of coins that are re-spent over and over, so they depend on 
their own 0 conf transactions repeatedly.  0 conf transactions have 
0 priority, so free transactions like that will have to wait for one 
transaction to get into a block at a time.
Version 0.3.15 doesn’t write transactions using 0 conf 
dependencies unless that’s all it has left, so normal users shouldn’t 
usually have a problem with this.
I think this is a good compromise short of making the default fee 
0.01.  It’s not so much to ask that free transactions can only be 
used to turn coins over so often.  If you’re using free transactions, 
you’re taking charity and there has to be some limit on how often 
you can use it with the same coins.
We’ve always said free transactions may be processed more 
slowly.  Y
ou can help ensure your transactions go through quickly 
by adding -paytxfee=0.01.

301
64
O
n Poo
l Mi
n
i
n
g 
T
ech
n
icaliti
es
I
N THIS THREAD
, the concept o
f how Bi
tcoin pool mining wor
ks 
is discussed and how i
t should be done t
o avoid c
heaters becom
-
ing part of the pool witho
ut sharing. T
oday
, mining pools are the 
larg
est contribu
tors t
o mining. Mining pools were no
t initially a con
-
cept tha
t Satoshi N
akamot
o des
cribed. ey came up lat
er as a sugges
-
tion b
y s
omeon
e on the forum when the diculty of mining began to 
increase as in
terest in Bi
tcoin incr
e
ased. e best analog
y to a bi
tcoin 
mining pool is co-wor
kers sharing lo
tter
y tickets.

THE BOOK O
F SA
TOSHI
302
Coo
pera
tive min
i
ng
Posted by slush, November 27, 2010, 01:45:41 PM
Hi all, 
 
since the bitcointalk has been hacked few months ago I 
temporar
y lost the access to this forum. Now the access is 
recovered, but I’m not planning to continue with the pool 
support in this thread anymore, for more reasons. Mostly as 
newbies cannot post here, it cannot work as a full customer 
support; I’ve received many complains about this par
ticularly
. 
Then, it is spaghetti-style forum and it is ver
y hard to follow 
the discussion.
Few days ago we started ofﬁcial pool suppor
t ticket system 
at http://support.bitcoin.cz. This suppor
t system is integrated 
also with support@bitcoin.cz, so writing an email to suppor
t@
bitcoin.cz is the right place if you need authorized reply from 
one of pool admins anytime soon. Right now we’re processing 
quite long backlog of emails there, but our target is to reply 
to all tickets in 24 hours. On http://support.bitcoin.cz is also 
knowledge base where we’re ﬁlling more and more Q&A 
ever
y day
.
I would like to invite you also to IRC #mining.bitcoin.cz, 
where is quite many people online, ready to chat and provide 
basic help with all the stuff.
I’ll leave this thread open for unofﬁcial discussion, but it is out 
of my time possibilities to follow the discussion here.
Join us on http://mining.bitcoin.cz! 
EDIT 27.12.2010: wiki page about pooled mining 
EDIT 17.03.2011: DaCoinMinster published 
GreaseMonkey script which tweaks the pool 
website - it’
s 3rd party tool, use it on your own 
risk.
 

O
n Pool Min
ing T
echnicaliti
es
303
What is Pooled Mining?
 
Pooled mining is a way for multiple users to work together to 
mint bitcoins, and to share the beneﬁts fairly
.
Why do I need it?
 
Bitcoins are ordinarily only ever created in chunks of 50 at a 
time, with the whole 50 paid to a single person. Further
more, 
the race to get the 50 BTC prize in a given block is highly 
competitive.
If you set out mining on your own, it may be a long time before 
you can make a return. Pooled mining allows you to receive 
smaller
, more frequent, steadier payouts instead. If you have a
 
slower computer
, or a CPU miner
, then pooled mining may be 
the only way that you will ever mint any bitcoins at all. 
How do I get started?
 
Y
ou need less than 10 minutes to start mining in pool. Visit 
http://mining.bitcoin.cz and follow instructions.
Original post:
Once people started to use GPU enabled computers for 
mining, mining became ver
y hard for other people. I’m on 
bitcoin for few weeks and didn’t ﬁnd block yet (I’m mining on 
three CPUs). When many people have slow CPUs and they 
mining separately
, each of them compete among themselves 
AND against rich GPU bastards ;-), because ever
ybody 
counts sha256 hashes from the same range. T
wo separate 
CPUs with 1000khash/s isn’t the same as one 2000khash/s 
machine!. But new feature of the ofﬁcial bitcoin client called 
‘getwork’ now enables work of many computers together
, so 
they don’t compete. Because there is now standalone CPU 
miner (thanks to jgarzik!) and ‘getwork’ patch is in ofﬁcial 
client now
, I have an idea:
Join poor CPU miners to one cluster and increase their chance 
to ﬁnd a block!

THE BOOK O
F SA
TOSHI
304
How that should work? There will be web page where you 
can register
, enter your wallet address and get URL and your 
personal rpcuser/rpcpassword for your CPU/GPU miners. 
When you start own miner with these credentials, ser
ver 
will send you work which was not calculated yet by other 
members of cluster
.
But when your client ﬁnd winning hash, you do not get full 
reward for block (50BTC right now), but only proportional 
part, which you calculate. When you offer 1000khash/s 
for one day and whole cluster perfor
mance will be 
20000khash/s and it takes two days to ﬁnd a block, your 
reward will be (50/20/2=)1.25BTC.
Advantages? When you have poor standalone computer
, 
you need to wait many weeks or even months for ﬁnding 
full 50BTC reward. When you join cluster like this, you will 
constantly receive small amount of bitcoins ever
y day or week 
(depends on full cluster perfor
mance).
Disadvantages? Y
ou need to trust in central authority (me) that 
I don’t steal block for myself. But I’m gooﬁng around for few 
week and I’m amazed with bitcoin idea, so I don’t plan to 
steal anybody right now :-).
Another possible problem is that somebody will ask for new 
work ver
y often, but in fact he will not count real hashes. 
In this case it will look like he has ver
y strong CPU and he 
should get big part of reward if cluster ﬁnd a block. But there 
is a simple defense against cheaters: Central ser
ver sometimes 
send work which leads to ‘winning’ hash. W
orker which don’t 
return this hash as matching will be permanently banned 
(login/password and IP address). This was succesfully solved 
by letting miners calculate proof-of-work. It is not anymore 
possible to be a part of cluster and not count hashes.
Are you interested in?

O
n Pool Min
ing T
echnicaliti
es
305
Re: Coo
pera
tive min
i
ng
Posted by ribuck, November 27, 2010, 10:21:02 PM
Quote from: grondilu on November 27, 2010, 10:21:27 PM
T
o me it seems that cooperative mining is a tough task, because 
the honnesty of participants has to be checked. What’
s preventing 
someone to run a modiﬁed version of the client, that would just 
keep generated bitcoin for himself, while receiving bitcoins from 
others ?
<sigh>
Either I haven’t been very good at explaining why there’
s no 
possibility to cheat, or I’m wrong. But if I’m wrong, no-one has 
posted a speciﬁc objection. So I’ll tr
y to explain it again, by 
presenting a speciﬁc design to show that a dishonest client 
cannot cheat.
Suppose I operate a pooled mining ser
ver
, and I recruit some 
clients who wish to pool their mining.
My ser
ver asks each client to do some hashing for it. It asks 
each client to submit any hashes they ﬁnd that are above a 
certain threshold of difﬁculty
. The ser
ver chooses a difﬁculty 
that is one-fortieth (1/40th) of the current “ofﬁcial” difﬁculty 
level.
My ser
ver gets a constant trickle of candidate hashes sent 
back by the remote mining clients. Ever
y now and then, one 
of those hashes meets the ofﬁcial difﬁculty level and my ser
ver 
can generate a block, which earns my ser
ver 50 bitcoins.
I now distribute bitcoins to the remote mining clients, at the 
rate of one bitcoin for each hash that was submitted for the 
current block that was at or above 1/40th of the ofﬁcial 
difﬁculty level.

THE BOOK O
F SA
TOSHI
306
In the long run, I would expect to distribute 40 coins out of 
ever
y 50 that my ser
ver generates, although there will be 
some ﬂuctuation from block to block. Nothing in this scheme 
requires the clients to be honest, because there is no way that 
a dishonest client can cheat!
The client is calculating hashes that will generate 50 BTC 
for my ser
ver
. Those same hashes are not of any use to a 
dishonest client. They cannot be used to generate 50 BTC for 
the dishonest client, because a different hash code is needed 
to encode the payment of the generated bitcoins to someone 
else. And if the dishonest client tries to cheat by generating 
hashes that will pay the generated bitcoins to themselves, then 
the hash codes they submit won’t validate at my server and I 
won’t distribute any share of the payouts to them.
So this scheme requires absolutely no trust of the client.
This scheme also does not require the mining client to have 
faith that the ser
ver is honest. If the ser
ver advertises that it is 
paying out 1BTC for each hash that is at least 1/40th of the 
ofﬁcial difﬁculty level, then ever
y client that submits an “easy” 
hash for a block that was generated can check that they 
received their bitcoin. Any fraud would show up immediately
.
Re: Coo
pera
tive min
i
ng
Posted by satoshi, November 28, 2010, 04:03:30 PM
ribuck’s description is spot on.
Pool operators can modify their getwork to take one additional 
parameter, the address to send your share to.
The easy way for the pool operator would be to wait until the next 
block is found and divy it up proportionally as: 

O
n Pool Min
ing T
echnicaliti
es
307
user’s near-hits/total near-hits from everyone
That would be easier and safer to start up.  It also has the 
advantage that multiple hits from the same user can be combined 
into one transaction.  A lot of your hits will usually be from the 
same people.
The instant gratiﬁcation way would be to pay a ﬁxed amount for 
each near-hit immediately, and the operator takes the risk from 
randomness of having more or less near-hits before a block is 
found. 
Either way, the user who submits the hit that solves the block 
should get an extra amount off the top, like 10 BTC.
New users wouldn’t really even need the Bitcoin software.  They 
could download a miner, create an account on mtgox or mybitcoin, 
enter their deposit address into the miner and point it at anyone’s 
pool server.  When the miner says it found something, a while later 
a few coins show up in their account.
Miner writers better make sure they never false-positive near-hits. 
Users will depend on that to check if the pool operator is cheating 
them.  If the miner wrongly says it found something, users will 
look in their account, not ﬁnd anything, and get mad at the pool 
operator.

309
65
O
n Wi
kiLeaks 
 U
sing
 Bi
tc
oin
I
N LA
TE 2010,
 go
vernments o
f the world wer
e att
empting t
o exer
t 
pr
essure on W
ikiL
eaks by cutting o
 its sources o
f funding, which 
consi
sted primarily of o
nline donatio
ns through credi
t c
ar
d p
ay
-
men
ts and Pa
yPal.
When P
ayP
al announced tha
t it would block serv
ice to W
i
kiLe
aks, 
Sat
oshi stated tha
t, in his opinion, B
itcoin was n
ot yet ready to act as 
a replacemen
t.
ht
tp://ww
w
.wired.com/threa
tle
vel/2010/12/paypal-wikileaks/

THE BOOK O
F SA
TOSHI
310
Wi
kileaks co
nt
act in
fo?
Posted by genjix, November 10, 2010, 12:49:16 PM
Hey
, I wanted to send a letter to Wikileaks about Bitcoin since 
unfortunately they’ve had several incidents where their funds 
have been seized in the past. 
http://wikileaks.org/media/support.html
Anyone know where to send a message to them?
Re: Wi
kileaks co
nt
act in
fo?
Posted by wumpus, December 04, 2010, 08:47:59 AM
Paypal just blocked them, and they’re tr
ying to get other US 
banks do the same. This would be a great moment to open 
bitcoin donations. 
Re: Wi
kileaks co
nt
act in
fo?
Posted by RHorning, December 04, 2010, 10:17:44 PM
Quote from: Hal on December 04, 2010, 08:43:07 PM
Looking on the bright side, if Bitcoin did get known as the 
Wikileaks currency
, attacked by governments all over the world, at 
least we’d get our Wikipedia page back!
This is so true. There certainly wouldn’t be a shortage of 
“reliable sources” about Bitcoins at that point. I think it would 
likely show up on the front page of most newspapers and be 
talked about extensively on both radio talk shows and the 
other broadcast networks too.

O
n WikiLeaks Usin
g Bitco
in 
311
For myself, I’m getting to the point to say “bring it on” in 
regards to Wikileaks. Note that I’m using my real name here 
instead of a psuedonym and I’m willing to personally say 
“bring it on” in terms of being associated with Bitcoins as 
a project. I’ve had police come into my house without my 
permission already and do all kind of stupid stuff, so for me 
that line being crossed has already happened. I am also 
connected to enough people politically that if something was 
to happen to me that it would be noted and things would 
happen too.
It is the morally correct thing to be supporting Wikileaks, and 
if they’ll take a few of my bitcoins, I not only want to donate 
but to let the world know that they can donate to Wikileaks 
through Bitcoins as well.
I can’t speak for everybody here in the Bitcoins community 
but I am speaking for myself on this matter
, and I’m not afraid 
of anything that the U.S. government might do to me if I was 
associated with backing Wikileaks ﬁnancially
. If anything, 
it would show that I no longer live under a constitutional 
government any more. If the U.S. government wants to tip 
their hand to expose themselves in that way
, so be it. If the 
U.S. government kills me or puts me in jail, I’ll cer
tainly set a 
way for this community to ﬁnd out. I really don’t think it would 
come to that either
, but I don’t care if it did.
If I have to “vote” on this matter
, I would encourage the Bitcoin
 
community to take up the plate like we did with the EFF and 
encourage Wikileaks to put up a Bitcoin address on their 
website for donations. It would bring in some new blood into 
the Bitcoin community regardless, and it might be beneﬁcial to 
Wikileaks as well. Leave it to W
ikileaks to see if they want to 
use Bitcoins or not. In terms of governmental review of Bitcoins,
 
we know that is going to happen sooner or later
, so why are
 
we ﬁghting that inevitable result? Anything other than a low-key 
investigation is only going to make more people interested in 

THE BOOK O
F SA
TOSHI
312
Bitcoins, which is only going to help the project even more. 
It can’t be killed as a project, only slowed down a little bit in 
its growth at this point and more likely its adoption would be 
accelerated by any kind of publicity that would happen.
The only possible concern I would have is over how sound
 
the protocol itself is right now
. If anything, a major ﬂux of new
 
people into Bitcoins would help there too, and the worst that 
could happen is that Bitcoins itself would be broken in some way 
where a new cr
yptocurrency would have to be created ﬁxing the
 
problems of Bitcoins. It is the idea of cr
yptocurrency that would
 
then persist, and it is incredibly hard to censor an idea.
Basically
, bring it on. Let’
s encourage Wikileaks to use Bitcoins 
and I’m willing to face any risk or fallout from that act.
-- Robert S. Hor
ning 
Logan, Utah
Re: Wi
kileaks co
nt
act in
fo?
Posted by satoshi, December 05, 2010, 09:08:08 AM
Quote from: RHorning on December 04, 2010, 10:17:44 PM
Basically
, bring it on. Let’
s encourage Wikileaks to use Bitcoins 
and I’m willing to face any risk or fallout from that act.
No, don’t “bring it on”.
The project needs to grow gradually so the software can be 
strengthened along the way.
I make this appeal to WikiLeaks not to try to use Bitcoin. Bitcoin is 
a small beta community in its infancy. Y
ou would not stand to get 
more than pocket change, and the heat you would bring would 
likely destroy us at this stage.

313
66
O
n a Distri
buted 
Domai
n Na
me Ser
ver
S
OMEO
NE SUGGESTED
 cr
eating a Bi
tcoin clo
ne (an alterna
-
tive currency) that w
ould al
low f
or a distribut
e
d peer-to-peer
 
doma
in name ser
ver system (DNS). I
n addition to co
ntaining 
currencies, transactions s
tored in the block cha
in would also conta
in 
DNS info
rmation an
d could be updated with new transactions. 
Such al
ternative curren
c
y exists today and i
s c
alled Nam
e
coin (see 
ht
tp://ww
w
.namecoin.or
g/
), w
hich allows people t
o register doma
in 
names endin
g in “
.bit
” and associate 
t
hem with an IP addr
ess. Satos
hi 
shar
es his thoughts r
egarding this type of syst
em here. One of the 
ma
j
or benets o
f such decentralized doma
in name ser
vers wo
u
ld 
bypass a g
overnmen
t attem
pt a
t disrupting I
nternet comm
unication
s 
to its ci
tizens, as we ha
ve se
en occur in Eg
ypt in 2011.

THE BOOK O
F SA
TOSHI
314
Re: BitD
NS and Gen
eralizin
g Bit
co
in
Posted by satoshi, December 09, 2010, 09:02:42 PM
I think it would be possible for BitDNS to be a completely separate 
network and separate block chain, yet share CPU power with 
Bitcoin. The only overlap is to make it so miners can search for 
proof-of-work for both networks simultaneously.
The networks 
wouldn’t need 
any coordination. Miners 
would
 
subscribe to 
both networks 
in parallel. They 
would scan 
SHA such that 
if they 
get a 
hit, they potentially 
solve both 
at once. A 
solution may 
be
 
for just 
one of 
the networks if 
one network 
has a lower 
difﬁculty.
I think an external miner could call getwork on both programs and 
combine the work. Maybe call Bitcoin, get work from it, hand it to 
BitDNS getwork to combine into a combined work.
Instead of fragmentation, networks share and augment each 
other’s total CPU power. This would solve the problem that if 
there are multiple networks, they are a danger to each other if the 
available CPU power gangs up on one. Instead, all networks in 
the world would share combined CPU power, increasing the total 
strength. It would make it easier for small networks to get started 
by tapping into a ready base of miners.
Re: BitD
NS and Gen
eralizin
g Bit
co
in
Posted by nanotube, December 09, 2010, 09:20:40 PM
Quote from: satoshi on December 09, 2010, 09:02:42 PM
I think it would be possible for BitDNS to be a completely separate 
network and separate block chain, yet share CPU power with 
Bitcoin. The only overlap is to make it so miners can search for 
proof-of-work for both networks simultaneously
.

O
n a Distributed Domain Name Server
315
sounds excellent in theor
y
... 
Quote from: satoshi on December 09, 2010, 09:02:42 PM
The networks wouldn’t need any coordination. Miners would 
subscribe to both networks in parallel. They would scan SHA such 
that if they get a hit, they potentially solve both at once. A solution 
may be for just one of the networks if one network has a lower 
difﬁculty
.
I think an external miner could call getwork on both programs and 
combine the work. Maybe call Bitcoin, get work from it, hand it to 
BitDNS getwork to combine into a combined work.
seems that the miner would have to basically do “extra work”. 
and if there’
s no reward from the bitdns mining from the extra 
work (which of course, slows down the main bitcoin work), 
what would be a miner’
s incentive to include bitdns (and 
whatever other side chains) ?
ver
y curious to hear your fur
ther thoughts on this. : - )
Re: BitD
NS and Gen
eralizin
g Bit
co
in
Posted by satoshi, December 09, 2010, 10:46:50 PM
Quote from: nanotube on December 09, 2010, 09:20:40 PM
seems that the miner would have to basically do “extra work”. 
and if there’
s no reward from the bitdns mining from the extra 
work (which of course, slows down the main bitcoin work), what 
would be a miner’
s incentive to include bitdns (and whatever other 
side chains) ?
The incentive is to get the rewards from the extra side chains also 
for the same work.

THE BOOK O
F SA
TOSHI
316
While you are generating bitcoins, why not also get free domain 
names for the 
same work
?
If you currently generate 50 BTC per week, now you could get 50 
BTC and some domain names too.
Y
ou have one piece of work.  If you solve it, it will solve a block 
from both Bitcoin and BitDNS.  In concept, they’re tied together by 
a Merkle Tree.  To hand it in to Bitcoin, you break off the BitDNS 
branch, and to hand it in to BitDNS, you break off the Bitcoin 
branch.
In practice, to retroﬁt it for Bitcoin, the BitDNS side would have to 
have maybe ~200 extra bytes, but that’s not a big deal.  Y
ou’ve 
been talking about 50 domains per block, which would dwarf that 
little 200 bytes per block for backward compatibility.  We could 
potentially schedule a far in future block when Bitcoin would 
upgrade to a modernised arrangement with the Merkle Tree on 
top, if we care enough about saving a few bytes.
Note that the chains are below this new Merkle Tree.  That is, 
each of Bitcoin and BitDNS have their own chain links inside 
their blocks.  This is inverted from the common timestamp server 
arrangement, where the chain is on top and then the Merkle 
Tree, because that creates one common master chain.  This is two 
timestamp servers not sharing a chain.
Re: BitD
NS and Gen
eralizin
g Bit
co
in
Posted by satoshi, December 10, 2010, 05:29:28 PM
Piling every proof-of-work quorum system in the world into one 
dataset doesn’t scale.
Bitcoin and BitDNS can be used separately.  Users shouldn’t have 
to download all of both to use one or the other.  BitDNS users 

O
n a Distributed Domain Name Server
317
may not want to download everything the next several unrelated 
networks decide to pile in either.
The networks need to have separate fates.  BitDNS users might 
be completely liberal about adding any large data features since 
relatively few domain registrars are needed, while Bitcoin users 
might get increasingly tyrannical about limiting the size of the 
chain so it’s easy for lots of users and small devices.
Fears about securely buying domains with Bitcoins are a red 
herring.  It’s easy to trade Bitcoins for other non-repudiable 
commodities.
If you’re still worried about it, it’s cryptographically possible to 
make a risk free trade.  The two parties would set up transactions 
on both sides such that when they both sign the transactions, the 
second signer’s signature triggers the release of both.  The second 
signer can’t release one without releasing the other.
Re: BitD
NS and Gen
eralizin
g Bit
co
in
Posted by Hal, December 10, 2010, 07:14:04 PM
Satoshi, are you endorsing the idea that additional block chains 
would each create their own ﬂavor of coins, which would trade 
with bitcoins on exchanges? These chain-speciﬁc coins would be 
used to reward miners on those chains, and to purchase some 
kinds of rights or privileges within the domain of that chain?
Re: BitD
NS and Gen
eralizin
g Bit
co
in
Posted by satoshi, December 10, 2010, 07:55:12 PM

THE BOOK O
F SA
TOSHI
318
Quote from: Hal on December 10, 2010, 07:14:04 PM
additional block chains would each create their own ﬂavor of 
coins, which would trade with bitcoins on exchanges? These 
chain-speciﬁc coins would be used to reward miners on those 
chains, and to purchase some kinds of rights or privileges 
within the domain of that chain?
Right, the exchange 
rate between domains and bitcoins 
would ﬂoat.
A longer interval than 10 minutes would be appropriate for 
BitDNS.
So far in this discussion there’s already a lot of housekeeping data 
required.  It will be much easier if you can freely use all the space 
you need without worrying about paying fees for expensive space 
in Bitcoin’s chain.  Some transactions:
Changing the IP record.
Name change.  A domain object could entitle you to one domain, 
and you could change it at will to any name that isn’t taken.  This 
would encourage users to free up names they don’t want 
anymore.  Generated domains start out blank and the miner sells 
it to someone who changes it to what they want.  
Renewal.  Could be free, or maybe require consuming 
another domain object to renew.  In that case, domain objects 
(domaincoins?) could represent the right to own a domain for a 
year.  The spent fee goes to the miners in the next block fee.
Re: BitD
NS and Gen
eralizin
g Bit
co
in
Posted by Hal, December 10, 2010, 08:12:02 PM
OK so if there are going to be bitdnscoins (aka DCCs, 
DomainChain Coins) then they have to be useful for 

O
n a Distributed Domain Name Server
319
something. Other
wise ever
y BitDNS miner is going to ﬁll 
ever
y block with his own domain name registrations, rather 
than replace one with someone else’
s registration in exchange 
for a transaction fee in a useless currency
.
The rules have to be that you have to spend a certain amount 
of bitdnscoins/DCCs in order to register your names and/or 
do other BitDNS transactions. That’
s the only way to make this 
alternative currency desirable and valuable.
(W
ell we could do like Bitcoin and say there would only ever 
be 22 million DCCs ever created, so they’d get valuable from 
scarcity just like bitcoins. But that seems weak.)
Re: BitD
NS and Gen
eralizin
g Bit
co
in
Posted by satoshi, December 10, 2010, 08:19:39 PM
I agree. All transactions, IP changes, renewals, etc. should have 
some fee that goes to the miners.
Y
ou might consider a certain amount of work to generate a 
domain, instead of a ﬁxed total circulation.  The work per domain 
could be on a schedule that grows with Moore’s Law.  That way the 
number of domains would grow with demand and the number of 
people using it.
Re: BitD
NS and Gen
eralizin
g Bit
co
in
Posted by dtvan, December 11, 2010, 07:43:08 AM
After reading through this whole thread, I’ve got a couple of 
comments that I think would be helpful:

THE BOOK O
F SA
TOSHI
320
1) Ever
yone in the thread seems intent on replacing the 
entire DNS infrastructure in one fell swoop, which I think 
is the wrong approach. The real problem with the DNS 
system as it exists today is that somebody has to own the 
root. At the end of the day
, you have to trust ICANN. What 
the DomainChain/BitDNS system should strictly focus on is 
establishing ownership of domain names. All it needs to track 
is that the holder of Key A owns domain foo.bar
. Once we’ve 
established this shared trust, we can support many different 
DNS infrastructures that can be implemented independently 
from this project. Whatever new systems are created use 
DomainChain/BitDNS to establish which key owns the 
domain, and only allows that individual to insert records for 
that domain. This works out well, since all participants in the 
system can validate that the record they’ve looked up is valid. 
Right now it is easy to get bogged down in all the details of 
managing DNS records, when all we need to do is establish 
a trusted, distributed authority that can form the root of 
DNSSEC, some new p2p DNS, or whatever
.
I’m also thinking this could be used to solve the CA problem 
with HTTPS, since signing your certiﬁcate with the same 
key would prove that I’ve reached the correct ser
ver
. But I 
digress . . .
2) Limiting the TLDs should be a requirement. If this system 
doesn’t inter
-operate with the existing DNS infrastructure by 
preventing name collisions, it will undermine the trust you are 
tr
ying to generate. Even I’m not sure I’m ready to sign up for 
a distributed DNS system if someone new can pick up www
.
mylocalbank.com and cause havok. I’d humbly suggest .web 
as the TLD to use, but anything will work as long as it is short 
and not currently in use.
Right now the focus should be on getting this up and running 
in a way that doesn’t conﬂict with the existing system. If this 
system becomes dominant at some point and needs to tackle 

O
n a Distributed Domain Name Server
321
additional TLDs, that is a “problem” that can be dealt with 
then.
3) Personally
, I think expiring domain names are the way to 
go. Even with relatively expensive renewals today
, there is 
still a ton of junk out there. I can’t imagine how bad it would 
be if you owned a domain forever
. It isn’t asking much to say 
that you have to renew your domain periodically to keep it, 
especially since this shouldn’t be the ripoff that the existing 
system is today
.
I’d like to close out by saying that this is really exciting stuff. 
I’ve read a number of different ideas about how to solve the 
DNS problem, and this is the ﬁrst one I’ve seen that could 
actually solve it (and not just replace ICANN with pick-your-
new-benevolent-dictator).
Re: BitD
NS and Gen
eralizin
g Bit
co
in
Posted by satoshi, December 10, 2010, 08:19:39 PM
@dtvan: all 3 excellent points.  
1) IP records don’t need to be in the chain, just do registrar 
function not DNS.  And CA problem solved, neat. 
2) Pick one TLD, .web +1. 
3) Expiration and signiﬁcant renewal costs, very important.
Quote from: joe on December 11, 2010, 10:53:58 AM
However
, thinking more about this now I suppor
t inclusion of 
additional coinbases / tracking systems in the main network. 
The reason for doing this is so as not to water down CPU 
power into multiple networks. W
e want one strong network, 
so the network should be versatile.
Avoiding CPU power fragmentation is no longer a 

THE BOOK O
F SA
TOSHI
322
reason.  Independent networks/chains can share CPU power 
without sharing much else.  See: http://bitcointalk.org/index.
php?topic=1790.msg28696#msg28696 and http://bitcointalk.
org/index.php?topic=1790.msg28715#msg28715
(N
ote, two o
f Satoshi
’
s earlier posts ar
e included in this thread)
Another thr
e
ad came up o
n the same subject:
Re: Fees i
n BitDNS co
nfus
io
n
Posted by galeru, December 09, 2010, 07:45:38 PM
A bunch of the current debate about including BitDNS or BitX 
makes assumptions that miners will include transactions or not 
based on some rather ﬁne-grained conditions, while none of the 
standard code includes any sort of implementation that allows
 
non-programmers to make decisions like that. How will I, the 
user
, ﬁgure out what sor
t of fees have to go into a transaction?
Re: Fees i
n BitDNS co
nfus
io
n
Posted by jgarzik, December 09, 2010, 11:07:04 PM
Quote from: davout on December 09, 2010, 09:08:55 PM
Just wondering about the following example : 
I broadcast a transaction, sending X coins to some address. 
Doesn’t get included in blocks for a while because I don’
t include 
a fee.
Do I have a way to cancel it and broadcast it again with a fee this 
time ?

O
n a Distributed Domain Name Server
323
See the discussion of locktime (https://bitcointalk.org/index.
php?topic=1786.msg22119#msg22119) 
for transaction replacement.
Re: Fees i
n BitDNS co
nfus
io
n
Posted by satoshi, December 09, 2010, 11:58:54 PM
Not locktime.
There’s a possible design for far in the future:
Y
ou intentionally write a double-spend.  Y
ou write it with the same 
inputs and outputs, but this time with a fee.  When your double-
spend gets into a block, the ﬁrst spend becomes invalid.  The 
payee does not really notice, because at the moment the new 
transaction becomes valid, the old one becomes invalid, and the 
new transaction simply takes its place.
It’s easier said than implemented.  There would be a fair amount 
of work to make a client that correctly writes the double-spend, 
manages the two versions in the wallet until one is chosen, 
handles all the corner cases.  Every assumption in the existing code 
is that you’re not trying to write double-spends.
There would need 
to be some changes on 
the Bitcoin Miner side 
also, to make 
the possibility to accept a 
double-spend into the 
transaction pool, but 
only strictly if the inputs 
and outputs match and 
the transaction fee 
is higher.  Currently, double-spends 
are never 
accepted into the 
transaction pool, so every node 
bears witness to 
which transaction it 
saw ﬁrst by working to 
put it into a block.

325
67
O
n a 
PC Wo
rld
 
Ar
ticle o
n B
it
co
i
n
 
an
d Wi
kiLeak
s
 
Ki
cki
n
g th
e
 
 
H
o
rn
et
’
s Nest
I
N LIGHT
 OF THE ISSUES
 t
hat W
ikiL
eaks was bringing to the 
for
e and the possible r
ole that Bi
tcoin could pla
y in help
ing with 
W
ikiLe
aks
’
s funding, 
PC W
orld
 posted an article re
lated to Bi
tcoin. 
Clearly
, Bit
coin was starting to garner a
tten
t
ion in the pr
ess. Wha
t is 
int
eresting is Sa
toshi
’
s commen
t referen
cing W
ik
iLeaks “k
icking the 
hornet
’
s nest”
. Her
e is a link to the article in 
PC W
orld, 
f
ollowed b
y 
Sat
oshi’
s commen
t.

THE BOOK O
F SA
TOSHI
326
“
C
ould the Wikile
aks Sc
andal L
ead to N
e
w V
ir
tual Curre
nc
y?
”
ht
tp://ww
w
.p
cworld.co
m/art
icle/213230/could_wikileaks_s
can
-
dal_lead_to_new_vir
tual_currency
.html
Re: PC Wo
rld Ar
ticle o
n Bit
co
in
Posted by satoshi, December 11, 2010, 11:39:16 PM
It would have been nice to get this attention in any other context. 
WikiLeaks has kicked the hornet’s nest, and the swarm is headed 
towards us.

327
68
Sa
t
os
h
i’
s L
a
st Fo
ru
m 
Post
: Relea
s
e o
f 
B
it
co
i
n 0.3.19
N
INETEEN HO
URS
 aer the “
Hornet
’
s nest
” p
ost, Sa
toshi 
writes his last f
orum p
ost befor
e retrea
t
ing from “
public 
life
”
. He posted it o
n 
bitcointalk.org
. I
t was his last forum 
post prior to tha
t made in Ma
rch 2014 on the p2p
founda
t
ion fo
rum.
Added so
me DoS limits, removed  
safe mo
de (0.3.19)
Posted by satoshi, December 12, 2010, 06:22:33 PM

THE BOOK O
F SA
TOSHI
328
There’s more work to do on DoS, but I’m doing a quick build of 
what I have so far in case it’s needed, before venturing into more 
complex ideas.  The build for this is version 0.3.19.
- Added some DoS controls 
As Gavin and I have said clearly before, the software is not at all 
resistant to DoS attack.  This is one improvement, but there are still 
more ways to attack than I can count.  
I’m leaving the -limitfreerelay part as a switch for now and it’s 
there if you need it. 
- Removed “safe mode” alerts 
“safe mode” alerts was a temporary measure after the 0.3.9 
overﬂow bug.  We can say all we want that users can just run with 
“-disablesafemode”, but it’s better just not to have it for the sake of 
appearances.  It was never intended as a long term feature.  Safe 
mode can still be triggered by seeing a longer (greater total PoW) 
invalid block chain.
Builds: 
http://sourceforge.net/projects/bitcoin/ﬁles/Bitcoin/bitcoin-0.3.19/
As o
f Mar
ch 14, 2014, this is Satoshi
’
s last post on p2pf
oundatio
n on 
Frida
y Mar
ch 7
th
, 2014:
I am not Dorian Nakamoto
is was in reaction to a m
agazine
’
s publica
tion that cla
imed to have 
identied Bi
tcoin Sa
toshi Naka
moto as a man li
ving in Ca
lifornia with 
the name o
f Dorian Satoshi N
a
kamo
to. 

329
69
Em
ai
ls t
o Dusti
n 
T
r
a
mmell
T
HE FOLL
OWING 
a
re direct email excha
nges between Satos
hi 
N
akamoto an
d D
ustin T
rammell tha
t Dustin T
rammell has 
gener
ously made a
vailable fo
r publica
t
ion.
Email 1—T
imest
a
mp and b
it
co
in ma
turit
y
is rst ex
change co
ncerns timestamp documen
t s
er
vices and Bit
-
coin mining m
aturity
. ese were di
s
cussed later in a pub
lic forum, 
bu
t Satoshi addr
esse
d them rst in a priva
te con
versa
t
ion with Dustin 
T
rammell.
From: “Satoshi Nakamoto” satoshi@vistomail.com

THE BOOK O
F SA
TOSHI
330
To: dtrammell@dustintrammell.com 
Date: Tue, 13 Jan 2009 02:33:28 +0800 
Subject: Re: Bitcoin v0.1 released
I’m currently reading through your paper
. At the timestamp 
ser
ver section you mention newspapers and usenet, so I 
thought you might be interested in this if you have not seen it 
already:
http://www
.publictimestamp.org/
Thanks, I hadn’t seen that yet. It looks very well presented.
There was an older one that’s been running for a long time 
that publishes its hashes to Usenet. I’m surprised this one isn’t 
using Usenet, although it is kind of difﬁcult to get access to post 
to Usenet in an automated way these days. If they can get a 
magazine or newspaper to publish their hashes, it would work a lot 
easier in court for their purposes. Bitcoin and all timestamp servers 
share the basic functionality of periodically collecting things into 
blocks and hashing them into a chain.
By the way
, I’m also currently running the alpha code on one 
of my workstations. So far it has two “Generated” messages, 
however the “Credit” ﬁeld for those is 0.00 and the balance 
hasn’t changed. Is this due to the age/maturity requirement 
for a coin to be valid?
Right, the credit ﬁeld stays 0.00 until it matures, then it’ll be
50.00. Do you think it would be clearer if I left the credit ﬁeld 
blank until it matures? I should put some text in the transaction 
details (when you double click on it) explaining how it works. (was 
it obvious you can doubleclick on a line for details?)
Be sure to upgrade to v0.1.3 if you haven’t already. This version 
has really stabilized things.
Satoshi

Emails to Dusti
n Trammell
331
Email 2—Fo
llow up
From: “Satoshi Nakamoto” satoshi@vistomail.com
To: dtrammell@dustintrammell.com 
Date: Tue, 13 Jan 2009 15:55:13 +0800 
Subject: 
Re: Bitcoin v0.1 released
It actually posts the hash blocks to a Google Group called 
‘proof-hashes’, so similar result as if it were posting to Usenet.
http://groups.google.com/group/proof-hashes
Since I run that group, and it’
s sole purpose is to archive 
proof-of-work hashes, feel free to join an account to have your 
system post there as well if you like.
Sweet, I was looking for a group like that on Usenet at one point 
to see what I would use if I needed, and nothing really ﬁt. I’m sure 
Google groups is a lot easier to post to.
There are some scenarios where a Usenet or Google group 
could be used as a supplemental defence. Bitcoin is at its most 
vulnerable in the beginning when the total network CPU power is 
small. That’s offset by the fact that the incentive to attack it is also 
low when it’s small.
Hopefully the easy solution of just growing up and getting past that 
stage will work. If not, there are ways a Google group could help, 
if it really came to that.
Electronic currency and cr
yptography are two things that I am 
ver
y interested in so as you would assume I was drawn to this 
project immediately when I saw it posted to the Cr
yptography 
email list. Feel free to ping me for feedback or to test out new 
features, I’ll be happy to help out.

THE BOOK O
F SA
TOSHI
332
We deﬁnitely have similar interests!
Y
ou know, I think there were a lot more people interested in the 
90’s, but after more than a decade of failed Trusted Third Party 
based systems
(Digicash, etc), they see it as a lost cause. I hope they can make 
the distinction, that this is the ﬁrst time I know of that we’re trying 
a non-trust based system. 
When the coins mature, will that generate a new ‘credit’ 
transaction, or will the existing generation transaction line’
s 
credit ﬁeld be updated?
The existing transaction line will change. 
Upon opening version 0.1.3, all four of my transaction 
entries still say ‘unconﬁrmed’, but now the Descriptions say 
‘Generated (not accepted)’.
Does this mean that some other node had extended the chain 
ﬁrst and my coins were generated in a dead branch? If so, 
why did the previous instance of the software not detect 
this immediately and begin generating coins in the winning 
branch? Bug in 0.1.0?
Y
ou’re right, sorry about that. It’s the bug that was ﬁxed in 0.1.3.
The communications thread would get blocked, so you would 
make 
connections, but they would go silent after a while. When you 
found a block, you couldn’t broadcast it to the network, so it didn’t 
get into the chain. Y
ou weren’t receiving anything either to know 
that the network had gone on without you, until you restarted it.
The bug is also what caused bitcoin.exe to fail to exit. The 
communications thread was blocked and failed to exit. Bitcoin 
does a careful shutdown in case it might be in the middle of an 
important transaction, but actually it’s completely safe to kill it.

Emails to Dusti
n Trammell
333
This is all ﬁxed in 0.1.3. If you give me your IP, I’ll send you some 
coins.
One other question I had... What prevents the single node 
with the most CPU power from generating and retaining the 
majority of the BitCoins?
If ever
y node is working independently of all others, if one is 
signiﬁcantly more powerful than the others, isn’t it probable 
that this node will reach the proper conclusion before other 
nodes? An underpowered node may get lucky once in a 
while, but if they are at a signiﬁcant horsepower advantage I 
would expect the majority of BitCoins to be generated by the 
most powerful node.
It’s not like 
a race where if one 
car is twice as fast, 
it’ll always win. 
It’s an SHA-256 
that takes less than a 
microsecond, and each guess 
has an independent 
chance of success. Each computer’s 
chance of 
ﬁnding a hash 
collision is linearly proportional to 
it’s CPU power. A 
computer that’s half 
as fast would get half 
as many coins.
I’ll watch this instance and see how it goes...
Let me know how it goes. If you have any trouble with it, send me 
your debug.log ﬁle. I can often ﬁgure out what went wrong just 
from that.
Satoshi
Email 3—O
n Bit
co
in’
s po
tential
is excha
nge seems to indica
te that Sa
toshi was not expecting such 
rap
id acceptance of B
itcoin.
From: “Satoshi Nakamoto” satoshi@vistomail.com

THE BOOK O
F SA
TOSHI
334
To: dtrammell@dustintrammell.com 
Date: Fri, 16 Jan 2009 03:15:14 +0800 
Subject: 
Re: Bitcoin v0.1 released
I’ve had that address for a while though so hopefully my 
dhcp client is being successful at renewing and not losing my 
address. It does change from time to time, but that address 
should be good for a while.
 There’s at least one node who’s inbound IP keeps changing all the 
time within the same class B. Maybe every time the program is run. 
I wasn’t expecting that.
Do you mind if I CC the rest of this to bitcoin-list or Cryptography?
BTW, bitcoin-list is:
bitcoin-list@lists.sourceforge.net 
Subscribe/unsubscribe page: 
http://lists.sourceforge.net/mailman/listinfo/bitcoin-list 
Archives: 
http://sourceforge.net/mailarchive/forum.php?forum_
name=bitcoin-list
Dustin D. T
rammell wrote:
Satoshi Nakamoto wrote:
Y
ou know
, I think there were a lot more people interested in the 
90’
s, but after more than a decade of failed T
rusted Third Par
ty 
based systems (Digicash, etc), they see it as a lost cause. 
I hope they can make the distinction that this is the ﬁrst time 
I know of that we’re tr
ying a non-trust-based system.
Y
ea, that was the primar
y feature that caught my eye. The real 
trick will be to get people to actually value the BitCoins so that 
they become currency
.

Emails to Dusti
n Trammell
335
 Hal sort of alluded to the possibility that it could be seen as a 
long-odds investment. I would be surprised if 10 years from now 
we’re not using electronic currency in some way, now that we 
know a way to do it that won’t inevitably get dumbed down when 
the TTP gets cold feet.
Even if it 
doesn’t take off straight away, 
it’s now available for use 
by the next 
guy who comes up with 
a plan that needs some 
kind of 
token or electronic 
currency. It could get started 
in a closed system 
or narrow niche 
like reward points, donation tokens, 
currency for a 
game or micropayments 
for adult sites. Once it 
gets bootstrapped, 
there are so 
many applications if you could 
effortlessly pay a few 
cents to a 
website as easily as dropping 
coins in a vending machine. 
It can already be used for pay-to-send e-mail. The send dialog is 
resizeable and you can enter as long of a message as you like. It’s 
sent directly when it connects. The recipient doubleclicks on the 
transaction to see the full message. If someone famous is getting 
more e-mail than they can read, but would still like to have a way 
for fans to contact them, they could set up Bitcoin and give out the 
IP address on their website. “Send X bitcoins to my priority hotline 
at this IP and I’ll read the message personally.”
Subscription sites that need some extra proof-of-work for their free 
trial so it doesn’t cannibalize subscriptions could charge bitcoins for 
the trial.
Satoshi
Email 4—O
n a
t
t
acks and IP ad
dresses 
i
nvol
ved in s
endi
ng b
itco
ins
From: “Satoshi Nakamoto” satoshi@vistomail.com 
To: dtrammell@dustintrammell.com 
Date: Fri, 16 Jan 2009 03:46:30 +0800 

THE BOOK O
F SA
TOSHI
336
Subject: Re: A few thoughts 
. 
. 
.
I group attacks into two classes:
1) Attacks that can only be done by someone actually in the 
chain of communication
2) Attacks that can be done by anyone on the Internet from 
anywhere
Type 1 exposes you to people in your house or company on 
your local LAN, admins at ISPs in between, and the LAN on the 
recipient’s side. Type 2 exposes you to a billion people who can 
self-select to be attackers and get economy of scale when they 
develop one technique to attack multiple victims.
Sending by IP requests a new public key, so yes, it’s vulnerable to 
type 1 man-in-the-middle. If that’s a concern, sending to a
Bitcoin address doesn’t have that vulnerability, although there’s 
a small privacy tradeoff. I have a feeling most of the time people 
will get Bitcoin addresses off of non-SSL websites and unsigned 
cleartext e-mail, which is already vulnerable to type 1 and type 2 
through DNS poisoning.
One solution would be to use both the IP and Bitcoin addresses 
when sending (maybe 1.2.3.4-1Kn8iojk...), where the recipient 
uses the public key of the Bitcoin address to sign the new public 
key to prove that you’re sending to who you think you are. If the 
system starts to be used for real business purposes, I will certainly 
implement that. Another solution is to use SSL.
For now, it’s pretty obvious that if you send to an IP, you didn’t 
give any other identifying information about the recipient, so 
you’re blindly sending to whoever answers that IP.
Another feature for later is an option to encrypt your wallet.
If I understand how that is done correctly
, you just compute the 

Emails to Dusti
n Trammell
337
transaction into the block chain and let the intended recipient 
‘discover’ it, correct? 
That’s correct.
An alternative could be to allow the network nodes to provide 
a resolution ser
vice, where they ask around for the network 
address of a 
BitCoin address, and if that node is online, once a consensus 
is agreed upon by the network for that address the sending 
BitCoin application connects directly there.
It would be nice to only need the Bitcoin address and have the 
IP worked out behind the scenes. Might have privacy or denial 
of service issues. Certainly before another sending method is 
implemented, there’s plenty of time now to fully think through the 
design and make sure it’s the best way.
Satoshi
Email 5—O
n po
tential loss  
an
d the n
eed for backup
From: “Satoshi Nakamoto” satoshi@vistomail.com 
To: dtrammell@dustintrammell.com 
Date: Sat, 17 Jan 2009 02:32:48 +0800 
Subject: Re: A few thoughts 
. 
. 
.
One thing that came to mind on this topic is the potential for 
BitCoin
loss if you have a system failure. The application doesn’t seem 
to store any data in the director
y that it runs in, so I assume 
it’
s stored in the registr
y and other places (haven’t cracked 
out ProcessExplorer yet to check myself), so it may be a good 

THE BOOK O
F SA
TOSHI
338
idea to have the application be able to export ever
ything that 
it needs for recover
y to a ﬁle that could be backed up off of 
the system.
 The ﬁles are in “%appdata%\Bitcoin”, that’s the directory to 
backup. The data is stored in a transactional database DBM, so it 
should be safe from loss if there’s a crash or power failure.
%appdata% is per-user access privilege. Most new programs like 
Firefox store their settings ﬁles there, despite the headwind of 
Microsoft changing the directory name with every Windows release 
and being full of spaces and so long it runs off the screen.
One other thing I noticed today is that if you close the 
application it doesn’t appear to cleanly close it’
s network 
sockets (TCP RST’
s start ﬂying). Probably an item for the low-
priority todo list (:
 Just now added code to the next release for that.
Satoshi
Email 6—Sa
tos
hi s
ent b
itc
oi
ns
From: “Satoshi Nakamoto” satoshi@vistomail.com 
To: dtrammell@dustintrammell.com 
Date: Mon, 19 Jan 2009 00:54:32 +0800 
Subject: Re: Bitcoin Transfer
It should be your Bitcoin address at home that you received it with. 
There’s no way for it to know who it’s from, so the best it can do is 
tell which of your addresses it was received on.
Y
ou can create multiple addresses and give a different address to 
each person and label them to help ﬁgure out who’s sending to 
you.

Emails to Dusti
n Trammell
339
It doesn’t know any names other than what you tell it. The name 
printed there is what’s associated in your address book for that 
address, either under the Address Book button or the “Change...” 
button to the right of your Bitcoin address.
Hey Satoshi,
After that ﬁrst transfer of 25.00, you didn’t send me another 
100.00
did you? I sent myself 100.00 from my BitCoin application 
at work to my one at home using the BitCoin address rather 
than by IP
. My application at home has a 100.00 transfer 
received, however it’
s transaction details say 
“Received with: Satoshi 
12higDjoCCNXSA95xZMWUdPvXNmkAduhWv”. 
That is not my BitCoin address from work, so I assume this 
means that I received the payment encoded with a block that 
was computed by your client? If so, how did it know your 
name in addition to the BitCoin address that generated it? I 
don’t recall there being a place in my application to even put 
my name.
-- 
Dustin D. T
rammell 
dtrammell@dustintrammell.com 
http://www
.dustintrammell.com

341
70
L
a
st P
riv
a
te 
C
o
rres
po
n
den
ce 
A
LLEGEDL
Y
, Gavin Andr
esen is the last pers
on to ha
ve had a 
priva
te excha
nge with Sat
oshi Nakam
oto
. I
t took place four 
mon
ths aer his nal, December 2010 fo
r
um post on 
bit
-
cointalk.org
. Gavin Andr
esen had a few privat
e email exchan
ges with 
Sat
oshi aer his retr
eat from p
ublic life. H
owever
, Gavin has decided 
that o
nly the ver
y last email from Sa
toshi will be shared pub
licly
.
Email from Sa
tos
hi
Gavin Andresen, April 26, 2011
On Tue, Apr 26, 2011, Satoshi Nakamoto <satoshin@gmx com> 
wrote:

THE BOOK O
F SA
TOSHI
342
I wish you wouldn’t keep talking about me as a mysterious 
shadowy ﬁgure, the press just turns that into a pirate currency 
angle.  Maybe instead make it about the open source project and 
give more credit to your dev contributors; it helps motivate them.
Y
ou
 m
ust
’ve read the Forbes ar
ticle 
. 
. 
. 
yeah, I’m not happy with
 
the ‘wacky pirate money’ tone, either
.
More credit for the rest of the contributors is a ver
y good idea.
On a completely different subject:  I did something that I hope 
turns out to be smar
t, but might be stupid.
I was contacted by 
http://www
.iqt.org/
 -- they’re a US-govt-
funded ‘strategic investment’ company
, and par
t of what they
 
do is holding an annual conference on emerging technologies 
for US intelligence agencies.  This year the theme is “Mobility 
of Money”.
They asked if I’d be willing to talk about Bitcoin, and I 
committed to giving a 50-minute presentation and participating
 
in a panel discussion.
I hope that by talking directly to “them” and, more importantly
,
 
listening to their questions/concerns, they will think of Bitcoin 
the way I do-- as a just-plain-better
, more efﬁcient,
 
less-subject-to-political-whims money
.  Not as an all-power
ful
 
black-market tool that will be used by anarchists to overthrow
 
The System.
It might be really stupid if it just raises Bitcoin’
s visibility on
 
their radar
, but I think it is way too late for that; Bitcoin is
 
already on their radar
.
I plan on posting about this on the forums soon, because 
“Gavin secretly visits the CIA” would spin all sorts of conspiracy
 
theories. “Gavin openly visits the CIA” will create enough 
conspiracy theories as it is.

343
71
B
it
co
i
n an
d Me  
(Hal Fi
n
n
e
y
)
S
INCE HE W
AS THE RECIPIENT 
of the v
er
y rst B
itcoin tran
s
-
action and someo
ne who was inv
olved early
, it is w
ort
h adding 
this wonderful post from H
al Finney on the 
bitcointalk.org
 forum 
dat
e
d Ma
rch 19, 2013.
Bit
coi
n and me (Hal Fi
nn
e
y
)
Hal Finney
, March 19, 2013, 08:40:02PM
I thought I’d write about the last four years, an eventful time 
for Bitcoin and me.
For those who don’t know me, I’m Hal Finney
. I got my 

THE BOOK O
F SA
TOSHI
344
start in cr
ypto working on an early version of PGP
, working 
closely with Phil Zimmermann. When Phil decided to star
t 
PGP Corporation, I was one of the ﬁrst hires. I would work 
on PGP until my retirement. At the same time, I got involved 
with the Cypherpunks. I ran the ﬁrst cr
yptographically based 
anonymous remailer
, among other activities.
Fast for
ward to late 2008 and the announcement of Bitcoin. 
I’ve noticed that cr
yptographic graybeards (I was in my mid 
50’
s) tend to get cynical. I was more idealistic; I have always 
loved cr
ypto, the myster
y and the paradox of it.
When Satoshi announced Bitcoin on the cr
yptography mailing 
list, he got a skeptical reception at best. Cr
yptographers have 
seen too many grand schemes by clueless noobs. They tend to 
have a knee jerk reaction.
I was more positive. I had long been interested in 
cr
yptographic payment schemes. Plus I was lucky enough 
to meet and extensively correspond with both W
ei Dai and 
Nick Szabo, generally acknowledged to have created ideas 
that would be realized with Bitcoin. I had made an attempt to 
create my own proof of work based currency
, called RPOW
. 
So I found Bitcoin facinating.
When Satoshi announced the ﬁrst release of the software, I 
grabbed it right away
. I think I was the ﬁrst person besides 
Satoshi to run bitcoin. I mined block 70-something, and I was 
the recipient of the ﬁrst bitcoin transaction, when Satoshi sent 
ten coins to me as a test. I carried on an email conversation 
with Satoshi over the next few days, mostly me reporting bugs 
and him ﬁxing them.
T
oday
, Satoshi’
s true identity has become a myster
y
. But at the 
time, I thought I was dealing with a young man of Japanese 
ancestr
y who was ver
y smart and sincere. I’ve had the good 
fortune to know many brilliant people over the course of my 
life, so I recognize the signs.

Bit
coi
n and Me (Hal Fin
ney
) 
345
After a few days, bitcoin was running pretty stably
, so I left 
it running. Those were the days when difﬁculty was 1, and 
you could ﬁnd blocks with a CPU, not even a GPU. I mined 
several blocks over the next days. But I turned it off because 
it made my computer run hot, and the fan noise bothered me. 
In retrospect, I wish I had kept it up longer
, but on the other 
hand I was extraordinarily lucky to be there at the beginning. 
It’
s one of those glass half full half empty things.
The next I heard of Bitcoin was late 2010, when I was 
surprised to ﬁnd that it was not only still going, bitcoins 
actually had monetar
y value. I dusted off my old wallet, and 
was relieved to discover that my bitcoins were still there. As 
the price climbed up to real money
, I transferred the coins into 
an ofﬂine wallet, where hopefully they’ll be worth something 
to my heirs.
Speaking of heirs, I got a surprise in 2009, when I was 
suddenly diagnosed with a fatal disease. I was in the best 
shape of my life at the start of that year
, I’d lost a lot of weight 
and taken up distance running. I’d run several half marathons, 
and I was starting to train for a full marathon. I worked my 
way up to 20+ mile runs, and I thought I was all set. That’
s 
when ever
ything went wrong.
My body began to fail. I slurred my speech, lost strength 
in my hands, and my legs were slow to recover
. In August, 
2009, I was given the diagnosis of ALS, also called Lou 
Gehrig’
s disease, after the famous baseball player who got it.
ALS is a disease that kills moter neurons, which carr
y signals 
from the brain to the muscles. It causes ﬁrst weakness, then 
gradually increasing paralysis. It is usually fatal in 2 to 5 
years. My symptoms were mild at ﬁrst and I continued to 
work, but fatigue and voice problems forced me to retire 
in early 2011. Since then the disease has continued its 
inexorable progression.

THE BOOK O
F SA
TOSHI
346
T
oday
, I am essentially paralyzed. I am fed through a tube, 
and my breathing is assisted through another tube. I operate 
the computer using a commercial eyetracker system. It also 
has a speech synthesizer
, so this is my voice now
. I spend all 
day in my power wheelchair
. I worked up an inter
face using 
an arduino so that I can adjust my wheelchair’
s position using 
my eyes.
It has been an adjustment, but my life is not too bad. I can 
still read, listen to music, and watch TV and movies. I recently 
discovered that I can even write code. It’
s ver
y slow
, probably 
50 times slower than I was before. But I still love programming 
and it gives me goals. Currently I’m working on something 
Mike Hearn suggested, using the security features of modern 
processors, designed to support “Trusted Computing”, to 
harden Bitcoin wallets. It’
s almost ready to release. I just have 
to do the documentation.
And of course the price gyrations of bitcoins are entertaining 
to me. I have skin in the game. But I came by my bitcoins 
through luck, with little credit to me. I lived through the crash 
of 2011. So I’ve seen it before. Easy come, easy go.
That’
s my stor
y
. I’m pretty lucky overall. Even with the ALS, my 
life is ver
y satisfying. But my life expectancy is limited. Those 
discussions about inheriting your bitcoins are of more than 
academic interest. My bitcoins are stored in our safe deposit 
box, and my son and daughter are tech savvy
. I think they’re 
safe enough. I’m comfortable with my legacy
. 
Hal Finney

347
72
C
on
c
l
u
s
i
on
S
A
TOSHI N
AKAMOTO 
brough
t together man
y existing ma
th
-
ema
t
ical and sowar
e concepts to cr
eate Bi
tcoin. Since then, 
Bit
coin has been an ong
oing experiment, co
ntinuin
g to evolve 
and be upda
ted on a regular basis. I
t has, so far
, pro
ven its u
t
ility and 
revol
utionized the nancial an
d monetar
y indus
t
r
y
, particu
larly the 
electronic pa
yment system, a
nd is being accepted wor
ldwide. Bitco
in, 
in itself, ma
y or ma
y not sur
vive up t
o the year 2140 when all bitco
ins 
will have been mined, bu
t the idea of a distribut
e
d, peer-to-peer
 and 
decentralized limited-su
pply currency is here t
o stay
.
e ab
i
lity to tran
sfer money digitally has been ava
i
lable o
n
ly 
recen
tly in human his
tor
y but this is m
erely a mecha
nistic change in 
the handling o
f money
, a new way to perform the same action. Bu
t 
gold a
nd silver or an
y other no
n-inatable en
tity cannot be directly 
transmi
tted electronically and th
us requir
e a conceptual delega
te that 
might misr
epresen
t t
heir quan
tity if too man
y copies w
ere to be made 

THE BOOK O
F SA
TOSHI
348
(i.e., this delega
te were t
o b
e inated). e gr
e
at
er t
he quan
tity of an
y 
currency
, the less valuable i
t be
comes, a
nd the less, in real goods and 
ser
vices, it is capab
le of purc
hasing.
en, in la
te 2009, Satoshi in
troduced Bi
tcoin. e con
cept of 
a decentralized digital currency—open s
our
ce and with an open 
accoun
ting bo
ok—has been actualized. In
terestingly
, in con
trast to 
gold a
nd silver
, which can only exis
t in t
he ph
ysical world, b
itcoin
s 
can only 
exist in the elect
ro
nic world.
3
 Be
cause o
f t
hat, in es
s
ence one 
can ar
gue t
hat 
precious metals an
d Bitco
in complem
ent each other 
very nicely
.
e fact that Bi
tcoin is a
n open s
ource so
ware whose transactions 
mu
st b
e conrmed by all mem
b
ers of the netwo
rk and which opera
tes 
with a pub
lic ledger makes it the polar op
posite of a cen
tra
lly con
-
trolled, closed currency system. Regar
d
less of whether r
egu
lato
rs are 
in
volved in a closed system o
r not, such system
s are jus
t as susceptible 
to corrup
tions and b
r
ibes to go
vernment leaders as an
y other govern
-
men
t-contro
lle
d instit
ution. A
s rare, pr
ecious metals, gold a
nd silver 
ar
e an excellent c
hoice to use as money
, bu
t t
heir inab
ility to be trans
-
ferred electro
nica
lly requir
es some sort of int
erme
diar
y
, repr
es
enta
-
tive fo
rm, capable o
f b
eing mani
pulated b
y a t
hird party
. T
ransporting 
a larg
e sum of gold a
nd silver is also cumbersome and expensiv
e. Pre
-
cious metals will, ho
wever
, hold their value in ma
jor disruption
s such 
as electric gr
id blacko
uts and wo
uld cer
tainly become the currency of 
cho
ice in a Mad Max scena
r
io
. For those fearful of suc
h an event
ua
lity
, 
possessing a certain amoun
t of go
ld and silver is a
ppro
priate
. In an
y 
case, all at (i.e., g
overnmen
t-de
creed) currencies thro
ug
hou
t history 
hav
e always died, an
d you should no
t exp
ect your coun
tr
y’
s currency 
to pr
ove a
n exception to this rule.
3
 So far
, con
veying bitcoins in the p
hysical world imp
lies some form of artifact like a paper wallet with 
the Bitco
in address and priva
te key inscribed on it. Or alternati
vely
, it requires some trust in a third 
party
, for example the ma
nufacturer of a p
hysical coin with a hidden Bitco
in private key alon
g with a 
visible Bit
coin address.

Conc
l
u
sion
349
is book has pr
es
ented all the most r
elevant con
versation
s and dis
-
cussions in which the cr
eator o
f Bitco
in was inv
olved. Whether a gr
oup 
or an in
dividual, the person known as Sa
toshi N
akamoto exp
ressed 
himself clearl
y and concisely a
nd nat
ura
lly understood very well Bit
-
coin
’
s founda
tion. His va
r
ious writings seem to indica
te that he did no
t 
expect Bitcoin t
o t
ake o as ra
pidly as i
t has. Satoshi as
s
embled vario
us 
existing co
ncepts to crea
te this formidable t
e
chnology currently r
e
vo
-
lu
t
ionizing h
ow a monetary system is con
ceptualized. He h
as opened 
a P
andora
’
s B
ox, and ma
ny brillian
t minds are wo
rking beyond Bi
tcoin 
to revo
lutionize o
ther systems based on its p
recepts.
Whether B
itcoin r
epresents m
oney is subject to debat
e, but tha
t it 
is a currency
, a me
dium o
f exchang
e, is indispu
table. Gold and silv
er 
ar
e a store o
f value over the lo
ng term bec
au
s
e of their limit
e
d sup
ply 
and their usefulness. Bi
tcoin also has a limited su
pply—the 21 million 
bi
tcoins pla
nned as of 2140—and has p
roven so fa
r to b
e very us
eful as 
an easy fo
rm of paymen
t over the I
nternet, its na
tural medium.
Sat
oshi cover
e
d man
y of the argum
ents we ha
ve seen debated ov
er 
and o
ver in the news media since Bitco
in
’
s rise in popularity
. Although 
we wo
uld have lo
ved to hear him discuss them in person, this bo
ok 
gives us the ab
ility to easily revisit the ma
ny op
inions he sha
red during 
his “
public lif
e
”
. Bitco
in
’
s major im
pact has be
en to allow the popula
-
tion of the w
orld to r
e
consider h
ow a currency should function. I
t 
opens the door fo
r huma
nity to a new monetary system, an electronic 
renaiss
anc
e.
ank yo
u!

351
“Bit
coi
n: A Peer-t
o-Peer Electron
ic  
Cash System” b
y Sa
tos
hi Nakamo
to
A
bstrac
t.
 A purel
y p
eer-to-peer versio
n of electronic cash wo
uld al
low 
online pa
y
ments t
o b
e sent directly fro
m one party to another witho
ut 
goin
g t
hro
ug
h a nancial instit
ution. Digital signat
ures pro
vide part 
of the solu
tion, but the ma
in b
enets ar
e lost if a trusted third party is 
still required t
o prevent 
double-spending. W
e pr
opose a solution to the 
double-s
p
ending pr
oblem using a peer-t
o-p
eer network. e netw
ork 
timestam
ps t
ransactions b
y hashing them int
o an ongo
ing chain o
f hash-
based proof-o
f-work, fo
r
ming a reco
rd that canno
t b
e chang
ed without 
redoin
g t
he pr
o
of-of-w
ork. e lon
gest chain no
t only ser
ves as proof o
f 
the sequence of even
ts witnessed, but p
roof that it ca
me from the larges
t 
pool of CPU power
. As long as a m
ajority of CPU po
wer is con
t
rolled by 
nodes that ar
e not cooperating to a
ttack the netwo
rk, the
y’l
l genera
te the 
long
est chain and o
utpace at
tackers. e networ
k itself requires minimal 
structure. M
essages ar
e broadcast on a best eo
rt b
asis, and nodes can 
leave a
nd rejoin the netwo
rk at will, accepting the lon
gest proof-o
f-work 
chain as p
roof of wha
t happened while they were go
ne. 
1. Introducti
o
n
Commerce o
n the Int
er
net has com
e to rely almost ex
clusiv
ely on 
nancial insti
tution
s s
er
ving as trusted third parties to process elec
-
tronic pa
yments. W
hi
le the system wo
rks well enough fo
r most trans
-
actions, it s
ti
ll suers fro
m the inherent w
e
aknesses of the trust based 
model. Comp
letely non-r
eversible transaction
s are not r
eal
ly possible, 

THE BOOK O
F SA
TOSHI
352
since nancial ins
titution
s cannot a
void mediatin
g disputes. 
e cost 
of media
tion increases transaction costs, limi
ting the minimum prac
-
tical transaction size and cuttin
g o the possibility fo
r small c
asual 
transactions, a
nd there is a br
o
ader cost in the loss of a
bility to make 
non-r
eversible paymen
ts for n
onreversib
le s
er
vices. W
ith the p
ossibil
-
ity of r
eversal, the need for trust spr
eads. Mer
chants m
ust be war
y of 
their customer
s, hassling them fo
r more inf
ormation tha
n t
hey would 
otherw
ise need. A cert
ain percen
tage of fraud is accep
ted as unav
oid
-
able. 
es
e costs and pa
yment uncertain
ties can be avoided in person 
by usin
g physical currency
, but no mecha
nism exists to make pa
y
-
men
ts over a comm
unication
s channel witho
ut a trusted party
.
Wha
t is needed is an electronic pa
y
men
t system base
d on cryp
-
tograp
hic proof in
stead of trust, allowing an
y two willing parties to 
transact directly with each other wi
t
hou
t t
he need for a trusted third 
party
. T
ransactions tha
t are co
mpu
tationally im
practica
l to rever
s
e 
would p
rotect sellers from fra
ud, and ro
utine escrow m
e
chanism
s 
could easily be imp
lemented to p
rotect buy
ers. In this paper
, we pro
-
pose a s
olu
tion to the double-s
p
ending pr
oblem using a peer
-to-pe
er 
distribu
ted timestamp ser
ver to genera
te com
puta
tional proo
f of the 
chro
nological order o
f t
ransactions. 
e system is sec
ure as lo
ng as 
hones
t nodes colle
ctively co
ntrol mo
re CPU power tha
n any coopera
t
-
ing gro
up of a
ttacker nodes. 
2. T
r
ansactio
ns
W
e dene an electronic coin a
s a chain of digital signa
tures. Each 
owner tran
sfers the coin to the next b
y digitally signing a hash of the 
pr
e
vious transaction a
nd the public key of the next o
wner and adding 
these to the end of the coin. A pa
yee can verify the signatur
es to verif
y 
the chain o
f ownershi
p.

Conc
l
u
sion
353
e pr
oblem of co
urse is t
he pay
e
e can
’
t verify t
hat o
ne of the own-
ers did not do
uble-spend the coin. A co
mmon solu
t
ion is to in
troduce 
a trusted central a
uthority
, or min
t, that checks every transaction for 
doub
le sp
ending. Aer each tran
sac
tion, the coin m
ust be returned to 
the mint t
o issue a new coin, and o
nly coins iss
ue
d directly from the 
mint a
re trusted not to be doub
le-spent. e pr
oblem with this solu
-
tion is tha
t the fate of the en
tire mon
e
y system depends on the co
m
-
pan
y r
unning the min
t, with e
ver
y transaction ha
ving to go thro
ug
h 
them, just like a ba
n
k.
W
e nee
d a way f
or the payee to kno
w that the pr
ev
ious o
wners did 
not sign an
y e
arlier transaction
s. For o
ur purp
oses, the e
arliest tra
ns
-
action is the one tha
t coun
ts, s
o we don
’t car
e about la
ter at
tempts 
to doub
le-spend. e only wa
y to conrm the absence of a tran
s
ac
-
tion is to be a
ware o
f a
ll transactions. I
n the mint based model, the 
mint wa
s aware o
f all t
ransactions a
nd decided w
hich arrived rst. 
T
o accompli
sh this without a trusted party
, transactions mu
st b
e pub
-
licly a
nnounced [1], and we need a system f
or participan
ts to agree on 
a single histo
r
y of the o
rder in which they were receiv
ed. e payee 

THE BOOK O
F SA
TOSHI
354
needs pr
o
of that a
t the time of each transaction, the ma
jority of nodes 
agreed it was the r
st received.
3. T
imest
a
mp Server
e solu
tion we pr
opos
e begins with a timestam
p s
er
ver
. A timestam
p 
ser
ver works b
y tak
ing a hash o
f a block of item
s to be timestamped 
and widely p
ublishing the has
h, such as in a newspaper or U
s
enet post 
[2-5]. e timestam
p pro
ves that the da
ta must ha
ve existed a
t t
he 
time, ob
viously
, in order t
o get into the ha
sh. E
ach timestam
p includes 
the pr
e
vious timestam
p in its hash, f
orming a chain, wi
t
h each addi
-
tional timestam
p reinfo
rcing the ones befo
re it.
4. Proo
f-of-Wo
rk
T
o implemen
t a distributed timesta
mp ser
ver on a peer-to-peer basis, 
we will need to use a proo
f-of-work sys
tem similar to A
dam Back
’
s 
H
ashcash [6], rather than n
e
wspaper or U
senet p
osts. e pr
oof-of-
wor
k invol
ves scanning fo
r a va
lue tha
t w
hen hashed, s
uch as with 
SH
A
-256, the hash begins with a num
b
er of zero b
its. e a
verage 
wor
k required is exponen
tial in t
he n
umber of zero bi
ts required a
nd 
can be veried by executing a sin
gle hash.

Conc
l
u
sion
355
Fo
r our timestam
p network, we im
plemen
t the proof-o
f-work b
y incre
-
men
t
ing a no
nce in the block until a value is fo
und that gives the block
’
s 
hash the req
uired zero bi
ts. Once the CPU eort has been expended to
 
make it sa
tisf
y the proof-o
f-work, the block ca
nnot be changed wi
t
hou
t
 
redoin
g the work. A
s later blocks ar
e chained a
er it, the work t
o change 
the block would inc
lude redoin
g a
ll the blocks aer i
t.
e pr
oof-of-wo
rk als
o solves the p
roblem o
f determining repr
e
-
senta
t
ion in ma
jority decision making. I
f the majori
ty were based on 
one-IP
-address-one-v
ote, it co
uld b
e subv
er
ted by a
nyo
ne able to allo
-
cat
e many IP
s. Proof-of-w
ork is essentially on
e-CPU-one-vot
e. e 
ma
j
ority decisio
n is repr
es
ented b
y the longest c
hain, which has the 
great
est proof-o
f-work e
ort invest
ed in it. If a ma
jority of CPU pow
er 
is con
trolled by ho
nest nodes, the honest c
hain will g
ro
w t
he fastes
t 
and o
utpace an
y com
p
eting chain
s. T
o modif
y a past block, an a
ttacker 
would ha
ve to redo the p
roof-of-w
ork of the block an
d a
ll blocks aer 
it an
d t
hen cat
ch up with and s
ur
pass the work o
f the honest nodes. 
W
e wi
ll show la
ter that the pr
obability o
f a slower a
ttacker ca
tching up 
diminishes exponen
tial
ly as subsequen
t blocks are added.
T
o compensa
te for incr
easing hard
ware speed and varying inter
-
est in running nodes ov
er time, the proof-o
f-work diculty is det
er
-
mined by a mo
ving av
erage targeting a
n averag
e number of b
lo
cks per 
hour
. If they’
re genera
ted too fast, the diculty increases.

THE BOOK O
F SA
TOSHI
356
5. Netwo
rk
e steps to run the netwo
rk are as f
ollows:
1. 
 
N
e
w transactions ar
e broadcast t
o a
ll nodes.
2. 
 
Each node collects new transactions in
to a block. 
3. 
 
Each node works o
n nding a dicult proo
f-of-work f
or its block. 
4. 
 
When a node nds a pr
oof-of-wo
rk, it br
oadc
asts the block to all 
nodes. 
5. 
 
N
o
des accept the block only if all tran
s
actions in it a
re valid and 
not alr
e
ady spent. 
6. 
 
Nodes expres
s t
heir acceptance o
f the block by wo
rking on cr
e
at
-
ing the next block in the cha
in, using the hash of the accep
ted 
block as the pr
ev
ious has
h.
N
o
des always co
nsider the longes
t chain to be the correct one a
nd 
will keep working 
on extending i
t. If two nodes br
oadcast dieren
t 
versio
ns of the next block sim
ultaneousl
y
, some nodes may r
eceive 
one o
r the other rst. In tha
t case, they work on the r
st one they 
receiv
e
d, bu
t save the other b
ranch in case it becomes lon
ger
. e tie 
will b
e br
oken when the next pr
o
of-of-w
ork is fo
und and one b
ranch 
becomes lon
ger
; the nodes t
hat 
were wo
rking on the other b
ranch will 
then switch t
o t
he lon
ger one.
N
e
w transaction br
oadcasts do not necessarily need to reach all 
nodes. As lo
ng as they reach man
y nodes, t
hey will get into a b
lo
ck 
befor
e long. Block br
oadcasts are also tolera
nt of dr
opped messages. I
f 
a node does not receiv
e a block, it will request it when i
t receives the 
next block and r
ealizes it missed one.

Conc
l
u
sion
357
6. Incentive
By con
vention, the rs
t t
ransaction in a block is a special transaction 
that sta
r
ts a new coin owned b
y the creato
r of the block. is adds an 
incen
t
ive f
or nodes to sup
p
ort the network, a
nd pro
vides a way to ini
-
tially distribute co
ins int
o circulation, since there i
s no central au
thor
-
ity to is
sue them. e steady addition o
f a constan
t of amo
unt o
f ne
w 
coins i
s analogous to g
old miners expending resour
ces to add gold to 
circulatio
n. In our case, it i
s CPU t
ime and electricity that i
s exp
ended.
e incen
tive can also be funde
d with transaction fees. I
f the outp
ut 
value of a tra
nsac
tion is less than i
ts inpu
t value, the dier
ence is a 
transaction fee tha
t is added to the incentive val
ue of the block con
-
taining the transaction. Once a p
redetermined num
b
er of coin
s have 
ent
ered circulation, the incen
tive can tran
sition entir
ely to transaction 
fees and be com
pletel
y in
atio
n f
ree. 
e incen
tive may he
lp encourag
e no
des to sta
y honest. I
f a g
reedy 
at
tacker is able to a
ssemble mor
e CPU p
ower tha
n al
l the honest n
o
des, 
he wo
u
ld hav
e to choose b
etween using it t
o def
raud people b
y steal
-
ing back his pa
yments, or usin
g it to genera
te new coins. H
e ough
t to 
nd it mo
re pr
otable t
o play b
y t
he rules, such rules t
hat fa
vour him 
with mor
e new coins than everyone else com
bined, than to undermine 
the system an
d t
he validity of his o
wn wealth.
7. Reclaimin
g Disk Sp
ace
Once the lat
est transaction in a coin is buried under eno
ugh blo
cks, 
the spent tran
sac
tions befo
re it can be discarded t
o s
av
e disk space. 
T
o faci
lita
te this without b
reaking the block
’
s hash, tran
sac
tions ar
e 
hashed in a M
erkle T
ree [7][2][5], with only the r
o
ot incl
uded in 
the block
’
s hash. Old blocks can then be com
pacted by stub
bing o
 
bran
ches of the tree. e in
terior hashes do n
ot need to be stored
.

THE BOOK O
F SA
TOSHI
358
A block header with no transaction
s would be about 80 b
ytes. If 
we su
ppos
e blocks ar
e generated every 10 minut
es, 80 bytes * 6 * 24 
* 365 = 4.2MB per year
. Wi
th comp
uter systems typ
ical
ly selling with 
2GB of RAM as o
f 2008, and Moo
re
’
s Law pr
edic
ting current gr
owth 
of 1.2GB per year
, storag
e should not be a pr
oblem even if the block 
headers m
ust be kept in memory
.
8. Simpli
fied P
a
yment Veri
fica
tio
n
I
t is possible to v
er
ify p
aymen
ts withou
t r
unning a full network 
node. A user only needs to k
e
ep a cop
y of the block headers of the 
long
est proof-o
f-work ch
ain, which he can get b
y quer
ying network 
nodes until he
’
s con
vinced he has the longes
t chain, and ob
tain the 
M
erkle branch linking the transaction to the b
lo
ck it
’
s t
imestam
p
ed in. 
H
e can
’t c
heck the transaction for him
s
elf, bu
t by linking it to a p
lace 
in the chain, h
e can se
e that a netw
ork node has accept
e
d it, an
d blocks 
added aer i
t f
urther conrm the network has accep
ted it.

Conc
l
u
sion
359
As s
uch, the verication is r
eliable as lo
ng as honest n
o
des con
trol 
the networ
k, but is mo
re vulnerable if the netwo
rk is overpow
ered by 
an a
ttacker
. While network nodes can v
er
ify t
ransactions f
or them
-
selves, the sim
plied method can be fooled by an a
ttacker’
s fabrica
ted 
transactions f
or as long a
s t
he at
tacker can con
tinue to o
verpower the 
networ
k. One strategy to pr
otect against this wo
uld b
e to accept alerts 
from netw
ork nodes when they detec
t an in
valid block, pro
mpting the 
user’
s soware to do
wnlo
ad the full block and alerted transact
ions t
o 
conrm the incon
sistency
. Businesses tha
t receive frequen
t paymen
ts 
will probab
ly still want to run their own n
o
des for mo
re independent 
secur
ity and q
uicker vericatio
n.
9. Co
mbi
ni
ng an
d Splittin
g V
alue
Although i
t would be p
ossible to h
andle coins indi
v
idually
, it wo
u
ld 
be unwield
y to make a separate tran
sac
tion fo
r e
ver
y cent in a tran
sfer
. 
T
o a
llow value t
o b
e split a
nd comb
ined, transactions con
tain multi
ple 
inp
uts and o
utpu
ts. No
r
mally there will be either a single inp
ut from 
a larg
er previous transaction o
r multip
le inpu
ts combinin
g smaller 
amo
unts, and a
t most two ou
tputs: o
ne for the pa
yment, and o
ne 
ret
ur
ning the chan
ge, if an
y
, b
ack to the sender
.

THE BOOK O
F SA
TOSHI
360
I
t should be not
e
d that fa
n-out, where a tran
sac
tion depends on 
several transactions, and those transactions depend o
n many m
ore, 
is not a p
roblem h
ere. ere i
s ne
ver the need to extract a com
plete 
standalone co
py of a tra
nsac
tion
’
s histor
y
.
10. Priv
acy
e traditional banking m
o
del achieves a level of p
rivac
y by limi
t
-
ing access to inf
ormatio
n to the part
ies in
volved and 
t
he trusted third 
party
. e necessity to anno
unce all t
ransactions p
ublicly pr
ecludes 
this method, but p
rivac
y can still be maintained b
y breaking the o
w 
of info
rmation in a
nother place: by k
e
eping p
ublic keys ano
nymou
s. 
e pub
lic can se
e that som
e
one is sendin
g an amoun
t to someone 
else, bu
t without inf
ormation linking the tran
sac
tion to an
yon
e. is is 
similar to the level of inf
ormatio
n released by stock exc
hanges, where 
the time and size o
f individual trades, the “
t
ape
”
, is made public, bu
t 
withou
t telling who the parties were.

Conc
l
u
sion
361
As a
n additional rewall, a new key pair sho
u
ld be use
d for each 
transaction to keep them fro
m being linked to a common o
wner
. 
Some linking is still unav
oidable with m
ulti-inpu
t transactions, which 
necessarily reveal that their in
puts w
ere owned b
y the s
ame o
wner
. e 
risk is that if the o
wner of a key is r
e
vealed, linking could reveal other 
transactions tha
t belonged to the same o
wner
.
11. Cal
cul
a
tio
ns
W
e consider the scenario of a
n attacker 
t
r
ying to genera
te an alt
er
nat
e
 
chain fas
ter than the honest c
hain. Ev
en if t
his is accom
plished, i
t do
es not 
thro
w t
he system o
p
en to arb
itrar
y chang
es, such as crea
t
ing value o
ut of 
thin air or taking mo
ney t
hat never belo
nged to the at
tacker
. N
o
des are 
not g
oing to accept a
n invalid transaction as pa
yment, and h
onest nodes
 
will never accept a block con
taining them. An a
ttacker can o
n
ly tr
y to
 
chan
ge one of hi
s own transactions to take back mo
ney he recently s
p
ent.
e race between the honest c
hain and an a
ttacker ch
ain can be 
characterized as a Bin
omial R
andom W
alk. e success event 
is t
he 
hones
t chain being extended b
y one block, increasin
g its lead by +1, 
and the fail
ure event is the a
ttacker
’
s chain being exten
de
d by o
ne 
block, red
ucing the gap b
y -1.
e pr
obability o
f an attack
er catchin
g up from a given deci
t is 
analogo
us to a Gambler
’
s R
uin problem. S
uppose a gamb
ler w
ith 
unlimited credi
t starts at a decit a
nd plays poten
tial
ly an inni
te 
num
ber of tri
als to tr
y to reach br
eakeven. W
e can calculate the pr
ob
-
abili
ty he ever reaches br
ea
keven, or tha
t an a
ttacker ever cat
ches up 
with the hones
t chain, as fo
l
lows [8]:
p
 = pr
obability an ho
nest node nds the next block
q
 = pr
obability the a
ttacker nds the next block
q
z
 = pr
obability the a
ttacker will ever catch u
p f
ro
m z blocks behind

THE BOOK O
F SA
TOSHI
362
Giv
en our assum
ption that p > q
, t
he pr
obability dr
ops expo
-
nen
t
ially as the num
b
er of blocks the a
ttacker has t
o catch u
p with 
increases. W
ith the odds against him, if he doesn
’
t make a luc
ky lunge 
forward earl
y on, his chan
ces b
ecome vanis
hingly small as he falls f
ur
-
ther behind. 
W
e now con
sider how long the r
ecipien
t of a new transaction needs 
to wai
t b
efor
e being suciently certain the sender can
’
t chan
ge the 
transaction. W
e assume the sender is an a
ttacker who wan
ts to make 
the recip
ient believe he paid him fo
r a whi
le, then switc
h it to pay 
back to himself a
er some time has passed. e recei
ver wil
l be aler
ted 
when that ha
ppens, bu
t the s
ender hopes it will be too late
.
e receiv
er generat
es a new key pair and gives the p
ublic key to the 
sender shortly befor
e signing. is preven
ts the sender from pr
eparing 
a chain o
f blocks ahead of time by wo
rking on i
t contin
uously un
til he 
is luck
y enough to get far eno
ugh a
head, then executing the tran
s
ac
-
tion a
t that momen
t. Once the transaction is sent, the di
shonest sender 
starts wor
k
ing in secret on a pa
ra
llel chain co
ntaining a
n a
lterna
te ver
-
sion o
f his transaction.
e reci
pient wa
its until the transaction has been added to a block 
and 
 
z 
 
blocks ha
ve be
en linked aer i
t. He doesn
’
t know the exact 
amo
unt of p
rogress the a
ttacker has made
, but assumin
g the honest 
blocks took the a
verage expected time per block, the attack
er’
s poten
-
tial progres
s wi
ll be a Po
isson distribu
t
ion with expected value:
T
o get the proba
bility the at
t
acker co
u
ld still catch u
p now
, we m
u
l
-
tiply the P
oisson densi
ty for each am
ount o
f progress h
e could have 
made by the p
robabili
ty he could catc
h up from tha
t p
oin
t:

Conc
l
u
sion
363
Rearranging to a
void s
umming the innite tail of the distrib
ution 
. 
. 
.
Conv
er
ting 
to 
 
C 
code . . . 
#include <math.h>
double AttackerSuccessProbability(double q, int z)
{
 
 
double p = 1.0 - q;
 
 
double lambda = z * (q / p);
 
 
double sum = 1.0;
 
 
int i, k;
 
 
for (k = 0; k <= z; k++)
 {
 
 
 
 
double poisson = exp(-lambda);
 
 
 
 
for (i = 1; i <= k; i++)
 
 
 
 
 
 
poisson *= lambda / i;
 
 
 
 
sum -= poisson * (1 - pow(q / p, z - k));
}
return sum;
}
Runnin
g some results, w
e can see t
he pr
obability dro
p o exponen
-
tially with z.
q=0.1
z=0 P=1.0000000
z=1 P=0.2045873
z=2 P=0.0509779
z=3 P=0.0131722
z=4 P=0.0034552
z=5 P=0.0009137

THE BOOK O
F SA
TOSHI
364
z=6 P=0.0002428
z=7 P=0.0000647
z=8 P=0.0000173
z=9 P=0.0000046
z=10 P=0.0000012
q=0.3
z=0 P=1.0000000
z=5 P=0.1773523
z=10 P=0.0416605
z=15 P=0.0101008
z=20 P=0.0024804
z=25 P=0.0006132
z=30 P=0.0001522
z=35 P=0.0000379
z=40 P=0.0000095
z=45 P=0.0000024
z=50 P=0.0000006
Solving fo
r P less than 0.1%...
P < 0.001
q=0.10 z=5
q=0.15 z=8
q=0.20 z=11
q=0.25 z=15
q=0.30 z=24
q=0.35 z=41
q=0.40 z=89
q=0.45 z=340
12. Co
nclus
io
n
W
e have p
roposed a system for electro
nic transactions withou
t rely
-
ing on trust. W
e started with the usual framework o
f coins made fro
m 
digital signat
ures, which pro
vides stron
g contro
l of owner
ship
, but is 
incom
plete witho
ut a way to p
reven
t double-spending. T
o solve this, 
we pr
oposed a p
eer-to-peer netwo
rk using pr
o
of-of-w
ork to reco
rd a 

Conc
l
u
sion
365
pub
lic histor
y of tran
s
actions tha
t quickly becomes com
puta
t
ionally 
imp
ract
ical for an a
ttacker t
o change if ho
nest nodes con
trol a ma
j
or
-
ity of CPU po
wer
. e networ
k is robus
t in its unstructured simp
licity
. 
N
o
des work all a
t once with lit
tle co
ordin
ation. ey do not n
e
ed to 
be identied, since messag
es are no
t rout
e
d to an
y particu
lar place 
and o
nly need to b
e deliver
ed on a best eort basis. N
odes c
an leav
e 
and r
ejoin the network a
t will, accepting the pr
o
of-of-w
ork chain a
s 
pr
o
of of wha
t hap
p
ened while the
y were g
one. ey vo
te with their 
CPU power
, expres
sing their acceptance of valid blocks b
y working 
on exten
ding them and rejecting in
va
lid blocks by r
efusing to wor
k 
on them. An
y needed r
ules and incen
tives can be enfor
ced w
ith this 
consens
us mechanism.
References
1. 
 
W
. D
ai, “b-mo
ney
,
” h
ttp://www
.weidai.co
m/bmoney
.txt, 1998.
2. 
 
H. M
assias, X.S. A
vi
la, and J
.-J
. Quisquater
, “Design of a secure 
timestam
ping ser
vice with minimal tr
ust requir
ements,
” In 20th 
Sym
posium on I
nformatio
n eor
y in the B
enelux, M
ay 1999.
3. 
 
S. H
aber
, W
.S. S
tornetta, “H
ow to time-stam
p a digital do
cu
-
men
t,
” In J
ournal of Cryptology
, vol 3, no 2, pag
es 99–111, 1991.
4. 
 
D
. B
ay
er
, S. Haber
, W
.S. S
tornetta, “I
mp
roving the eciency and 
relia
bility of digital time-stam
ping,
” In Sequences II: M
et
hods 
in Communica
tion, Sec
urity and Com
puter Science, pages 329-
334, 1993.
5. 
 
S. H
aber
, W
.S. S
tornetta, “
S
ecure names fo
r bit-strings,
” In P
ro
-
ceedings of the 4th A
CM C
onfer
ence on Comp
uter and Com
-
munica
tions Secur
ity
, pages 28–35, A
pril 1997.
6. 
 
A. Back, “
Has
hcash - a denial of ser
vice coun
ter-m
e
asure
,
” 
 
 
ht
tp://ww
w
.hashcash.or
g/p
apers/has
hcash.pdf, 2002.

THE BOOK O
F SA
TOSHI
366
7. 
 
R
.C. M
erkle, “Pr
otocols for p
ublic key cr
yptosyst
ems,
” I
n Proc. 
1980 Sym
posium on Secur
ity and P
rivac
y
, IEEE C
omp
uter Soci
-
ety
, pages 122–133, A
pril 1980.
8. 
 
W
. Fe
ller
, “
An intr
o
duction to p
robabili
ty t
heor
y and i
ts applica
-
tions,
” 1957.

367
T
erms & Defi
n
itio
n
Asymmetric Encr
y
ption—
A type of encryption in
volving two k
e
ys, 
a priva
te key and a p
ublic key
. T
ext that is encrypted with the pri
-
vat
e key must be decr
ypted with the pub
lic key and vice versa. e 
pub
lic key is easi
ly derived fro
m t
he priva
te key bu
t t
he reverse is 
nearly im
possible.
Bi
tcoin A
d
dress—
A lon
g ser
ies of digits to which the b
lo
ck chain
 will 
associate b
itcoin
s. It i
s t
he hash ou
tpu
t of the public k
e
y
.
 Any bit
-
coins i
t con
t
ains can o
nly be t
ransf
er
red to a
nother Bitco
in address
 
by the person who o
wns its corr
esp
ondin
g private k
ey
.
Blo
ck
—A chunk o
f data that co
ntains several Bit
coin transactions tha
t 
miners wo
rk on crea
ting.
Block C
hain
—e Bi
tcoin block cha
in is shared via a peer-t
o-p
eer
 
networ
k b
etween all miners and in
terested nodes (com
put
ers). I
t 
con
tains all the blocks since the creatio
n of Bit
coin on J
an
u
ary 3
rd
, 
2009. 
BTC
—e acro
nym rep
resenting Bi
tcoin currency
.
C
r
y
pto
g
r
ap
hy
—e study o
f techniques by which co
mmunica
t
ions 
are s
e
c
u
red
.
Cr
y
ptographic H
ash
—An algorithm tha
t creates a x
ed-length s
eries 
of n
umbers from an in
pu
t having an a
rbitrary length. e algo
-
rithm
’
s ou
tpu
t c
an be dened as the equivalen
t of the “
ngerprint
” 
of a document.

THE BOOK O
F SA
TOSHI
368
Distribu
ted Fil
e Sharing
—A syst
em in w
hich les ar
e shared acros
s 
mul
tiple com
puter
s w
hich act as both cons
umers and p
roviders o
f 
informa
tion.
Encr
y
ption
—e p
rocess of encoding m
essages or info
rmation in 
such a wa
y that only a
uthorized parties can read or acces
s t
hem.
El
liptic Curve Cr
yptography
—A public-key cr
yptogra
phy based on 
the algebra
ic str
ucture o
f elliptic cur
ves over a ni
te num
b
er of ele
-
men
ts (nite elds). Elliptic cur
ves ar
e als
o used in se
veral int
eger 
factoriza
t
ion algo
rithms that ha
ve ap
plication
s in cr
yptogra
phy
.
El
liptic Curve Digital Signatur
e Algorithm (ECDSA)
 - In cryptog
-
rap
hy
, the Elliptic Curve Digital Signat
ure Algorithm (ECDSA) 
oer
s a variant o
f t
he Digital Signa
ture Algo
r
ithm (DSA), which 
emp
loys ellip
t
ic cur
ve cr
yptograp
hy
.
Genesis Block
—e ver
y rst block of the b
lo
ck chain. 
H
ash, Hash F
unction
—Hash i
s t
he xed-length ou
tput o
f a cr
ypto
-
graphic alg
orithm, or hash function. H
ash is a document
’
s “ng
er
-
prin
t”
, where the document, which ma
y b
e of an
y length, is the text 
being encoded by the hash function. 
He
xad
ecimal Number S
ystem
—Wh
ereas the decimal numbering 
system is based on 10, the hexadecimal system is based is 16, and 
the system em
ploys the symbols 0 thr
ough 9 to repr
esent the num
-
bers 0 through 9 and the sym
b
ols A, B
, C, D
, E, and F (either in 
low
er cas
e or up
per c
ase) to rep
resent the n
umbers 10 through 15. 
H
exadecima
l num
b
ers ar
e prex
e
d by 0x, a
nd so de
cimal 16 is 0x10 
in hexadecimal, decimal 17 is 0x11, and so on.
L
edger
—In accoun
ting, this is the principal book or com
puter le 
for r
ecording a
nd totaling mo
netar
y t
ransactions b
y account. I
t 
incl
udes a b
eginning balance, debi
ts, credits, an
d an ending balance.
Message Digest
—
e outp
ut of a cryptographic ha
sh func
tion.
Miners
—Ini
tial
ly called nodes, t
hese are devices with specialized 
har
dware tha
t compete in cr
eating the next block an
d s
o collect
-
ing the rewar
ds associated with it. Rewar
ds are co
mposed of new 

Terms & Defi
nitio
n
369
bi
tcoins the pr
otocol allows miner
s to create alo
ng with the sum of 
all transaction fees con
tained in that block.
Non
c
e
—A number within a block tha
t a miner incremen
ts until he or 
ano
t
her miner ob
t
ains the messag
e digest with the characteristics 
requir
ed by the Bit
coin pro
tocol to cons
titute “
winning” tha
t block.
Open S
ource Sowar
e
—S
owar
e co
de (blue p
rint) that is s
hared and 
ava
il
able f
or an
yone to see, inspect, and modify so as to be able to 
rep
roduce the pr
og
rams themsel
ves. 
P
eer-t
o-Peer
 network
—A decentralized and distrib
uted network 
ar
chitecture wher
e individual nodes (com
puters) in the netw
ork 
act as both sup
pliers and co
nsumers of r
esources. is is in co
n
-
trast with a cen
tra
lized client-ser
ver model where c
lients reques
t 
resour
ces f
ro
m t
he ser
ver
.
Proof-o
f-W
ork
—is is like a “
contes
t” in which each miner co
m
-
petes. e rst miner t
o obtain a “
nonce
” that genera
tes the message 
digest
 wi
t
h the characteristics dened b
y the Bitco
in prot
o
col as a 
“
 
w
 
i
 
n
”.
Proto
c
ol
—An establis
hed procedure tha
t miners and clien
ts mus
t fol
-
low
. I
t is dict
ated b
y the Bitco
in open source sowar
e which all min
-
ers run. 
SH
A256
—One type of cr
yptograp
hic hash algorithm. I
t is c
urren
tly 
used by the Bi
tcoin sowar
e.
Satos
hi
—e smallest denomina
t
ion of B
itcoin. I
t is equivalen
t to 10
-8
 
bi
tcoin, and so there a
re 100,000,000 satoshi
s in 1 bitco
in.
T
ransaction fee
—is is the cost that senders o
f bitco
ins pay miner
s
 
to incl
ude their transactions in the next block cha
in. 
Wa
l
 
l
e
t
—e sowar
e t
hat co
ntain
s a list of Bi
tcoin addresses a
nd their 
corres
p
onding p
rivate k
e
ys.

371
I
nd
e
x
A
asymmetric encr
yption  10, 133
asymmetric encr
yption, 18, 19, 88
Bit
coin address, 19, 20, 21, 25, 59, 65, 
93, 111, 117, 135, 186, 201, 202, 
207, 210
Bit
coin faucet, 104, 133
Bit
coin Magazine, 117
BitT
orrent, 131
block chain, 16, 18, 19, 20, 21, 22, 25, 
26, 27, 29, 30, 31, 36, 43, 45, 4  
371
B
Bit
coin address  11, 13, 14, 19, 91, 143, 
144, 177, 187, 217, 311, 336, 
337, 338, 339, 348, 367
Bit
coin faucet  163
Bit
coin Magazine  187
BitT
orrent  211
block chain  6, 10, 11, 13, 14, 15, 20, 
21, 24, 25, 26, 27, 49, 50, 52, 55, 
64, 108, 113, 134, 156, 170, 173, 
177, 178, 188, 203, 241, 245, 
258, 293, 295, 313, 314, 328, 
367, 368, 369
block rewar
d  14, 286
bookkeeping  3, 10, 14, 25, 27
Byzan
tine fault to
lerance  68
Byzan
tine Generals  5, 69
C
collision  50, 51, 78, 143, 144, 191, 193, 
195, 196, 197, 201, 333
D
decit spending  45
deation  31, 47, 127, 128, 129, 140, 
280, 283
denial of ser
vice attack  205
digest  16, 17, 18, 369
DNS  214, 215, 313, 320, 321, 336
domain n
ame ser
ver  313
Dorian Sat
oshi Nakamo
to  6
double s
p
ending  36, 49, 76, 77, 250
E
EDCSA  133
E-gold  43
elliptic curve cr
yptograph
y  81, 133, 
368
Ether
eum  6
F
fungible  29
G
genesis block  3
H
hash  16, 17, 18, 19, 20, 23, 26, 34, 69, 
91, 110, 134, 143, 144, 156, 158, 
187, 188, 189, 190, 191, 192, 
193, 194, 195, 196, 197, 199, 
200, 202, 206, 241, 243, 246, 
247, 249, 250, 252, 253, 256, 
258, 261, 265, 304, 305, 331, 
333, 367, 368, 369
hashcash  40, 50

THE BOOK O
F SA
TOSHI
372
hash function  16
hexadecimal num
b
er  17
hoardin
g  31, 141
H
unt br
others  176
L
Linux  26, 132, 144, 204
M
medium of ex
change  29, 235, 236, 
278, 349
miners  10, 11, 13, 14, 15, 18, 20, 23, 
24, 25, 26, 27, 49, 50, 55, 61, 
107, 113, 121, 135, 139, 271, 
285, 303, 314, 317, 318, 319, 
322, 367, 369
N
N
amecoin  26, 313
N
apster  43, 44
O
orphan b
lo
cks  24, 50, 55
P
Pa
yPal  5, 229, 230, 289
peer-to-peer  xi, xvii, 33, 34, 36, 43, 90, 
99, 101, 186, 293, 313, 347, 367
P
eer-to-P
eer  3, 34, 351, 369
precio
us metals  105, 348
priva
te key  12, 13, 144, 156, 157, 187, 
189, 193, 194, 195, 196, 199, 
201, 229, 230, 260, 264, 265, 
271, 272, 348, 367
proo
f-of-work  16, 19, 20, 23, 34, 46, 
50, 52, 55, 56, 57, 58, 59, 62, 65, 
69, 70, 75, 77, 78, 90, 94, 106, 
107, 114, 115, 135, 237, 304, 
314, 316, 331, 335
public k
e
y  12, 13, 76, 91, 100, 144, 
160, 187, 188, 189, 192, 194, 
195, 196, 199, 260, 262, 264, 
265, 336, 367
public ledg
er  6, 10, 13, 117, 293
Q
QR code  145
R
RIPEMD-160  19, 197, 198
S
satoshi
s  2
seigniorage  61, 62, 270
SH
A-256  19, 21, 78, 136, 155, 156, 
192, 193, 197, 198, 204, 333
Simp
lied Paymen
t V
erication  36, 
177, 178
source code  1, 4, 6, 26, 89, 123, 188, 
206, 235, 270
T
timestam
p  52, 101, 110, 247, 316, 329, 
330
tragedy of the co
mmons  9
W
wallets  11, 13, 129, 346
W
ikiL
eaks  5, 309, 312, 325, 326
W
ikipedia  19, 68, 183, 184, 185, 186, 
310
    </pre>
  </body>
</html>
